}
cau_bang_mci <- glue_collapse(purrr::compact(c(
mota_theo_nhom("MCI", "Cháº·t"),
mota_theo_nhom("MCI", "KhÃ¡"),
mota_theo_nhom("MCI", "Vá»«a"),
mota_theo_nhom("MCI", "Yáº¿u")
)), sep = " ")
cau_bang_sstt <- glue_collapse(purrr::compact(c(
mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Cháº·t"),
mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "KhÃ¡"),
mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Vá»«a"),
mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Yáº¿u")
)), sep = " ")
cor_wide_compare <- cor_by_group %>%
select(NhÃ³m, Test.tháº§n.kinh, Há»‡.sá»‘.tÆ°Æ¡ng.quan.r) %>%
pivot_wider(names_from = NhÃ³m, values_from = Há»‡.sá»‘.tÆ°Æ¡ng.quan.r)
test_tuong_quan_cao_hon_sstt <- cor_wide_compare %>%
filter(`Sa sÃºt trÃ­ tuá»‡` - MCI >= 0.1) %>%
arrange(desc(`Sa sÃºt trÃ­ tuá»‡` - MCI)) %>%
pull(Test.tháº§n.kinh)
if (length(test_tuong_quan_cao_hon_sstt) > 0) {
test_nhanh <- glue_collapse(head(test_tuong_quan_cao_hon_sstt, 3), sep = ", ", last = " vÃ  ")
cau_inline_so_sanh_sstt_mci <- glue("Má»™t sá»‘ test nhÆ° {test_nhanh} cÃ³ tÆ°Æ¡ng quan máº¡nh hÆ¡n á»Ÿ nhÃ³m sa sÃºt trÃ­ tuá»‡.")
} else {
cau_inline_so_sanh_sstt_mci <- "KhÃ´ng cÃ³ test nÃ o cÃ³ tÆ°Æ¡ng quan máº¡nh hÆ¡n rÃµ rá»‡t giá»¯a hai nhÃ³m."
}
#| label: má»©c Ä‘á»™ hoÃ n thÃ nh cÃ¡c tests
# ğŸ§  Danh sÃ¡ch cÃ¡c biáº¿n test tháº§n kinh nháº­n thá»©c
neuro_vars <- c(
"Im.recall1", "de.recall1", "de.reg1",
"TMT.A.time", "TMT.B.time",
"DS.forward1", "DS.backrward1",
"animal.test1", "clock.drawing1"
)
# ğŸ“ NhÃ£n tiáº¿ng Viá»‡t tÆ°Æ¡ng á»©ng
test_labels_map <- c(
"Im.recall1" = "Nhá»› láº¡i ngay",
"de.recall1" = "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n",
"de.reg1" = "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
"TMT.A.time" = "Ná»‘i sá»‘",
"TMT.B.time" = "Ná»‘i sá»‘-chá»¯",
"DS.forward1" = "Äá»c chuá»—i sá»‘ xuÃ´i",
"DS.backrward1" = "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
"animal.test1" = "LÆ°u loÃ¡t ngÃ´n ngá»¯",
"clock.drawing1" = "Váº½ Ä‘á»“ng há»“"
)
# âœ¨ Thá»© tá»± mong muá»‘n Ä‘á»ƒ hiá»ƒn thá»‹ nháº¥t quÃ¡n
label_order <- c(
"Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
"Ná»‘i sá»‘", "Ná»‘i sá»‘-chá»¯",
"Äá»c chuá»—i sá»‘ xuÃ´i", "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
"LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)
# ğŸ“Š TÃ­nh toÃ¡n tá»‰ lá»‡ hoÃ n thÃ nh theo nhÃ³m
completion_summary <- purrr::map_dfr(neuro_vars, function(var) {
df %>%
group_by(phan_loan_roi_loan_nhan_thuc) %>%
summarise(
Biáº¿n = var,
HoÃ n.thÃ nh = round(100 * sum(!is.na(.data[[var]])) / n(), 1),
.groups = "drop"
)
})
# ğŸ“‹ Táº¡o báº£ng flextable
completion_wide <- completion_summary %>%
select(NhÃ³m = phan_loan_roi_loan_nhan_thuc, Biáº¿n, HoÃ n.thÃ nh) %>%
pivot_wider(names_from = NhÃ³m, values_from = HoÃ n.thÃ nh) %>%
mutate(`Test tháº§n kinh` = factor(test_labels_map[Biáº¿n], levels = label_order)) %>%
arrange(`Test tháº§n kinh`) %>%
select(`Test tháº§n kinh`, `MCI`, `Sa sÃºt trÃ­ tuá»‡`)
ft_hoanthanh <- flextable(completion_wide) %>%
set_header_labels(
`Test tháº§n kinh` = "Test tháº§n kinh nháº­n thá»©c",
`MCI` = "MCI (%)",
`Sa sÃºt trÃ­ tuá»‡` = "Sa sÃºt trÃ­ tuá»‡ (%)"
) %>%
colformat_num(decimal.mark = ",", suffix = "%") %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 11, part = "all") %>%
autofit() %>%
#set_caption("Báº£ng: Tá»‰ lá»‡ hoÃ n thÃ nh cÃ¡c test tháº§n kinh nháº­n thá»©c theo nhÃ³m cháº©n Ä‘oÃ¡n") %>%
set_table_properties(width = 1, layout = "autofit")
# ğŸ“Š Chuáº©n bá»‹ vÃ  váº½ biá»ƒu Ä‘á»“ ggplot theo Ä‘Ãºng thá»© tá»±
label_order <- c(
"Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
"Ná»‘i sá»‘", "Ná»‘i sá»‘-chá»¯",
"Äá»c chuá»—i sá»‘ xuÃ´i", "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
"LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)
plot_hoanthanh <- completion_summary %>%
mutate(
NhÃ³m = factor(phan_loan_roi_loan_nhan_thuc, levels = c("MCI", "Sa sÃºt trÃ­ tuá»‡")),
NhÃ£n = factor(test_labels_map[Biáº¿n], levels = rev(label_order))
) %>%
ggplot(aes(x = NhÃ£n, y = HoÃ n.thÃ nh, fill = NhÃ³m)) +
geom_col(position = position_dodge(width = 0.8), width = 0.7) +
geom_text(
aes(label = paste0(HoÃ n.thÃ nh, "%")),
position = position_dodge(width = 0.8),
hjust = -0.5,  # ğŸ‘ˆ NhÃ£n náº±m bÃªn pháº£i ngoÃ i cá»™t
size = 3.5,
family = "Times New Roman"
) +
coord_flip(clip = "off") +
scale_x_discrete(expand = expansion(mult = c(0.2, 0.2))) +
scale_fill_brewer(palette = "Pastel2") +
expand_limits(y = max(completion_summary$HoÃ n.thÃ nh) + 15) +  # ğŸ‘ˆ ThÃªm khoáº£ng trá»‘ng cho nhÃ£n
labs(
# title = "Tá»‰ lá»‡ hoÃ n thÃ nh cÃ¡c test tháº§n kinh nháº­n thá»©c",
x = NULL, y = "Tá»‰ lá»‡ hoÃ n thÃ nh (%)", fill = "NhÃ³m"
) +
theme_minimal(base_family = "Times New Roman") +
theme(
plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
axis.text = element_text(size = 10),
legend.position = "top"
)
# âœï¸ Nháº­n xÃ©t tá»± Ä‘á»™ng
nhom_thap_mci <- completion_summary %>%
filter(phan_loan_roi_loan_nhan_thuc == "MCI") %>%
arrange(HoÃ n.thÃ nh) %>%
slice(1)
nhom_thap_sstt <- completion_summary %>%
filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡") %>%
arrange(HoÃ n.thÃ nh) %>%
slice(1)
cau_hoanthanh_bang <- glue(
"Tá»‰ lá»‡ hoÃ n thÃ nh nhÃ¬n chung cao, tá»« khoáº£ng ",
"{min(completion_summary$HoÃ n.thÃ nh)}% Ä‘áº¿n {max(completion_summary$HoÃ n.thÃ nh)}%. ",
"Test {test_labels_map[nhom_thap_mci$Biáº¿n]} tháº¥p nháº¥t á»Ÿ nhÃ³m MCI ({nhom_thap_mci$HoÃ n.thÃ nh}%), ",
"vÃ  test {test_labels_map[nhom_thap_sstt$Biáº¿n]} tháº¥p nháº¥t á»Ÿ nhÃ³m sa sÃºt trÃ­ tuá»‡ ({nhom_thap_sstt$HoÃ n.thÃ nh}%)."
)
cau_hoanthanh_ggplot <- glue(
"Biá»ƒu Ä‘á»“ cho tháº¥y pháº§n lá»›n test Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i tá»‰ lá»‡ cao trong cáº£ hai nhÃ³m, ",
"chá»‰ cÃ³ má»™t sá»‘ test gáº·p khÃ³ khÄƒn hÆ¡n á»Ÿ nhÃ³m MCI hoáº·c sa sÃºt trÃ­ tuá»‡."
)
ft_hoanthanh
plot_hoanthanh
# ğŸ“¦ Chuáº©n bá»‹ dá»¯ liá»‡u vÃ  mÃ£ hÃ³a thá»© báº­c
df_ord <- df %>%
filter(
!is.na(mmse_group),
!is.na(lam_sang_group),
mmse_group != "BÃ¬nh thÆ°á»ng"  # âŒ Loáº¡i bá» nhÃ³m BÃ¬nh thÆ°á»ng
) %>%
mutate(
mmse_group = droplevels(mmse_group),
lam_sang_group = droplevels(lam_sang_group),
mmse_num = as.numeric(mmse_group),
lam_sang_num = as.numeric(lam_sang_group)
)
# ğŸ“ˆ Kiá»ƒm Ä‘á»‹nh Spearman vÃ  Kendall
test_spearman <- cor.test(df_ord$mmse_num, df_ord$lam_sang_num, method = "spearman")
test_kendall  <- cor.test(df_ord$mmse_num, df_ord$lam_sang_num, method = "kendall")
rho <- round(test_spearman$estimate, 2)
pval_s <- test_spearman$p.value
pval_s_fmt <- ifelse(pval_s < 0.001, "< 0.001", sprintf("%.3f", pval_s))
tau <- round(test_kendall$estimate, 2)
pval_k <- test_kendall$p.value
pval_k_fmt <- ifelse(pval_k < 0.001, "< 0.001", sprintf("%.3f", pval_k))
# ğŸ§¾ Táº¡o báº£ng táº§n suáº¥t dáº¡ng chÃ©o
tab_ordinal_long <- df_ord %>%
count(`PhÃ¢n loáº¡i lÃ¢m sÃ ng` = lam_sang_group, `PhÃ¢n Ä‘á»™ MMSE` = mmse_group) %>%
group_by(`PhÃ¢n loáº¡i lÃ¢m sÃ ng`) %>%
mutate(
Tá»·_lá»‡ = round(100 * n / sum(n), 1),
Táº§n_suáº¥t = glue("{n} ({Tá»·_lá»‡}%)")
) %>%
select(-n, -Tá»·_lá»‡) %>%
pivot_wider(names_from = `PhÃ¢n Ä‘á»™ MMSE`, values_from = Táº§n_suáº¥t, values_fill = "-") %>%
mutate(
`GiÃ¡ trá»‹ p` = c(pval_s_fmt, rep("", n() - 1)),
`Spearman Ï` = c(rho, rep("", n() - 1)),
`Kendall Ï„` = c(tau, rep("", n() - 1))
)
# ğŸ“Š Báº£ng flextable
ft_ord <- flextable(tab_ordinal_long) %>%
set_caption("Báº£ng: PhÃ¢n bá»‘ chÃ©o giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng (loáº¡i BT)") %>%
autofit() %>%
font(fontname = "Times New Roman", part = "all") %>%
fontsize(size = 11, part = "all") %>%
align(align = "center", part = "all")
# ğŸ¨ NhÃ£n rÃºt gá»n
short_labels <- c(
"Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
"Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)
# ğŸŒ¡ï¸ Heatmap vá»›i mÃ u pastel
df_heatmap <- df_ord %>%
count(lam_sang_group, mmse_group)
plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
geom_tile(color = "white") +
geom_text(aes(label = n), color = "black", size = 4) +
scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +
scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
theme_minimal(base_family = "Times New Roman") +
theme(axis.text = element_text(size = 11), panel.grid = element_blank())
# ğŸ”µ Scatter ordinal pastel
plot_scatter <- ggplot(df_ord, aes(x = mmse_num, y = lam_sang_num)) +
geom_jitter(width = 0.2, height = 0.2, alpha = 0.6, color = "#40E0D0") +  # xanh ngá»c
geom_smooth(method = "lm", se = FALSE, color = "#FF6F61", linetype = "dashed") +  # cam Ä‘Ã o
scale_x_continuous(
breaks = seq_along(levels(df_ord$mmse_group)),
labels = short_labels[levels(df_ord$mmse_group)]
) +
scale_y_continuous(
breaks = seq_along(levels(df_ord$lam_sang_group)),
labels = short_labels[levels(df_ord$lam_sang_group)]
) +
labs(x = "PhÃ¢n Ä‘á»™ MMSE", y = "PhÃ¢n loáº¡i lÃ¢m sÃ ng") +
theme_minimal(base_family = "Times New Roman") +
theme(axis.text = element_text(size = 11), panel.grid = element_blank())
# ğŸ“ Inline codes mÃ´ táº£
cau_chen_bieu_do_heatmap <- glue(
"Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n sÆ° phÃ¢n bá»‘ chÃ©o cho tháº¥y má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng, hay cÃ²n gá»i tiÃªu chuáº©n vÃ ng. Biá»ƒu Ä‘á»“ cho tháº¥y há»‡ sá»‘ Spearman Ï = {rho}, Kendall Ï„ = {tau}, vá»›i p = {pval_s_fmt}. ",
if (pval_s < 0.05) "Káº¿t quáº£ cÃ³ Ã½ nghÄ©a thá»‘ng kÃª." else "Káº¿t quáº£ khÃ´ng cÃ³ Ã½ nghÄ©a thá»‘ng kÃª."
)
cau_bieudo_ordinal <- glue(
"Biá»ƒu Ä‘á»“ minh há»a phÃ¢n bá»‘ táº­p trung á»Ÿ cÃ¡c má»©c Ä‘á»™ tÆ°Æ¡ng á»©ng, ",
"cho tháº¥y xu hÆ°á»›ng Ä‘á»“ng biáº¿n giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng."
)
cau_chen_bieu_do_gop_2_loai  <- glue(
"Biá»ƒu Ä‘á»“ bÃªn trÃ¡i  thá»ƒ hiá»‡n sÆ° phÃ¢n bá»‘ chÃ©o cho tháº¥y má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng, hay cÃ²n gá»i tiÃªu chuáº©n vÃ ng. Biá»ƒu Ä‘á»“ cho tháº¥y há»‡ sá»‘ Spearman Ï = {rho}, Kendall Ï„ = {tau}, vá»›i p = {pval_s_fmt}. ",
if (pval_s < 0.05) "Káº¿t quáº£ cÃ³ Ã½ nghÄ©a thá»‘ng kÃª." else "Káº¿t quáº£ khÃ´ng cÃ³ Ã½ nghÄ©a thá»‘ng kÃª. ",  "Biá»ƒu Ä‘á»“ bÃªn pháº£i minh há»a phÃ¢n bá»‘ táº­p trung á»Ÿ cÃ¡c má»©c Ä‘á»™ tÆ°Æ¡ng á»©ng, ", "cho tháº¥y xu hÆ°á»›ng Ä‘á»“ng biáº¿n giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng."
)
#| label: plot_heat_scatter_ordinal
#| fig-cap: "Biá»ƒu Ä‘á»“ heatmap vÃ  scatter ordinal thá»ƒ hiá»‡n má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  giai Ä‘oáº¡n lÃ¢m sÃ ng"
#| echo: true
#| message: false
#| warning: false
#| fig-align: center
#| out.width: "100%"
pacman::p_load(patchwork)  # ğŸ“¦ GhÃ©p biá»ƒu Ä‘á»“
# ğŸŒˆ NhÃ£n rÃºt gá»n
short_labels <- c(
"Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
"Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)
# ğŸŒ¡ï¸ Heatmap pastel
df_heatmap <- df_ord %>%
count(lam_sang_group, mmse_group)
plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
geom_tile(color = "white") +
geom_text(aes(label = n), color = "black", size = 4) +
scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +  # pastel xanh-há»“ng
scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ trÃªn lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
theme_minimal(base_family = "Times New Roman") +
theme(
axis.text = element_text(size = 11),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank()
)
# ğŸ”µ Scatter ordinal pastel
plot_scatter <- ggplot(df_ord, aes(x = mmse_num, y = lam_sang_num)) +
geom_jitter(width = 0.2, height = 0.2, alpha = 0.6, color = "#40E0D0") +  # turquoise
geom_smooth(method = "lm", se = FALSE, color = "#FF6F61", linetype = "dashed") +  # coral
scale_x_continuous(
breaks = seq_along(levels(df_ord$mmse_group)),
labels = short_labels[levels(df_ord$mmse_group)]
) +
scale_y_continuous(
breaks = seq_along(levels(df_ord$lam_sang_group)),
labels = short_labels[levels(df_ord$lam_sang_group)]
) +
labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ trÃªn lÃ¢m sÃ ng") +
theme_minimal(base_family = "Times New Roman") +
theme(
axis.text = element_text(size = 11),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank()
)
# ğŸŒˆ NhÃ£n rÃºt gá»n
short_labels <- c(
"Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
"Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
"Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)
# ğŸŒ¡ï¸ Heatmap pastel
df_heatmap <- df_ord %>%
count(lam_sang_group, mmse_group)
plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
geom_tile(color = "white") +
geom_text(aes(label = n), color = "black", size = 4) +
scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +  # pastel xanh-há»“ng
scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
labs(x = "PhÃ¢n Ä‘á»™ MMSE", y = "PhÃ¢n loáº¡i lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
theme_minimal(base_family = "Times New Roman") +  # âœ… hoÃ n chá»‰nh font
theme(
axis.text = element_text(size = 11),
axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid = element_blank()
)
plot_heat + plot_scatter + plot_layout(ncol = 2)
plot_heat
plot_scatter
#| include: false
data <- data.frame(
Ten_bien = c(
"Tuá»•i", "Giá»›i tÃ­nh", "Tuá»•i khá»Ÿi phÃ¡t", "Thá»i gian phÃ¡t hiá»‡n bá»‡nh",
"TrÃ¬nh Ä‘á»™ há»c váº¥n", "Nghá» nghiá»‡p trÆ°á»›c Ä‘Ã¢y", "TÃ¬nh tráº¡ng hÃ´n nhÃ¢n",
"Tiá»n sá»­ gia Ä‘Ã¬nh", "Bá»‡nh Ä‘i kÃ¨m", "Thang MMSE", "Tiá»ƒu thang MMSE",
"Word List", "Digit span forward", "Digit span backward",
"TMT-A", "TMT-B", "Kháº£o sÃ¡t sá»± lÆ°u loÃ¡t ngÃ´n ngá»¯.",
"Tráº¯c nghiá»‡m váº½ Ä‘á»“ng há»“", "Cháº©n Ä‘oÃ¡n", "Giai Ä‘oáº¡n"
),
Loai_bien = c(
"Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng",
"Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh",
"Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng",
"Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh"
),
Gia_tri_don_vi = c(
"NÄƒm", "Nam/Ná»¯", "Khá»Ÿi phÃ¡t sá»›m/khá»Ÿi phÃ¡t muá»™n", "NÄƒm",
"Cáº¥p 1, cáº¥p 2, cáº¥p 3, cao Ä‘áº³ng/Ä‘áº¡i há»c, khÃ´ng xÃ¡c Ä‘á»‹nh",
"ToÃ n thá»i gian, bÃ¡n thá»i gian, vá» hÆ°u",
"CÃ³ chá»“ng vá»£, gÃ³a, ly thÃ¢n/ly hÃ´n", "CÃ³ bá»‹ SSTT", "CÃ³, khÃ´ng",
"GiÃ¡ trá»‹ tá»« 0 - 30", "TÃ¹y thuá»™c chá»©c nÄƒng nháº­n thá»©c",
"GiÃ¡ trá»‹ tá»« 0 â€“ 30", "GiÃ¡ trá»‹ tá»« 0 â€“ 14", "GiÃ¡ trá»‹ tá»« 0 â€“ 12",
"Thá»i gian Ä‘áº¡t khi dÆ°á»›i 150 giÃ¢y", "Thá»i gian Ä‘áº¡t khi dÆ°á»›i 300 giÃ¢y",
"Sá»‘ lÆ°á»£ng cÃ¡c con váº­t ngÆ°á»i lÃ m tráº¯c nghiá»‡m ká»ƒ tÃªn",
"1 Ä‘áº¿n 6 Ä‘iá»ƒm theo thang Shulman", "SCI, MCI vÃ  SSTT",
"Giai Ä‘oáº¡n nháº¹, trung bÃ¬nh, náº·ng"
)
)
#| echo: false
ft <- data %>%
flextable() %>%
set_header_labels(
Ten_bien = "TÃªn biáº¿n",
Loai_bien = "Loáº¡i biáº¿n",
Gia_tri_don_vi = "GiÃ¡ trá»‹ / ÄÆ¡n vá»‹"
) %>%
autofit() %>%
set_table_properties(width = 1, layout = "autofit") %>%
font(fontname = "Times New Roman", part = "all")  %>%
fontsize(size = 13, part = "all")
ft
#| echo: false
ft_tuoi
#| echo: false
tuoi_gp
#| message: false
#| warning: false
#| paged-print: false
ft_freq_p
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
nhom_tuoi_gp
ft_gender
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
gioitinh_bar_percent
#| echo: false
ft_edu
hocvan_bar_percent
#| echo: false
ft_mmse
#| echo: false
ggplot_mmse
#| label: Biá»ƒu Ä‘á»“  phÃ¢n loáº¡i suy giáº£m nháº­n thá»©c vÃ  sa sÃºt trÃ­ tuá»‡ theo MMSE chen káº¿t quáº£
#| echo: false
ggplot_mmse
#| echo: false
ft_nhanthuc_group
#| echo: false
plot_nhanthuc_group
#| echo: false
ft_corr_long
#| echo: false
plot_corr_grouped
#| label: B má»©c Ä‘á»™ hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c
#| echo: false
ft_hoanthanh
#| label: BD hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c
#| echo: false
plot_hoanthanh
#| label: Biá»ƒu Ä‘á»“ heatmap
#| message: false
#| warning: false
#| include: false
plot_heat
#| label: Sá»± tÆ°Æ¡ng Ä‘á»“ng giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng theo tiÃªu chuáº©n lÃ¢m sÃ ng káº¿t quáº£
#| echo: false
plot_scatter
my_pres  <- read_pptx("sstt_SLIDE_input.pptx")
myftr <- "Bá»‡nh viá»‡n 30-4"
#| label: slide vai tro test than kinh nhan thuc
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Vai trÃ² test tháº§n kinh nháº­n thá»©c", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("Viá»‡c phÃ¢n tÃ­ch tá»‘t cÃ¡c thang Ä‘iá»ƒm tÃ¢m tháº§n kinh nÃ y há»— trá»£ cÃ¡c bÃ¡c sÄ© lÃ¢m sÃ ng trong viá»‡c cháº©n Ä‘oÃ¡n, cháº©n Ä‘oÃ¡n phÃ¢n biá»‡t thá»ƒ bá»‡nh" ,  "xÃ¡c Ä‘á»‹nh lÄ©nh vá»±c nháº­n thá»©c bá»‹ khiáº¿m khuyáº¿t, má»©c Ä‘á»™ náº·ng","Chá»n lá»±a cÃ¡c phÆ°Æ¡ng phÃ¡p can thiá»‡p nháº­n thá»©c khÃ´ng dÃ¹ng thuá»‘c nhÆ° táº­p luyá»‡n nháº­n thá»©c (cognitive training), phá»¥c há»“i nháº­n thá»©c (cognitive rehabilitation), kÃ­ch thÃ­ch nháº­n thá»©c (cognitive stimulation); theo dÃµi diá»…n tiáº¿n khiáº¿m khuyáº¿t nháº­n thá»©c Ä‘áº·c biá»‡t trong cÃ¡c trÆ°á»ng há»£p than phiá»n giáº£m nháº­n thá»©c chá»§ quan (subjective cognitive impairment), suy giáº£m nháº­n thá»©c nháº¹ (mild cognitive impairment)."), location = ph_location_type(type = "body"))
#| include: false
ul <- unordered_list(
level_list = c(1, 1, 1,1 ),
str_list = c("Äáº·t váº¥n Ä‘á»", "Äá»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cá»©u", "Káº¿t quáº£ - BÃ n luáº­n", "Káº¿t luáº­n"),
style = fp_text(color = "black", font.size = 0) )
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
my_pres <- ph_with(my_pres, value = "Ná»™i dung trÃ¬nh bÃ y", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul,
location = ph_location_type(type = "body") )
#| include: false
ul <- unordered_list(
level_list = c(1, 2,  1, 2, 2),
str_list = c("CÃ¢u há»i nghiÃªn cá»©u", "GiÃ¡ trÃ­ cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test lÃ  gÃ¬?", "Má»¥c tiÃªu", "NghiÃªn cá»©u má»‘i tÆ°Æ¡ng quan cá»§a thang Ä‘iá»ƒm MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c táº¡i Bá»‡nh viá»‡n 30-4.", "ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng cá»§a bá»™ Test tháº§n kinh nháº­n thá»©c trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ Sa sÃºt trÃ­ tuá»‡ táº¡i Bá»‡nh viá»‡n 30-4"),
style = fp_text(color = "black", font.size = 0) )
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
my_pres <- ph_with(my_pres, value = "CÃ¢u há»i NC, má»¥c tiÃªu", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul,
location = ph_location_type(type = "body") )
layout_summary(my_pres)
layout_properties(my_pres, layout = "Two Content", master = "Office Theme")
install.packages("pubmed2bib")
librarry(pbmed2bib)
librarry(pbmed2bib)
install.packages("here")
library(pbmed2bib)
library(pbmed2bib)
install.packages("pbmed2bib")
library(pbmed2bib)
library(pbmed2bib)
install.packages("rbibutils")
library(rbibutils)
library(here)
bib_convert(
infile = here("Downloads", "22507355.nbib"),
outfile = here("Downloads", "outputfile.bib"),
informat = "nbib",
outformat = "bib"
)
library(rbibutils)
library(here)
bib_convert(
infile = here("Downloads", "22507355.nbib"),
outfile = here("Downloads", "outputfile.bib"),
informat = "nbib",
outformat = "bib"
)
install.packages("rbibutils", type = "source")
library(rbibutils)
library(here)
bib_convert(
infile = here("Downloads", "22507355.nbib"),
outfile = here("Downloads", "outputfile.bib"),
informat = "nbib",
outformat = "bib"
)
library(rbibutils)
library(rbibutils)
library(here)
rbibutils::bib_convert(
infile = here("tai_liem_tham_khao", "22507355.nbib"),
outfile = here("tai_liem_tham_khao", "outputfile.bib"),
informat = "nbib",
outformat = "bib"
)
file.exists(here("tai_liem_tham_khao", "22507355.nbib"))
library(rbibutils)   # Táº£i thÆ° viá»‡n chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng trÃ­ch dáº«n
library(here)        # Táº¡o Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i an toÃ n
# Chuyá»ƒn Ä‘á»•i file NBIB thÃ nh BibTeX
rbibutils::bib_convert(
infile = here("tai_liem_tham_khao", "22507355.nbib"),      # File Ä‘áº§u vÃ o
outfile = here("tai_liem_tham_khao", "outputfile.bib"),    # File Ä‘áº§u ra
informat = "nbib",                                          # Äá»‹nh dáº¡ng Ä‘áº§u vÃ o
outformat = "bib"                                           # Äá»‹nh dáº¡ng Ä‘áº§u ra
)
library(rbibutils)   # Táº£i thÆ° viá»‡n chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng trÃ­ch dáº«n
library(here)        # Táº¡o Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i an toÃ n
# Chuyá»ƒn Ä‘á»•i file NBIB thÃ nh BibTeX
rbibutils:::bib_convert(
infile = here("tai_liem_tham_khao", "22507355.nbib"),      # File Ä‘áº§u vÃ o
outfile = here("tai_liem_tham_khao", "outputfile.bib"),    # File Ä‘áº§u ra
informat = "nbib",                                          # Äá»‹nh dáº¡ng Ä‘áº§u vÃ o
outformat = "bib"                                           # Äá»‹nh dáº¡ng Ä‘áº§u ra
)
library(rbibutils)   # Táº£i thÆ° viá»‡n chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng trÃ­ch dáº«n
library(here)        # Táº¡o Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i an toÃ n
rbibutils:::bib_convert(
infile = here("tai_liem_tham_khao", "22507355.nbib"),
outfile = here("tai_liem_tham_khao", "outputfile.bib"),
informat = "nbib",
outformat = "bib"
)
install.packages("pubmed2bib")
install.packages("pubmed2bib")
Warning in install.packages :
install.packages("remotes")
remotes::install_github("ikashnitsky/pubmed2bib")
https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages
install.packages("remotes")
remotes::install_github("ikashnitsky/pubmed2bib")
library(pubmed2bib)
remotes::install_github("ikashnitsky/pubmed2bib")
install.packages("citr")
library(remote)
install.packages("remotes")
remotes::install_github("crsh/citr")
