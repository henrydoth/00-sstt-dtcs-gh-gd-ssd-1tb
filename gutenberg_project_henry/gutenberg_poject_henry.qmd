---
title: "Gutenberg Project - Henry Do"
author: "Henry Do"
date: today
lang: vi
format:
  html:
    toc: true           # Báº­t má»¥c lá»¥c
    toc-depth: 2        # Má»¥c lá»¥c Ä‘áº¿n cáº¥p Ä‘á»™ tiÃªu Ä‘á» 2
    code-fold: true     # Cho phÃ©p gáº­p/má»Ÿ code
    self-contained: true
    theme: cosmo        # Giao diá»‡n thÃ¢n thiá»‡n, dá»… Ä‘á»c
    page-layout: full   # TrÃ¬nh bÃ y toÃ n trang
bibliography: references.bib
csl: apa.csl
---

# Äáº·t váº¥n Ä‘á»

Hello

Tá»•ng quan ÄÆ°á»£c xem trá»±c tiáº¿p

```{r}
#| label: library
#| include: false
# CÃ i Ä‘áº·t vÃ  táº£i gÃ³i cáº§n thiáº¿t

# ğŸ“¦ CÃ i & náº¡p cÃ¡c gÃ³i cáº§n thiáº¿t báº±ng pacman
if (!require("pacman")) install.packages("pacman")
pacman::p_load(janeaustenr, gutenbergr, dplyr, tidytext, stringr, ggplot2, flextable)
```
```{r}
# Táº¡o dá»¯ liá»‡u cÃ³ sá»‘ dÃ²ng vÃ  sá»‘ chÆ°Æ¡ng
original_books <- austen_books() %>%
  mutate(
    linenumber = row_number(),
    chapter = cumsum(str_detect(text, "^chapter [\\divxlc]"))
  )

# Äáº¿m sá»‘ dÃ²ng má»—i chÆ°Æ¡ng trong tá»«ng cuá»‘n sÃ¡ch
chapter_summary <- original_books %>%
  count(book, chapter, name = "sá»‘_dÃ²ng") %>%
  arrange(book, chapter)

# Hiá»ƒn thá»‹ báº±ng flextable
flextable(chapter_summary) %>%
  set_header_labels(
    book = "TÃªn sÃ¡ch",
    chapter = "ChÆ°Æ¡ng",
    sá»‘_dÃ²ng = "Sá»‘ dÃ²ng"
  ) %>%
  autofit()
```

# lá»c sÃ¡ch hiá»ƒn thá»‹ 
```{r}
# Táº¡o dá»¯ liá»‡u gá»‘c
original_books <- austen_books() %>%
  mutate(
    linenumber = row_number(),
    chapter = cumsum(str_detect(text, "^chapter [\\divxlc]"))
  )

# PhÃ¢n tÃ­ch cho cuá»‘n "Pride & Prejudice"
pride_summary <- original_books %>%
  filter(book == "Pride & Prejudice") %>%
  count(chapter, name = "sá»‘_dÃ²ng") %>%
  arrange(chapter)

# TÃ­nh pháº§n trÄƒm
total_lines <- sum(pride_summary$sá»‘_dÃ²ng)
pride_summary <- pride_summary %>%
  mutate(ty_le = round(100 * sá»‘_dÃ²ng / total_lines, 2))

# ThÃªm dÃ²ng Tá»•ng cá»™ng
pride_total <- bind_rows(
  pride_summary,
  tibble(chapter = NA, sá»‘_dÃ²ng = total_lines, ty_le = 100)
)

# Táº¡o chá»‰ sá»‘ dÃ²ng cá»§a "Tá»•ng cá»™ng"
total_row <- which(is.na(pride_total$chapter))

# Táº¡o báº£ng flextable
flextable(pride_total) %>%
  set_header_labels(
    chapter = "ChÆ°Æ¡ng",
    sá»‘_dÃ²ng = "Sá»‘ dÃ²ng",
    ty_le = "Tá»· lá»‡ (%)"
  ) %>%
  italic(i = total_row) %>%
  compose(i = total_row, j = 1, value = as_paragraph("Tá»•ng cá»™ng")) %>%
  align(align = "center", part = "all") %>%
  autofit()
```

```{r}
# Váº½ biá»ƒu Ä‘á»“ sá»‘ dÃ²ng theo chÆ°Æ¡ng cho Pride & Prejudice ğŸ“Š
ggplot(pride_summary, aes(x = chapter, y = sá»‘_dÃ²ng)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Sá»‘ dÃ²ng theo chÆ°Æ¡ng - Pride & Prejudice",
    x = "ChÆ°Æ¡ng",
    y = "Sá»‘ dÃ²ng"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)
  )
```
```{r}

```

