{
  "hash": "f9a35aa60771944f1035150dcf7263ad",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Gutenberg Project - Henry Do\"\nauthor: \"Henry Do\"\ndate: today\nlang: vi\nformat:\n  html:\n    toc: true           # Bật mục lục\n    toc-depth: 2        # Mục lục đến cấp độ tiêu đề 2\n    code-fold: true     # Cho phép gập/mở code\n    self-contained: true\n    theme: cosmo        # Giao diện thân thiện, dễ đọc\n    page-layout: full   # Trình bày toàn trang\nbibliography: references.bib\ncsl: apa.csl\n---\n\n\n\n# Đặt vấn đề\n\nHello\n\nTổng quan Được xem trực tiếp\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tạo dữ liệu có số dòng và số chương\noriginal_books <- austen_books() %>%\n  mutate(\n    linenumber = row_number(),\n    chapter = cumsum(str_detect(text, \"^chapter [\\\\divxlc]\"))\n  )\n\n# Đếm số dòng mỗi chương trong từng cuốn sách\nchapter_summary <- original_books %>%\n  count(book, chapter, name = \"số_dòng\") %>%\n  arrange(book, chapter)\n\n# Hiển thị bằng flextable\nflextable(chapter_summary) %>%\n  set_header_labels(\n    book = \"Tên sách\",\n    chapter = \"Chương\",\n    số_dòng = \"Số dòng\"\n  ) %>%\n  autofit()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-c86160e6{}.cl-c85e61e8{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c85f9108{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c85f9112{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c85f9dce{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9dcf{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9dd8{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9dd9{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9de2{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9de3{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9de4{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9dec{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9ded{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9dee{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9df6{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9df7{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e00{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e01{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e02{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e0a{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e0b{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e14{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e15{width:1.593in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e16{width:0.86in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c85f9e1e{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-c86160e6'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-c85f9dce\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Tên sách</span></p></th><th class=\"cl-c85f9dcf\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">Chương</span></p></th><th class=\"cl-c85f9dd8\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">Số dòng</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9dd9\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Sense &amp; Sensibility</span></p></td><td class=\"cl-c85f9de2\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9de3\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">12,624</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9de4\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Pride &amp; Prejudice</span></p></td><td class=\"cl-c85f9dec\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9ded\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">13,030</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9dee\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Mansfield Park</span></p></td><td class=\"cl-c85f9df6\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9df7\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">15,349</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9e00\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Emma</span></p></td><td class=\"cl-c85f9e01\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9e02\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">16,235</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9e0a\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Northanger Abbey</span></p></td><td class=\"cl-c85f9e0b\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9e14\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">7,856</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c85f9e15\"><p class=\"cl-c85f9108\"><span class=\"cl-c85e61e8\">Persuasion</span></p></td><td class=\"cl-c85f9e16\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">0</span></p></td><td class=\"cl-c85f9e1e\"><p class=\"cl-c85f9112\"><span class=\"cl-c85e61e8\">8,328</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n\n# lọc sách hiển thị \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tạo dữ liệu gốc\noriginal_books <- austen_books() %>%\n  mutate(\n    linenumber = row_number(),\n    chapter = cumsum(str_detect(text, \"^chapter [\\\\divxlc]\"))\n  )\n\n# Phân tích cho cuốn \"Pride & Prejudice\"\npride_summary <- original_books %>%\n  filter(book == \"Pride & Prejudice\") %>%\n  count(chapter, name = \"số_dòng\") %>%\n  arrange(chapter)\n\n# Tính phần trăm\ntotal_lines <- sum(pride_summary$số_dòng)\npride_summary <- pride_summary %>%\n  mutate(ty_le = round(100 * số_dòng / total_lines, 2))\n\n# Thêm dòng Tổng cộng\npride_total <- bind_rows(\n  pride_summary,\n  tibble(chapter = NA, số_dòng = total_lines, ty_le = 100)\n)\n\n# Tạo chỉ số dòng của \"Tổng cộng\"\ntotal_row <- which(is.na(pride_total$chapter))\n\n# Tạo bảng flextable\nflextable(pride_total) %>%\n  set_header_labels(\n    chapter = \"Chương\",\n    số_dòng = \"Số dòng\",\n    ty_le = \"Tỷ lệ (%)\"\n  ) %>%\n  italic(i = total_row) %>%\n  compose(i = total_row, j = 1, value = as_paragraph(\"Tổng cộng\")) %>%\n  align(align = \"center\", part = \"all\") %>%\n  autofit()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-c87d1368{}.cl-c87a6b68{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c87a6b69{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:italic;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c87b828c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c87b8e08{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e12{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e13{width:0.896in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e1c{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e1d{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e1e{width:0.896in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e26{width:1.007in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e27{width:0.854in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c87b8e28{width:0.896in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-c87d1368'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-c87b8e08\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">Chương</span></p></th><th class=\"cl-c87b8e12\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">Số dòng</span></p></th><th class=\"cl-c87b8e13\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">Tỷ lệ (%)</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c87b8e1c\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">0</span></p></td><td class=\"cl-c87b8e1d\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">13,030</span></p></td><td class=\"cl-c87b8e1e\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b68\">100</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-c87b8e26\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b69\">Tổng cộng</span></p></td><td class=\"cl-c87b8e27\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b69\">13,030</span></p></td><td class=\"cl-c87b8e28\"><p class=\"cl-c87b828c\"><span class=\"cl-c87a6b69\">100</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Vẽ biểu đồ số dòng theo chương cho Pride & Prejudice 📊\nggplot(pride_summary, aes(x = chapter, y = số_dòng)) +\n  geom_col(fill = \"steelblue\") +\n  labs(\n    title = \"Số dòng theo chương - Pride & Prejudice\",\n    x = \"Chương\",\n    y = \"Số dòng\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = 0.5),\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)\n  )\n```\n\n::: {.cell-output-display}\n![](gutenberg_poject_henry_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "gutenberg_poject_henry_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"gutenberg_poject_henry_files/libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"gutenberg_poject_henry_files/libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}