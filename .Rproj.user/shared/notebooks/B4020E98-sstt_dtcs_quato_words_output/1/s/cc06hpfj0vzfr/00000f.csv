"0","# T√≥m t·∫Øt d·ªØ li·ªáu gi·ªõi t√≠nh theo nh√≥m nh·∫≠n th·ª©c"
"0","gioitinh_summary <- df %>%"
"0","  count(phan_loan_roi_loan_nhan_thuc, gender) %>%"
"0","  group_by(phan_loan_roi_loan_nhan_thuc) %>%"
"0","  mutate(percent = n / sum(n) * 100) %>%"
"0","  ungroup()"
"0",""
"0","# B·∫£ng flextable: t·∫ßn s·ªë + % + p-value"
"0","table_gender <- gioitinh_summary %>%"
"0","  mutate(`T·∫ßn s·ªë (%)` = sprintf(""%d (%.1f%%)"", n, percent)) %>%"
"0","  select(`Ch·∫©n ƒëo√°n` = phan_loan_roi_loan_nhan_thuc, `Gi·ªõi t√≠nh` = gender, `T·∫ßn s·ªë (%)`) %>%"
"0","  pivot_wider("
"0","    names_from = `Gi·ªõi t√≠nh`,"
"0","    values_from = `T·∫ßn s·ªë (%)`,"
"0","    values_fill = ""-"""
"0","  )"
"0",""
"0","# T√≠nh p-value (Chi-squared test)"
"0","chisq_gender <- table(df$phan_loan_roi_loan_nhan_thuc, df$gender)"
"0","p_val_gender <- chisq.test(chisq_gender)$p.value"
"0","formatted_p_gender <- ifelse(p_val_gender < 0.001, ""< 0.001"", sprintf(""%.3f"", p_val_gender))"
"0",""
"0","# Th√™m d√≤ng p-value"
"0","table_gender$`Gi√° tr·ªã p` <- c(formatted_p_gender, rep("""", nrow(table_gender) - 1))"
"0",""
"0","# B·∫£ng flextable ho√†n ch·ªânh"
"0","ft_gender <- flextable(table_gender) %>%"
"0","  autofit() %>%"
"0","  align(align = ""center"", part = ""all"") %>%"
"0","  bold(i = 1, part = ""header"") %>%"
"0","  bold(i = which("
"0","    table_gender$`Gi√° tr·ªã p` != """" &"
"0","    table_gender$`Gi√° tr·ªã p` != ""-"" &"
"0","    as.numeric(gsub(""< "", """", table_gender$`Gi√° tr·ªã p`)) < 0.05"
"0","  ),"
"0","  j = ""Gi√° tr·ªã p"", part = ""body"") %>%"
"0","  set_caption(""B·∫£ng: Ph√¢n b·ªë gi·ªõi t√≠nh theo nh√≥m nh·∫≠n th·ª©c (t√¥ ƒë·∫≠m n·∫øu p < 0.05)"") %>%"
"0","  font(fontname = ""Times New Roman"", part = ""all"") %>%"
"0","  fontsize(size = 11, part = ""all"") %>%"
"0","  set_table_properties(width = 1, layout = ""autofit"")  # üî• Fit to Word page"
"0",""
"0","# Bi·ªÉu ƒë·ªì ggplot: s·ªë l∆∞·ª£ng + % hi·ªÉn th·ªã tr√™n c·ªôt"
"0","gioitinh_bar_percent <- ggplot(gioitinh_summary, aes(x = phan_loan_roi_loan_nhan_thuc, y = n, fill = gender)) +"
"0","  geom_bar(stat = ""identity"", position = position_dodge(width = 0.8)) +"
"0","  geom_text("
"0","    aes(label = sprintf(""%.1f%%"", percent)),"
"0","    position = position_dodge(width = 0.8),"
"0","    vjust = -0.3,"
"0","    size = 3.5,"
"0","    family = ""Times New Roman"""
"0","  ) +"
"0","  labs("
"0","    #title = ""Ph√¢n b·ªë gi·ªõi t√≠nh theo nh√≥m nh·∫≠n th·ª©c"","
"0","   x = NULL,"
"0","    y = ""S·ªë l∆∞·ª£ng b·ªánh nh√¢n"","
"0","    fill = ""Gi·ªõi t√≠nh"""
"0","  ) +"
"0","  theme_minimal(base_family = ""Times New Roman"") +"
"0","  theme("
"0","    plot.title = element_text(hjust = 0.5, face = ""bold"", size = 14),"
"0","    axis.title = element_text(size = 12),"
"0","    axis.text = element_text(size = 11),"
"0","    legend.title = element_text(size = 12),"
"0","    legend.text = element_text(size = 11)"
"0","  )"
"0",""
