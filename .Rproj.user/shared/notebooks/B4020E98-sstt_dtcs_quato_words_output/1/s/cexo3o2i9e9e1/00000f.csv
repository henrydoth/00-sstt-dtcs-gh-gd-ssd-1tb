"0","# 1. Tính các chỉ số mô tả"
"0","table_tuoi <- df %>%"
"0","  group_by(phan_loan_roi_loan_nhan_thuc) %>%"
"0","  summarise("
"0","    `Trung bình ± SD` = sprintf(""%.1f ± %.1f"", mean(tuoi, na.rm = TRUE), sd(tuoi, na.rm = TRUE)),"
"0","    `Trung vị (Q1–Q3)` = sprintf(""%.1f (%s–%s)"","
"0","                                 median(tuoi, na.rm = TRUE),"
"0","                                 quantile(tuoi, 0.25, na.rm = TRUE),"
"0","                                 quantile(tuoi, 0.75, na.rm = TRUE)),"
"0","    `Min – Max` = sprintf(""%d – %d"", min(tuoi, na.rm = TRUE), max(tuoi, na.rm = TRUE)),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","  pivot_longer(-phan_loan_roi_loan_nhan_thuc, names_to = ""Chỉ số"", values_to = ""Giá trị"") %>%"
"0","  pivot_wider(names_from = phan_loan_roi_loan_nhan_thuc, values_from = ""Giá trị"")"
"0",""
"0","# 2. Tính p-value"
"0","p_val <- t.test(tuoi ~ phan_loan_roi_loan_nhan_thuc, data = df)$p.value"
"0",""
"0","# 3. Thêm cột p-value cho mỗi chỉ số"
"0","final_table <- table_tuoi %>%"
"0","  mutate(`Giá trị p` = if_else(`Chỉ số` == ""Trung bình ± SD"", sprintf(""%.3f"", p_val), """"))"
"0",""
"0","# 4. Tạo bảng flextable"
"0","ft_tuoi <- flextable(final_table) %>%"
"0","  autofit() %>%"
"0","  align(align = ""center"", part = ""all"") %>%"
"0","  bold(i = 1, part = ""header"") %>%"
"0","  set_caption(""Bảng: So sánh tuổi giữa các nhóm nhận thức (có cột riêng cho p-value)"") %>%"
"0","  set_table_properties(width = 1, layout = ""autofit"")"
