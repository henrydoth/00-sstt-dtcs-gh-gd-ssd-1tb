"0",""
"0","df <- df %>%"
"0","  mutate("
"0","    # Tính năm khám và tuổi"
"0","    year.visit = year(date.visit),"
"0","    tuoi = year.visit - year.born,"
"0","    "
"0","    # Giới tính"
"0","    gender = case_when("
"0","      gender == 1 ~ ""Nam"","
"0","      gender == 2 ~ ""Nữ"","
"0","      TRUE ~ NA_character_"
"0","    ),"
"0","    gender = factor(gender, levels = c(""Nam"", ""Nữ"")),"
"0","    "
"0","    # Trình độ học vấn"
"0","    edu = case_when("
"0","      edu.level == 1 ~ ""Tiểu học"","
"0","      edu.level %in% c(2, 3) ~ ""Trung học"","
"0","      edu.level == 4 ~ ""Đại học"","
"0","      TRUE ~ NA_character_"
"0","    ),"
"0","    edu = factor("
"0","      edu,"
"0","      levels = c(""Tiểu học"", ""Trung học"", ""Đại học"")"
"0","    ),"
"0","    "
"0","    # Gán nhãn chẩn đoán"
"0","    diagno = case_when("
"0","      diagno == 1 ~ ""Suy giảm nhận thức nhẹ"","
"0","      diagno == 2 ~ ""Suy giảm nhận thức chủ quan"","
"0","      diagno == 3 ~ ""Alzheimer"","
"0","      diagno == 4 ~ ""Sa sút trí tuệ mạch máu"","
"0","      diagno == 5 ~ ""Sa sút trí tuệ thùy trán thái dương"","
"0","      diagno == 7 ~ ""Sa sút trí tuệ hỗn hợp"","
"0","      diagno == 8 ~ ""Sa sút trí tuệ do Parkinson"","
"0","      diagno == 9 ~ ""Sa sút trí tuệ khác"","
"0","      TRUE ~ NA_character_"
"0","    )"
"0","  ) %>%"
"0","  # Lọc người ≥40 tuổi & loại bỏ ""Suy giảm nhận thức chủ quan"""
"0","  filter(tuoi >= 40, diagno != ""Suy giảm nhận thức chủ quan"") %>%"
"0","  "
"0","  mutate("
"0","    # Phân nhóm tuổi"
"0","    nhom_tuoi = case_when("
"0","      tuoi < 50 ~ ""40–49"","
"0","      tuoi < 60 ~ ""50–59"","
"0","      tuoi < 70 ~ ""60–69"","
"0","      tuoi < 80 ~ ""70–79"","
"0","      TRUE      ~ ""80+"""
"0","    ),"
"0","    "
"0","    # Định nghĩa factor cho chẩn đoán"
"0","    diagno = factor("
"0","      diagno,"
"0","      levels = c("
"0","        ""Suy giảm nhận thức nhẹ"","
"0","        ""Alzheimer"","
"0","        ""Sa sút trí tuệ mạch máu"","
"0","        ""Sa sút trí tuệ hỗn hợp"","
"0","        ""Sa sút trí tuệ thùy trán thái dương"","
"0","        ""Sa sút trí tuệ do Parkinson"","
"0","        ""Sa sút trí tuệ khác"""
"0","      )"
"0","    ),"
"0","    "
"0","    # Phân loại nhóm nhận thức: MCI vs Sa sút trí tuệ"
"0","    phan_loan_roi_loan_nhan_thuc = case_when("
"0","      diagno == ""Suy giảm nhận thức nhẹ"" ~ ""MCI"","
"0","      !is.na(diagno) ~ ""Sa sút trí tuệ"""
"0","    ),"
"0","    phan_loan_roi_loan_nhan_thuc = factor("
"0","      phan_loan_roi_loan_nhan_thuc,"
"0","      levels = c(""MCI"", ""Sa sút trí tuệ"")"
"0","    )"
"0","  )"
