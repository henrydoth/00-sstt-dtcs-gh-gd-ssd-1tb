---
title: "Äá»€ TÃ€I CÆ  Sá» SA SÃšT TRÃ TUá»†"
subtitle: "Neurocognitive tests"
author: "BS.CK2. Äá»– THANH LIÃŠM"
format:
  docx:
    toc: true
    number-sections: false
    reference-doc: sstt_dtcs_quato_words_input.docx
bibliography: sstt_reference.bib
csl: ama.csl
editor: source
---

```{r}
#| label: pacman vÃ  cÃ¡c thÆ° viá»‡n
#| include: false
# thÆ° viá»‡n
library(pacman)
pacman::p_load(dplyr, flextable, tidyr,readr,  haven, tidyverse, labelled, ggplot2, officer, officedown, lubridate, glue
)
```


```{r}
#| label: CÃ i Ä‘áº·t máº·c Ä‘á»‹nh style
#| echo: false

# Thiáº¿t láº­p máº·c Ä‘á»‹nh cho táº¥t cáº£ flextable
set_flextable_defaults(
  font.family = "Times New Roman",  # optional: consistent font
  font.size = 11,
  align = "center",
  padding = 3,
  theme_fun = theme_booktabs,
  layout = "autofit",               # allows Word to adjust columns
  width = 1                         # 100% of page width
)
# Set global ggplot theme
theme_set(
  theme_minimal(base_family = "Times New Roman") +
    theme(
      text = element_text(family = "Times New Roman"),         # applies to all text
      plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
      axis.title = element_text(size = 12),
      axis.text = element_text(size = 11),
      legend.text = element_text(size = 11),
      legend.title = element_text(size = 11),
      strip.text = element_text(size = 12)  # for facet titles
    )
)
# Globally override default color and fill palettes
scale_color_discrete <- function(...) scale_color_brewer(palette = "Set1", ...)
scale_fill_discrete  <- function(...) scale_fill_brewer(palette = "Pastel2", ...)
```

```{r}
#| label: cÃ i gÃ y thÃ¡ng hiá»ƒn thá»‹
#| include: false

current_datetime <- now()
thu <- if (wday(current_datetime) == 1) "Chá»§ nháº­t" else paste("Thá»©", wday(current_datetime) - 1)
gio <- format(current_datetime, "%H:%M")
ngay <- day(current_datetime)
thang <- month(current_datetime)
nam <- year(current_datetime)
formatted_datetime <- paste0("vÃ o ", gio, ", ", thu, ", ngÃ y ", ngay, " thÃ¡ng ", thang, " nÄƒm ", nam)

```

::: {custom-style="CAN GIUA DAM 14 ONE"}
Lá»œI NÃ“I Äáº¦U
:::


```{r}
#| label: cÃ¡c cÃ¢u cáº£m Æ¡n
#| include: false

# Danh sÃ¡ch lá»i cáº£m Æ¡n vÃ  mÃ u chá»¯
messages <- c(
  "Vá»£ vÃ  cÃ¡c con vÃ¬ Ä‘Ã£ cho tÃ´i tÃ¬nh yÃªu",
  "Bá»‘ máº¹ vÃ¬ Ä‘Ã£ cho tÃ´i cuá»™c Ä‘á»i",
  "Tháº§y cÃ´ vÃ¬ Ä‘Ã£ cho tÃ´i kiáº¿n thá»©c",
  "Báº¡n bÃ¨ vÃ¬ Ä‘Ã£ cho tÃ´i sá»± Ä‘á»™ng viÃªn",
  "Äá»“ng nghiá»‡p vÃ¬ Ä‘Ã£ há»£p tÃ¡c, thÃ¢n Ã¡i, giÃºp Ä‘á»¡"
)

colors <- c("red", "blue", "green", "orange", "purple")

# Chá»n ngáº«u nhiÃªn má»™t cÃ¢u + mÃ u
msg <- sample(messages, 1)
color <- sample(colors, 1)

# CÃ¢u cáº£m Æ¡n (font Segoe Print, size 16, mÃ u ngáº«u nhiÃªn)
ft_msg <- ftext(
  glue("TÃ´i xin chÃ¢n thÃ nh cáº£m Æ¡n {msg}."), 
  prop = fp_text(font.family = "Segoe Print", font.size = 16, color = color)
)

# TÃªn ngÆ°á»i kÃ½ (Segoe Print, size 16, khÃ´ng mÃ u)
ft_name <- ftext(
  "Äá»— Thanh LiÃªm", 
  prop = fp_text(font.family = "Segoe Print", font.size = 16)
)
```


`r ft_msg`

`r ft_name`


```{=openxml}
<w:p><w:r><w:br/></w:r></w:p>
```


```{r}
#| label: ChÃ¨n hÃ¬nh 4 inc ngáº«u nhiÃªn
#| echo: false
#| fig-align: center
# fig-cap: HÃ¬nh áº£nh ngáº«u nhiÃªn
#| out-width: 4in

library(jpeg)
library(png)
library(grid)

imgs <- list.files("images", pattern = "\\.(jpg|jpeg|png)$", full.names = TRUE)
img <- sample(imgs, 1)

ext <- tools::file_ext(img)

# Read and display image based on format
if (ext == "png") {
  img_data <- png::readPNG(img)
} else {
  img_data <- jpeg::readJPEG(img)
}

grid::grid.raster(img_data)
```



```{r}
#| label: quotes
#| echo: false


quotes <- c(
  "The best way to predict the future is to invent it. â€“ Alan Kay",
  "Life is what happens when you're busy making other plans. â€“ John Lennon",
  "Do not dwell in the past, do not dream of the future, concentrate the mind on the present moment. â€“ Buddha",
  "Success is not final, failure is not fatal: It is the courage to continue that counts. â€“ Winston Churchill",
  "In the middle of difficulty lies opportunity. â€“ Albert Einstein"
)

quote <- sample(quotes, 1)

# Print one line break before the table
cat("\n")

ft <- flextable(data.frame(Quote = quote))
ft <- set_table_properties(ft, width = .75, layout = "autofit")
ft <- italic(ft, j = "Quote")
ft <- align(ft, align = "center", part = "all")
ft <- border_remove(ft)
ft <- padding(ft, padding = 6)
ft <- fontsize(ft, size = 16, part = "all")
ft <- color(ft, color = "blue", part = "all")

ft

# Print one line break after the table
cat("\n")
```

::: {custom-style="Title"}
TP Há»“ ChÃ­ Minh: `r formatted_datetime`
:::

# MÃƒ Lá»†NH

## Setup dá»¯ liá»‡u

```{r}
#| label: load dá»¯ liá»‡u sav vÃ  lÆ°u csv
#| echo: true
#| message: false
#| warning: false
#| paged-print: false

df_sav <- read_sav("sstt304_28_03_24.sav", encoding = "latin1")
write.csv(df_sav, "sstt304_clean.csv")
```

```{r}

#| label: Chá»n bá»™ Test VnCo má»›i, vÃ  phÃ¢n loáº¡i Sa sÃºt trÃ­ tuá»‡ theo tiÃªu chuáº©n cá»§a MMSE 

df <-  read_csv("sstt304_clean.csv") 
df <- df %>%
    dplyr::filter(new.old.tests != 1) %>%
    drop_na(mmse.new)

```

```{r}

df <- df %>%
  mutate(
    # TÃ­nh nÄƒm khÃ¡m vÃ  tuá»•i
    year.visit = year(date.visit),
    tuoi = year.visit - year.born,
    
    # Giá»›i tÃ­nh
    gender = case_when(
      gender == 1 ~ "Nam",
      gender == 2 ~ "Ná»¯",
      TRUE ~ NA_character_
    ),
    gender = factor(gender, levels = c("Nam", "Ná»¯")),
    
    # TrÃ¬nh Ä‘á»™ há»c váº¥n
    edu = case_when(
      edu.level == 1 ~ "Tiá»ƒu há»c",
      edu.level %in% c(2, 3) ~ "Trung há»c",
      edu.level == 4 ~ "Äáº¡i há»c",
      TRUE ~ NA_character_
    ),
    edu = factor(
      edu,
      levels = c("Tiá»ƒu há»c", "Trung há»c", "Äáº¡i há»c")
    ),
    
    # GÃ¡n nhÃ£n cháº©n Ä‘oÃ¡n
    diagno = case_when(
      diagno == 1 ~ "Suy giáº£m nháº­n thá»©c nháº¹",
      diagno == 2 ~ "Suy giáº£m nháº­n thá»©c chá»§ quan",
      diagno == 3 ~ "Alzheimer",
      diagno == 4 ~ "Sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u",
      diagno == 5 ~ "Sa sÃºt trÃ­ tuá»‡ thÃ¹y trÃ¡n thÃ¡i dÆ°Æ¡ng",
      diagno == 7 ~ "Sa sÃºt trÃ­ tuá»‡ há»—n há»£p",
      diagno == 8 ~ "Sa sÃºt trÃ­ tuá»‡ do Parkinson",
      diagno == 9 ~ "Sa sÃºt trÃ­ tuá»‡ khÃ¡c",
      TRUE ~ NA_character_
    )
  ) %>%
  # Lá»c ngÆ°á»i â‰¥40 tuá»•i & loáº¡i bá» "Suy giáº£m nháº­n thá»©c chá»§ quan"
  filter(tuoi >= 40, diagno != "Suy giáº£m nháº­n thá»©c chá»§ quan") %>%
  
  mutate(
    # PhÃ¢n nhÃ³m tuá»•i
    nhom_tuoi = case_when(
      tuoi < 50 ~ "40â€“49",
      tuoi < 60 ~ "50â€“59",
      tuoi < 70 ~ "60â€“69",
      tuoi < 80 ~ "70â€“79",
      TRUE      ~ "80+"
    ),
    
    # Äá»‹nh nghÄ©a factor cho cháº©n Ä‘oÃ¡n
    diagno = factor(
      diagno,
      levels = c(
        "Suy giáº£m nháº­n thá»©c nháº¹",
        "Alzheimer",
        "Sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u",
        "Sa sÃºt trÃ­ tuá»‡ há»—n há»£p",
        "Sa sÃºt trÃ­ tuá»‡ thÃ¹y trÃ¡n thÃ¡i dÆ°Æ¡ng",
        "Sa sÃºt trÃ­ tuá»‡ do Parkinson",
        "Sa sÃºt trÃ­ tuá»‡ khÃ¡c"
      )
    ),
    
    # PhÃ¢n loáº¡i nhÃ³m nháº­n thá»©c: MCI vs Sa sÃºt trÃ­ tuá»‡
    phan_loan_roi_loan_nhan_thuc = case_when(
      diagno == "Suy giáº£m nháº­n thá»©c nháº¹" ~ "MCI",
      !is.na(diagno) ~ "Sa sÃºt trÃ­ tuá»‡"
    ),
    phan_loan_roi_loan_nhan_thuc = factor(
      phan_loan_roi_loan_nhan_thuc,
      levels = c("MCI", "Sa sÃºt trÃ­ tuá»‡")
    )
  )
```

## Äáº·c Ä‘iá»ƒm máº«u nghiÃªn cá»©u

### Äáº·c Ä‘iá»ƒm theo tuá»•i

#### Báº£ng theo tuá»•i

```{r}
#| echo: false
# TÃ­nh trung bÃ¬nh cho tuá»•i chÃ¨n inline codes
mean_age <- round(mean(df$age, na.rm = TRUE), 1)
sd_age   <- round(sd(df$age, na.rm = TRUE), 1)

glue::glue("Tuá»•i trung bÃ¬nh: {mean_age} Â± {sd_age} tuá»•i")

age_summary_by_group <- df %>%
  filter(!is.na(age), !is.na(phan_loan_roi_loan_nhan_thuc)) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  summarise(
    mean_age = round(mean(age, na.rm = TRUE), 1),
    sd_age   = round(sd(age, na.rm = TRUE), 1),
    .groups = "drop"
  )

# Láº¥y káº¿t quáº£ cho tá»«ng nhÃ³m
mci <- age_summary_by_group %>% filter(phan_loan_roi_loan_nhan_thuc == "MCI")
ssd <- age_summary_by_group %>% filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡")

# In dáº¡ng glue
glue("Tuá»•i trung bÃ¬nh nhÃ³m MCI: {mci$mean_age} Â± {mci$sd_age} tuá»•i")
glue("Tuá»•i trung bÃ¬nh nhÃ³m Sa sÃºt trÃ­ tuá»‡: {ssd$mean_age} Â± {ssd$sd_age} tuá»•i")

```

```{r}
# 1. TÃ­nh cÃ¡c chá»‰ sá»‘ mÃ´ táº£
table_tuoi <- df %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  summarise(
    `Trung bÃ¬nh Â± SD` = sprintf("%.1f Â± %.1f", mean(tuoi, na.rm = TRUE), sd(tuoi, na.rm = TRUE)),
    `Trung vá»‹ (Q1â€“Q3)` = sprintf("%.1f (%sâ€“%s)",
                                 median(tuoi, na.rm = TRUE),
                                 quantile(tuoi, 0.25, na.rm = TRUE),
                                 quantile(tuoi, 0.75, na.rm = TRUE)),
    `Min â€“ Max` = sprintf("%d â€“ %d", min(tuoi, na.rm = TRUE), max(tuoi, na.rm = TRUE)),
    .groups = "drop"
  ) %>%
  pivot_longer(-phan_loan_roi_loan_nhan_thuc, names_to = "Chá»‰ sá»‘", values_to = "GiÃ¡ trá»‹") %>%
  pivot_wider(names_from = phan_loan_roi_loan_nhan_thuc, values_from = "GiÃ¡ trá»‹")

# 2. TÃ­nh p-value
p_val <- t.test(tuoi ~ phan_loan_roi_loan_nhan_thuc, data = df)$p.value

# 3. ThÃªm cá»™t p-value cho má»—i chá»‰ sá»‘
final_table <- table_tuoi %>%
  mutate(`GiÃ¡ trá»‹ p` = if_else(`Chá»‰ sá»‘` == "Trung bÃ¬nh Â± SD", sprintf("%.3f", p_val), ""))

# 4. Táº¡o báº£ng flextable
ft_tuoi <- flextable(final_table) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  set_caption("Báº£ng: So sÃ¡nh tuá»•i giá»¯a cÃ¡c nhÃ³m nháº­n thá»©c (cÃ³ cá»™t riÃªng cho p-value)")

```

```{r tbl-tuoi-flextable, echo=FALSE, results='asis'}
ft_tuoi
```

#### Báº£ng theo nhÃ³m tuá»•i

```{r}
# BÆ°á»›c 1: Äáº£m báº£o Ä‘Ãºng thá»© tá»± nhÃ³m tuá»•i
df$nhom_tuoi <- factor(df$nhom_tuoi, levels = c("40â€“49", "50â€“59", "60â€“69", "70â€“79", "80+"))

# BÆ°á»›c 2: Táº¡o báº£ng táº§n sá»‘ vÃ  pháº§n trÄƒm theo cháº©n Ä‘oÃ¡n vÃ  nhÃ³m tuá»•i
table_freq <- df %>%
  count(phan_loan_roi_loan_nhan_thuc, nhom_tuoi) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup() %>%
  mutate(`Táº§n sá»‘ (%)` = sprintf("%d (%.1f%%)", n, percent)) %>%
  select(`Cháº©n Ä‘oÃ¡n` = phan_loan_roi_loan_nhan_thuc, `NhÃ³m tuá»•i` = nhom_tuoi, `Táº§n sá»‘ (%)`) %>%
  pivot_wider(
    names_from = `NhÃ³m tuá»•i`,
    values_from = `Táº§n sá»‘ (%)`,
    values_fill = "-"
  )

# BÆ°á»›c 3: TÃ­nh p-value tá»« báº£ng táº§n sá»‘
chisq_data <- table(df$phan_loan_roi_loan_nhan_thuc, df$nhom_tuoi)
p_val <- chisq.test(chisq_data)$p.value
formatted_p <- ifelse(p_val < 0.001, "< 0.001", sprintf("%.3f", p_val))

# ThÃªm cá»™t "GiÃ¡ trá»‹ p" vÃ o dÃ²ng Ä‘áº§u tiÃªn
table_freq$`GiÃ¡ trá»‹ p` <- c(formatted_p, rep("", nrow(table_freq) - 1))

# BÆ°á»›c 4: Táº¡o báº£ng flextable vÃ  tÃ´ Ä‘áº­m náº¿u p < 0.05
ft_freq_p <- flextable(table_freq) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  bold(i = which(
    table_freq$`GiÃ¡ trá»‹ p` != "" &
    table_freq$`GiÃ¡ trá»‹ p` != "-" &
    as.numeric(gsub("< ", "", table_freq$`GiÃ¡ trá»‹ p`)) < 0.05
  ),
  j = "GiÃ¡ trá»‹ p", part = "body") %>%
  set_caption("Báº£ng: Táº§n sá»‘ vÃ  tá»· lá»‡ pháº§n trÄƒm nhÃ³m tuá»•i theo cháº©n Ä‘oÃ¡n (tÃ´ Ä‘áº­m náº¿u p < 0.05)")
```

```{r}
ft_freq_p
```

#### Biá»ƒu Ä‘á»“ theo tuá»•i

```{r}
tuoi_gp <- ggplot(df, aes(x = phan_loan_roi_loan_nhan_thuc, y = tuoi, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(
    aes(color = phan_loan_roi_loan_nhan_thuc),
    width = 0.2, size = 1.5, alpha = 0.5
  ) +
  labs(
    x = NULL,  
    y = "Tuá»•i"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    legend.position = "none",
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11)
  )

```

```{r}
tuoi_gp
```

### Biá»ƒu Ä‘á»“ theo nhÃ³m tuá»•i

```{r}
df$nhom_tuoi <- factor(df$nhom_tuoi, levels = c("40â€“49", "50â€“59", "60â€“69", "70â€“79", "80+"))

nhom_tuoi_gp <- ggplot(df, aes(x = nhom_tuoi, y = tuoi, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7, position = position_dodge(width = 0.75)) +
  labs(
    x = "NhÃ³m tuá»•i",
    y = "Tuá»•i",
    fill = "Cháº©n Ä‘oÃ¡n"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    text = element_text(family = "Times New Roman"),  # <- ensures all text uses Times
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11),
    legend.position = "top"
  )

```

```{r}
nhom_tuoi_gp
```

### Äáº·c Ä‘iá»ƒm giá»›i tÃ­nh

```{r}
# TÃ³m táº¯t dá»¯ liá»‡u giá»›i tÃ­nh theo nhÃ³m nháº­n thá»©c
gioitinh_summary <- df %>%
  count(phan_loan_roi_loan_nhan_thuc, gender) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup()

# Báº£ng flextable: táº§n sá»‘ + % + p-value
table_gender <- gioitinh_summary %>%
  mutate(`Táº§n sá»‘ (%)` = sprintf("%d (%.1f%%)", n, percent)) %>%
  select(`Cháº©n Ä‘oÃ¡n` = phan_loan_roi_loan_nhan_thuc, `Giá»›i tÃ­nh` = gender, `Táº§n sá»‘ (%)`) %>%
  pivot_wider(
    names_from = `Giá»›i tÃ­nh`,
    values_from = `Táº§n sá»‘ (%)`,
    values_fill = "-"
  )

# TÃ­nh p-value (Chi-squared test)
chisq_gender <- table(df$phan_loan_roi_loan_nhan_thuc, df$gender)
p_val_gender <- chisq.test(chisq_gender)$p.value
formatted_p_gender <- ifelse(p_val_gender < 0.001, "< 0.001", sprintf("%.3f", p_val_gender))

# ThÃªm dÃ²ng p-value
table_gender$`GiÃ¡ trá»‹ p` <- c(formatted_p_gender, rep("", nrow(table_gender) - 1))

# Báº£ng flextable hoÃ n chá»‰nh
ft_gender <- flextable(table_gender) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  bold(i = which(
    table_gender$`GiÃ¡ trá»‹ p` != "" &
    table_gender$`GiÃ¡ trá»‹ p` != "-" &
    as.numeric(gsub("< ", "", table_gender$`GiÃ¡ trá»‹ p`)) < 0.05
  ),
  j = "GiÃ¡ trá»‹ p", part = "body") %>%
  set_caption("Báº£ng: PhÃ¢n bá»‘ giá»›i tÃ­nh theo nhÃ³m nháº­n thá»©c (tÃ´ Ä‘áº­m náº¿u p < 0.05)") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_table_properties(width = 1, layout = "autofit")  # ğŸ”¥ Fit to Word page

# Biá»ƒu Ä‘á»“ ggplot: sá»‘ lÆ°á»£ng + % hiá»ƒn thá»‹ trÃªn cá»™t
gioitinh_bar_percent <- ggplot(gioitinh_summary, aes(x = phan_loan_roi_loan_nhan_thuc, y = n, fill = gender)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  geom_text(
    aes(label = sprintf("%.1f%%", percent)),
    position = position_dodge(width = 0.8),
    vjust = -0.3,
    size = 3.5,
    family = "Times New Roman"
  ) +
  labs(
    #title = "PhÃ¢n bá»‘ giá»›i tÃ­nh theo nhÃ³m nháº­n thá»©c",
   x = NULL,
    y = "Sá»‘ lÆ°á»£ng bá»‡nh nhÃ¢n",
    fill = "Giá»›i tÃ­nh"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11)
  )

```

-Inline codes tiá»›i tÃ­nh

```{r}
# 1. TÃ³m táº¯t tá»· lá»‡ ná»¯ theo nhÃ³m nháº­n thá»©c
gender_summary <- df %>%
  count(phan_loan_roi_loan_nhan_thuc, gender) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup() %>%
  filter(gender == "Ná»¯")  # chá»‰ láº¥y tá»· lá»‡ ná»¯

# 2. HÃ m an toÃ n láº¥y pháº§n trÄƒm ná»¯ cho tá»«ng nhÃ³m
lay_phan_tram_nu <- function(nhom) {
  ket_qua <- gender_summary %>%
    filter(phan_loan_roi_loan_nhan_thuc == nhom) %>%
    pull(percent)
  if (length(ket_qua) == 0) return(0) else return(round(ket_qua, 1))
}

# 3. Láº¥y pháº§n trÄƒm ná»¯ theo nhÃ³m
nu_mci  <- lay_phan_tram_nu("MCI")
nu_sstt <- lay_phan_tram_nu("Sa sÃºt trÃ­ tuá»‡")

# 4. TÃ­nh p-value tá»« kiá»ƒm Ä‘á»‹nh giá»›i tÃ­nh ~ nhÃ³m nháº­n thá»©c
p_gender <- chisq.test(table(df$phan_loan_roi_loan_nhan_thuc, df$gender))$p.value

# 5. Diá»…n giáº£i theo p-value
dien_giai_gt <- ifelse(
  p_gender > 0.05,
  glue("Sá»± khÃ¡c biá»‡t khÃ´ng cÃ³ Ã½ nghÄ©a thá»‘ng kÃª vá»›i p = {sprintf('%.3f', p_gender)}."),
  glue("Sá»± khÃ¡c biá»‡t cÃ³ Ã½ nghÄ©a thá»‘ng kÃª vá»›i p = {sprintf('%.3f', p_gender)}.")
)

# 6. CÃ¢u mÃ´ táº£ cuá»‘i cÃ¹ng (Ä‘á»ƒ dÃ¹ng inline)
cau_gioitinh_mota <- glue::glue(
  "Trong nghiÃªn cá»©u nÃ y, á»Ÿ nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹, ná»¯ giá»›i chiáº¿m {nu_mci}%. ",
  "á» nhÃ³m Sa sÃºt trÃ­ tuá»‡, ná»¯ giá»›i chiáº¿m {nu_sstt}%. ",
  "{dien_giai_gt}"
)

```

-   Báº£ng theo giá»›i tÃ­nh

```{r}
ft_gender
```

-   Biá»ƒu Ä‘á»“ theo giá»›i tÃ­nh

```{r}
gioitinh_bar_percent
```

### Äáº·c Ä‘iá»ƒm trÃ¬nh Ä‘á»™ há»c váº¥n

```{r}
# 1. Táº¡o báº£ng phÃ¢n bá»‘ trÃ¬nh Ä‘á»™ há»c váº¥n theo nhÃ³m
tbl_edu_diag <- df %>%
  filter(!is.na(edu), !is.na(phan_loan_roi_loan_nhan_thuc)) %>%
  count(phan_loan_roi_loan_nhan_thuc, edu) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  mutate(ty_le = round(100 * n / sum(n), 1)) %>%
  ungroup()

# 2. Kiá»ƒm Ä‘á»‹nh thá»‘ng kÃª: Chi-squared hoáº·c Fisher
tbl_chisq <- df %>%
  filter(!is.na(edu), !is.na(phan_loan_roi_loan_nhan_thuc)) %>%
  select(phan_loan_roi_loan_nhan_thuc, edu) %>%
  table()

use_fisher <- any(tbl_chisq < 5)

test_result <- if (use_fisher) {
  fisher.test(tbl_chisq)
} else {
  chisq.test(tbl_chisq)
}

pval_edu <- test_result$p.value

# 3. Biá»ƒu Ä‘á»“ ggplot
plot_edu <- ggplot(tbl_edu_diag, aes(x = edu, y = ty_le, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = paste0(ty_le, "%")), 
            position = position_dodge(width = 0.9), vjust = -0.3) +
  labs(
    title = "PhÃ¢n bá»‘ trÃ¬nh Ä‘á»™ há»c váº¥n theo nhÃ³m cháº©n Ä‘oÃ¡n",
    x = "TrÃ¬nh Ä‘á»™ há»c váº¥n",
    y = "Tá»· lá»‡ (%)",
    fill = "NhÃ³m"
  ) +
  theme_minimal()

# 4. Báº£ng flextable
tbl_edu_wide <- tbl_edu_diag %>%
  select(NhÃ³m = phan_loan_roi_loan_nhan_thuc, `TrÃ¬nh Ä‘á»™ há»c váº¥n` = edu, `Tá»· lá»‡ (%)` = ty_le) %>%
  pivot_wider(names_from = NhÃ³m, values_from = `Tá»· lá»‡ (%)`)

ft_edu <- flextable(tbl_edu_wide) %>%
  autofit()
```

-   Báº£ng theo trÃ¬nh Ä‘á»™ há»c váº¥n

```{r}
ft_edu
```

-   Biá»ƒu Ä‘á»“ theo trÃ¬nh Ä‘á»™ há»c váº¥n

```{r}
plot_edu
```

Trong nghiÃªn cá»©u nÃ y, á»Ÿ nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹, trÃ¬nh Ä‘á»™ há»c váº¥n "Tiá»ƒu há»c", "Trung há»c", "Äáº¡i há»c" láº§n lÆ°á»£t lÃ  **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "MCI", edu == "Tiá»ƒu há»c") %>% pull(ty_le)`%**, **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "MCI", edu == "Trung há»c") %>% pull(ty_le)`%**, vÃ  **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "MCI", edu == "Äáº¡i há»c") %>% pull(ty_le)`%**.\
á» nhÃ³m Sa sÃºt trÃ­ tuá»‡, tá»· lá»‡ tÆ°Æ¡ng á»©ng lÃ  **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡", edu == "Tiá»ƒu há»c") %>% pull(ty_le)`%**, **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡", edu == "Trung há»c") %>% pull(ty_le)`%**, vÃ  **`r tbl_edu_diag %>% filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡", edu == "Äáº¡i há»c") %>% pull(ty_le)`%**.\
Sá»± khÃ¡c biá»‡t **`r ifelse(pval_edu < 0.05, "cÃ³", "khÃ´ng cÃ³")`** Ã½ nghÄ©a thá»‘ng kÃª vá»›i p = **`r format.pval(pval_edu, digits = 3, eps = 0.001)`**.

::: {custom-style="CAN GIUA DAM 14 ONE"}
Äáº¶T Váº¤N Äá»€
:::

Viá»‡t Nam lÃ  má»™t trong cÃ¡c quá»‘c gia cÃ³ tá»‘c Ä‘á»™ giÃ  hÃ³a dÃ¢n sá»‘ nhanh nháº¥t tháº¿ giá»›i. NgÆ°á»i ta Æ°á»›c tÃ­nh ráº±ng hÆ¡n 10% dÃ¢n sá»‘ Viá»‡t Nam bao gá»“m nhá»¯ng ngÆ°á»i tá»« 60 tuá»•i trá»Ÿ lÃªn [@tong2017ageing], tá»« nÄƒm 2015 Ä‘áº¿n nÄƒm 2020, tá»· lá»‡ dÃ¢n sá»‘ trÃªn 65 tuá»•i á»Ÿ Viá»‡t Nam tÄƒng tá»« 6,7% lÃªn 7,9% vÃ  sáº½ tiáº¿p tá»¥c cho tháº¥y xu hÆ°á»›ng tÄƒng Ä‘áº¿n nÄƒm 2050 [@nguyen2021share]. Tá»· lá»‡ dÃ¢n sá»‘ tá»« 60 tuá»•i trá»Ÿ lÃªn dá»± kiáº¿n sáº½ chiáº¿m 20,4% tá»•ng dÃ¢n sá»‘ Viá»‡t Nam vÃ o nÄƒm 20383. Dá»±a trÃªn cÃ¡c xu hÆ°á»›ng nhÃ¢n kháº©u há»c nÃ y, dá»± kiáº¿n Ä‘áº¿n nÄƒm 2050, sáº½ cÃ³ 29 triá»‡u ngÆ°á»i trÃªn 60 tuá»•i, chiáº¿m má»™t pháº§n ba dÃ¢n sá»‘ cáº£ nÆ°á»›c, trong Ä‘Ã³ nhá»¯ng ngÆ°á»i trÃªn 80 tuá»•i dá»± kiáº¿n sáº½ chiáº¿m Ã­t nháº¥t 6% toÃ n bá»™ dÃ¢n sá»‘ [@helpage2019vietnam].

CÃ¹ng vá»›i viá»‡c giÃ  hÃ³a dÃ¢n sá»‘, tá»‰ lá»‡ ngÆ°á»i sa sÃºt trÃ­ tuá»‡ cÅ©ng tÄƒng lÃªn, sá»‘ ngÆ°á»i máº¯c chá»©ng sa sÃºt trÃ­ tuá»‡ Æ°á»›c tÃ­nh tÄƒng gáº¥p Ä‘Ã´i sau má»—i 20 nÄƒm, tá»« 660.000 vÃ o nÄƒm 2015 lÃªn 1,2 triá»‡u vÃ o nÄƒm 2030 vÃ  2,4 triá»‡u vÃ o nÄƒm 2050[@nguyen2020dementia]. Sa sÃºt trÃ­ tuá»‡ (SSTT) lÃ  má»™t bá»‡nh lÃ½ cá»§a nÃ£o bá»™, gÃ¢y ra suy giáº£m chá»©c nÄƒng nháº­n thá»©c, hÃ nh vi vÃ  hoáº¡t Ä‘á»™ng sá»‘ng cá»§a bá»‡nh nhÃ¢n. Sa sÃºt trÃ­ tuá»‡ lÃ  thuáº­t ngá»¯ rá»™ng dÃ¹ng Ä‘á»ƒ mÃ´ táº£ tÃ¬nh tráº¡ng máº¥t trÃ­ nhá»›, nháº­n thá»©c, lÃ½ trÃ­, ká»¹ nÄƒng xÃ£ há»™i vÃ  thá»ƒ cháº¥t.

CÃ³ nhiá»u loáº¡i sa sÃºt trÃ­ tuá»‡ bao gá»“m bá»‡nh Alzheimer, sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u, sa sÃºt trÃ­ tuá»‡ trÃ¡n thÃ¡i dÆ°Æ¡ng vÃ  bá»‡nh thá»ƒ Lewy. Sa sÃºt trÃ­ tuá»‡ cÃ³ thá»ƒ xáº£y ra vá»›i báº¥t ká»³ ai, nhÆ°ng phá»• biáº¿n hÆ¡n sau tuá»•i 65[@aihw2022dementia].

Tá»« nÄƒm 2019 Ä‘áº¿n nay, ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Ã£ sá»­ dá»¥ng bá»™ tráº¯c nghiá»‡m (Test) Ä‘Ã¡nh giÃ¡ chá»©c nÄƒng tháº§n kinh nháº­n thá»©c Viá»‡t Nam (VnCA- Vietnamese Cognitive Assessment), Há»™i bá»‡nh Alzheimer vÃ  Rá»‘i loáº¡n tháº§n kinh nháº­n thá»©c Viá»‡t Nam (Vietnam Alzheimer Disease & Neurocognitive Disorders Association â€“ VnADA), chuyÃªn gia Trung tÃ¢m Bá»‡nh thoÃ¡i hÃ³a tháº§n kinh Äá»©c (DZNE), ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 cÃ¹ng phÃ¡t triá»ƒn.

**Má»¥c tiÃªu nghiÃªn cá»©u cá»§a nhiá»‡m vá»¥**

-   NghiÃªn cá»©u má»‘i tÆ°Æ¡ng quan cá»§a thang Ä‘iá»ƒm MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c táº¡i Bá»‡nh viá»‡n 30-4.

-   ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng cá»§a bá»™ Test tháº§n kinh nháº­n thá»©c trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ Sa sÃºt trÃ­ tuá»‡ táº¡i Bá»‡nh viá»‡n 30-4

# Tá»”NG QUANG TÃ€I LIá»†U

## Äáº¡i cÆ°Æ¡ng sa sÃºt trÃ­ tuá»‡

Äang ghi

# Äá»I TÆ¯á»¢NG VÃ€ PHÆ¯Æ NG PHÃP NGHIÃŠN Cá»¨U

## DÃ¢n sá»‘ má»¥c tiÃªu:

Bá»‡nh nhÃ¢n sa sÃºt trÃ­ tuá»‡ trong bá»‘i cáº£nh ngoáº¡i trÃº á»Ÿ cÃ¡c khoa â€“ phÃ²ng khÃ¡m lÃ¢m sÃ ng chuyÃªn vá» trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡.

## DÃ¢n sá»‘ chá»n máº«u:

Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m vÃ  Ä‘iá»u trá»‹ táº¡i phÃ²ng khÃ¡m thuá»™c ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡, bá»‡nh viá»‡n 30-4.

### Cá»¡ máº«u:

Cá»¡ máº«u tá»‘i thiá»ƒu cho nghiÃªn cá»©u Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh theo cÃ´ng thá»©c Æ°á»›c lÆ°á»£ng má»™t tá»· lá»‡:

$$
  n = \frac{Z_{(1 - \alpha/2)}^2 \cdot p(1 - p)}{\varepsilon^2}
$$

Trong Ä‘Ã³:

-   $n$: cá»¡ máº«u cáº§n thiáº¿t
-   $\alpha$: má»©c Ã½ nghÄ©a thá»‘ng kÃª, chá»n $\alpha = 0.05$
-   $Z_{(1 - \alpha/2)} = 1.96$: giÃ¡ trá»‹ Z tÆ°Æ¡ng á»©ng vá»›i má»©c tin cáº­y 95%
-   $p$: tá»· lá»‡ Ä‘iá»u trá»‹ hiá»‡u quáº£. Theo nghiÃªn cá»©u cá»§a Schroeder RW, tá»· lá»‡ tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c phÃ¡t hiá»‡n bá»‡nh nhÃ¢n sa sÃºt trÃ­ tuá»‡ lÃ  **75%**, nÃªn chá»n $p = 0.75$
-   $\varepsilon = 0.05$: sai sá»‘ cháº¥p nháº­n trong nghiÃªn cá»©u

Thay vÃ o cÃ´ng thá»©c:

$$
  n = \frac{(1.96)^2 \cdot 0.75 \cdot (1 - 0.75)}{(0.05)^2} = \frac{3.8416 \cdot 0.1875}{0.0025} = \frac{0.7203}{0.0025} \approx 288.12
$$

**â†’ Cá»¡ máº«u cáº§n thiáº¿t lÃ  Ã­t nháº¥t 288 bá»‡nh nhÃ¢n.**

### Ká»¹ thuáº­t chá»n máº«u:

Äá»‘i vá»›i há»“i cá»©u: PhÆ°Æ¡ng phÃ¡p chá»n máº«u Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  phÆ°Æ¡ng phÃ¡p chá»n máº«u dá»±a vÃ o danh sÃ¡ch bá»‡nh nhÃ¢n Ä‘ang Ä‘iá»u trá»‹ táº¡i khoa, Ä‘á»‘i chiáº¿u cÃ¡c tiÃªu chuáº©n chá»n vÃ o vÃ  tiÃªu chuáº©n loáº¡i trá»« vá»›i há»“ sÆ¡ bá»‡nh Ã¡n cÃ³ sáºµn. Sau Ä‘Ã³, trong sá»‘ nhá»¯ng bá»‡nh nhÃ¢n hoÃ n toÃ n phÃ¹ há»£p vá»›i tiÃªu chuáº©n chá»n vÃ o vÃ  khÃ´ng cÃ³ báº¥t ká»³ tiÃªu chuáº©n loáº¡i trá»« nÃ o sáº½ Ä‘Æ°á»£c chá»n.

Äá»‘i vá»›i tiáº¿n cá»©u, nhá»¯ng bá»‡nh nhÃ¢n Ä‘Æ°á»£c chá»n lá»±a sáº½ Ä‘Æ°á»£c tiáº¿n hÃ nh xin Ä‘á»“ng thuáº­n tham gia nghiÃªn cá»©u vÃ  thu tháº­p sá»‘ liá»‡u vÃ o ngÃ y khÃ¡m bá»‡nh káº¿ tiáº¿p gáº§n nháº¥t.

## CÃ¡c biáº¿n sá»‘ nghiÃªn cá»©u

```{r}
#| include: false
data <- data.frame(
  Ten_bien = c(
    "Tuá»•i", "Giá»›i tÃ­nh", "Tuá»•i khá»Ÿi phÃ¡t", "Thá»i gian phÃ¡t hiá»‡n bá»‡nh", 
    "TrÃ¬nh Ä‘á»™ há»c váº¥n", "Nghá» nghiá»‡p trÆ°á»›c Ä‘Ã¢y", "TÃ¬nh tráº¡ng hÃ´n nhÃ¢n", 
    "Tiá»n sá»­ gia Ä‘Ã¬nh", "Bá»‡nh Ä‘i kÃ¨m", "Thang MMSE", "Tiá»ƒu thang MMSE",
    "Word List", "Digit span forward", "Digit span backward",
    "TMT-A", "TMT-B", "Kháº£o sÃ¡t sá»± lÆ°u loÃ¡t ngÃ´n ngá»¯.",
    "Tráº¯c nghiá»‡m váº½ Ä‘á»“ng há»“", "Cháº©n Ä‘oÃ¡n", "Giai Ä‘oáº¡n"
  ),
  Loai_bien = c(
    "Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng", 
    "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", 
    "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", 
    "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh"
  ),
  Gia_tri_don_vi = c(
    "NÄƒm", "Nam/Ná»¯", "Khá»Ÿi phÃ¡t sá»›m/khá»Ÿi phÃ¡t muá»™n", "NÄƒm",
    "Cáº¥p 1, cáº¥p 2, cáº¥p 3, cao Ä‘áº³ng/Ä‘áº¡i há»c, khÃ´ng xÃ¡c Ä‘á»‹nh", 
    "ToÃ n thá»i gian, bÃ¡n thá»i gian, vá» hÆ°u", 
    "CÃ³ chá»“ng vá»£, gÃ³a, ly thÃ¢n/ly hÃ´n", "CÃ³ bá»‹ SSTT", "CÃ³, khÃ´ng", 
    "GiÃ¡ trá»‹ tá»« 0 - 30", "TÃ¹y thuá»™c chá»©c nÄƒng nháº­n thá»©c", 
    "GiÃ¡ trá»‹ tá»« 0 â€“ 30", "GiÃ¡ trá»‹ tá»« 0 â€“ 14", "GiÃ¡ trá»‹ tá»« 0 â€“ 12", 
    "Thá»i gian Ä‘áº¡t khi dÆ°á»›i 150 giÃ¢y", "Thá»i gian Ä‘áº¡t khi dÆ°á»›i 300 giÃ¢y", 
    "Sá»‘ lÆ°á»£ng cÃ¡c con váº­t ngÆ°á»i lÃ m tráº¯c nghiá»‡m ká»ƒ tÃªn", 
    "1 Ä‘áº¿n 6 Ä‘iá»ƒm theo thang Shulman", "SCI, MCI vÃ  SSTT", 
    "Giai Ä‘oáº¡n nháº¹, trung bÃ¬nh, náº·ng"
  )
)

```

```{r}
#| echo: false

ft <- data %>%
  flextable() %>%
  set_header_labels(
    Ten_bien = "TÃªn biáº¿n",
    Loai_bien = "Loáº¡i biáº¿n",
    Gia_tri_don_vi = "GiÃ¡ trá»‹ / ÄÆ¡n vá»‹"
  ) %>%
  autofit() %>%
  set_table_properties(width = 1, layout = "autofit") %>%
  font(fontname = "Times New Roman", part = "all")  %>%
  fontsize(size = 13, part = "all")

ft

```

### PhÆ°Æ¡ng phÃ¡p tiáº¿n hÃ nh.

Bá»‡nh nhÃ¢n tá»›i khÃ¡m táº¡i ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Æ°á»£c BÃ¡c sÄ© tháº§n kinh chá»‰ Ä‘á»‹nh lÃ m tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c bá»Ÿi cÃ¡c nhÃ¢n viÃªn Y táº¿ Ä‘Æ°á»£c huáº¥n luyá»‡n theo quy trÃ¬nh thá»±c hiá»‡n bá»™ test chuáº©n. - PhÆ°Æ¡ng phÃ¡p há»“i cá»©u. Tra cá»©u há»“ sÆ¡ bá»‡nh Ã¡n táº¥t cáº£ nhá»¯ng bá»‡nh nhÃ¢n Ä‘Æ°á»£c khÃ¡m táº¡i Ä‘Æ¡n vá»‹ tá»« 4/2019 tá»›i thá»i Ä‘iá»ƒm nghiÃªn cá»©u. ÄÃ¡nh giÃ¡ láº¡i bá»™ test náº¿u bá»‡nh nhÃ¢n tÃ¡i khÃ¡m trong thá»i gian nghiÃªn cá»©u. - PhÆ°Æ¡ng phÃ¡p tiáº¿n cá»©u. Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m trong thá»i gian nghiÃªn cá»©u Ä‘Æ°á»£c thÄƒm khÃ¡m, lÃ m test, cháº©n Ä‘oÃ¡n vÃ  Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ sa sÃºt trÃ­ tuá»‡ tÃªn lÃ¢m sÃ ng. NghiÃªn cá»©u Ä‘Ã¡nh giÃ¡ ÄÃ¡nh giÃ¡ má»‘i tÆ°Æ¡ng quan giá»¯a MSSE vÃ  cÃ¡c test khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c khÃ¡c, tá»· lá»‡ hoÃ n thÃ nh Test tháº§n kinh nháº­n thá»©c Ä‘á»‘i vá»›i suy giáº£m nháº­n thá»©c nháº¹ vÃ  Sa sÃºt trÃ­ tuá»‡. ÄÃ¡nh giÃ¡ má»‘i tÆ°Æ¡ng quan phÃ¢n Ä‘á»™ sa sÃºt trÃ­ tuá»‡ á»Ÿ thang Ä‘iá»ƒm MMSE vÃ  phÃ¢n Ä‘á»™ sa sÃºt trÃ­ tuá»‡ trÃªn lÃ¢m sÃ ng.

## PhÆ°Æ¡ng phÃ¡p vÃ  cÃ´ng cá»¥ Ä‘o lÆ°á»ng, thu tháº­p sá»‘ liá»‡u

-   Nháº­p liá»‡u vÃ  quáº£n lÃ½ dá»¯ liá»‡u báº±ng pháº§n má»m SPSS 20, xá»­ lÃ½ sá»‘ liá»‡u báº±ng pháº§n má»m R 4.2.3 (Packages sá»­ dá»¥ng trong nghiÃªn cá»©u: table1, dplyr, ggplot2, boot, simpleboot, afex.)
-   MÃ´ táº£ cÃ¡c biáº¿n Ä‘á»‹nh lÆ°á»£ng: báº±ng trung bÃ¬nh, Ä‘á»™ lá»‡ch chuáº©n, giÃ¡ trá»‹ nhá» nháº¥t, giÃ¡ trá»‹ lá»›n nháº¥t (phÃ¢n bá»‘ chuáº©n), hoáº·c trung vá»‹ vÃ  tá»© phÃ¢n vá»‹ (khÃ´ng phÃ¢n phá»‘i chuáº©n), sá»­ dá»¥ng bootstrap 10.000 lÆ°á»£t Ä‘á»ƒ tÃ­nh khoáº£ng tin cáº­y 95%.
-   MÃ´ táº£ cÃ¡c biáº¿n Ä‘á»‹nh tÃ­nh: báº±ng táº§n sá»‘ vÃ  tá»· lá»‡ pháº§n trÄƒm.
-   So sÃ¡nh giÃ¡ trá»‹ trung bÃ¬nh á»Ÿ cÃ¡c nhÃ³m dÃ¹ng kiá»ƒm Ä‘á»‹nh Independent Sample t-test..
-   So sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c tá»· lá»‡ vá»›i cÃ¡c biáº¿n Ä‘á»‹nh tÃ­nh dÃ¹ng kiá»ƒm Ä‘á»‹nh Chi bÃ¬nh phÆ°Æ¡ng (Ï‡2), hoáº·c kiá»ƒm Ä‘á»‹nh Fisher's Exact.
-   ÄÃ¡nh giÃ¡ má»‘i liÃªn quan cÃ¡c giá»¯a biáº¿n Ä‘á»‹nh lÆ°á»£ng: MMSE cÃ¡c tráº¯c nghiá»‡m khÃ¡c, sá»­ dá»¥ng há»‡ sá»‘ tÆ°Æ¡ng quan Pearson (phÃ¢n bá»‘ chuáº©n), hoáº·c sá»­ dá»¥ng há»‡ sá»‘ tÆ°Æ¡ng quan Spearman (khÃ´ng phÃ¢n phá»‘i chuáº©n). Há»‡ sá»‘ tÆ°Æ¡ng quan (r) Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ nhÆ° sau: â€¢ \|r\| â‰¥ 0, 7: TÆ°Æ¡ng quan cháº·t â€¢ \|r\| = 0, 5- 0,7: TÆ°Æ¡ng quan khÃ¡ cháº·t â€¢ \|r\| â‰¥ 0, 3 â€“ 0,5: TÆ°Æ¡ng quan vá»«a â€¢ \|r\| \< 0,3: TÆ°Æ¡ng quan yáº¿u â€¢ \|r\| =0 KhÃ´ng tÆ°Æ¡ng quan
-   ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ hoÃ n thÃ nh lÃ m Test tháº§n kinh nháº­n thá»©c báº±ng táº§n sá»‘ vÃ  tá»· lá»‡ pháº§n trÄƒm.
-   ÄÃ¡nh giÃ¡ má»‘i liÃªn quan cÃ¡c giá»¯a phÃ¢n loáº¡i bá»‡nh theo MMSE vÃ  phÃ¢n loáº¡i bá»‡nh trÃªn lÃ¢m sÃ ng dÃ¹ng kiá»ƒm Ä‘á»‹nh Chi bÃ¬nh phÆ°Æ¡ng (Ï‡2), hoáº·c kiá»ƒm Ä‘á»‹nh Fisher's Exact. Äáº¡o Ä‘á»©c nghiÃªn cá»©u
-   NghiÃªn cá»©u Ä‘Æ°á»£c thÃ´ng qua há»™i Ä‘á»“ng Äáº¡o Ä‘á»©c Ä‘á»‘i vá»›i nghiÃªn cá»©u Y sinh.
-   ÄÃ¢y lÃ  nghiÃªn cá»©u quan sÃ¡t, khÃ´ng can thiá»‡p vÃ o quÃ¡ trÃ¬nh Ä‘iá»u trá»‹ bá»‡nh nhÃ¢n, cÃ¡c hoáº¡t Ä‘á»™ng cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ hoÃ n toÃ n tuÃ¢n theo phÃ¡c Ä‘á»“ cá»§a Bá»‡nh viá»‡n.
-   Má»i thÃ´ng tin liÃªn quan Ä‘áº¿n bá»‡nh nhÃ¢n sáº½ Ä‘Æ°á»£c báº£o máº­t. TÃ¡c giáº£ nghiÃªn cá»©u tuÃ¢n thá»§ quy trÃ¬nh nghiÃªn cá»©u

### Äáº¡o Ä‘á»©c trong nghiÃªn cá»©u

# Káº¾T QUáº¢ NGHIÃŠN Cá»¨U

## Äáº·c Ä‘iá»ƒm máº«u cá»§a nghiÃªn cá»©u

### Tuá»•i

-   Báº£ng tuá»•i

```{r tbl-tuoi_ketqua-flextable, echo=FALSE, results='asis'}
ft_tuoi 
```

##### á» nghiÃªn cá»©u chÃºng tÃ´i tuá»•i trung bÃ¬nh cá»§a máº«u lÃ  **`r glue::glue("{mean_age} Â± {sd_age} tuá»•i")`**, trong Ä‘Ã³ tuá»•i nhÃ³m MCI lÃ  **`r glue("{mci$mean_age} Â± {mci$sd_age} tuá»•i")`**, Tuá»•i nhÃ³m Sa sÃºt trÃ­ tuá»‡ lÃ  **`r glue("{ssd$mean_age} Â± {ssd$sd_age} tuá»•i")`**.

-   Biá»ƒu Ä‘á»“ tuá»•i

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
tuoi_gp
```

##### á» nghiÃªn cá»©u chÃºng tÃ´i tuá»•i nhÃ³m MCI lÃ  **`r glue("{mci$mean_age} Â± {mci$sd_age} tuá»•i")`**, Tuá»•i nhÃ³m Sa sÃºt trÃ­ tuá»‡ lÃ  **`r glue("{ssd$mean_age} Â± {ssd$sd_age} tuá»•i")`**.

-   Biá»ƒu Ä‘á»“ tuá»•i

-   Báº£ng nhÃ³m tuá»•i

```{r tbl-nhom_tuoi_ketqua-flextable, echo=FALSE, results='asis'}
#| message: false
#| warning: false
#| paged-print: false
ft_freq_p
```

-   Biá»ƒu Ä‘á»“ nhÃ³m tuá»•i

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
nhom_tuoi_gp
```

### Giá»›i tÃ­nh

-   Báº£ng theo giá»›i tÃ­nh

```{r tbl-gioi_tinh_ketqua-flextable, echo=FALSE, results='asis'}
ft_gender
```

##### `r cau_gioitinh_mota`

-   Biá»ƒu Ä‘á»“ theo giá»›i tÃ­nh

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
gioitinh_bar_percent
```

##### `r cau_gioitinh_mota`

### TrÃ¬nh Ä‘á»™ há»c váº¥n

## ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng

Äáº·c Ä‘iá»ƒm hiá»‡u quáº£ á»©ng dá»¥ng \### Má»©c Ä‘á»™ hoÃ n thÃ nh

# BÃ€N LUáº¬N

## Äáº·c Ä‘iá»ƒm máº«u cá»§a nghiÃªn cá»©u

á» nghiÃªn cá»©u chÃºng tÃ´iTuá»•i trung bÃ¬nh cá»§a máº«u lÃ  **`r glue::glue("{mean_age} Â± {sd_age} tuá»•i")`**, trong Ä‘Ã³ tuá»•i nhÃ³m MCI lÃ  **`r glue("{mci$mean_age} Â± {mci$sd_age} tuá»•i")`**, Tuá»•i nhÃ³m Sa sÃºt trÃ­ tuá»‡ lÃ  **`r glue("{ssd$mean_age} Â± {ssd$sd_age} tuá»•i")`**.

Theo nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y ..... KhÃ¡c biá»‡t nÃ y cÃ³ thá»ƒ do khÃ¡c biá»‡t vá» thiáº¿t káº¿ nghiÃªn cá»©u, cá»¡ máº«u vÃ  tá»· lá»‡ cÃ¡c nhÃ³m tuá»•i trong dÃ¢n sá»‘ nghiÃªn cá»©u.

### Äiá»ƒm háº¡n cháº¿

### TÃ­nh má»›i

### tÃ­nh á»©ng dá»¥ng cá»§a Ä‘á» tÃ i

::: {custom-style="CAN GIUA DAM 14 ONE"}
Káº¾T LUáº¬N
:::

Má»¥c tiÃªu 1 Má»¥c tiÃªu 2

::: {custom-style="CAN GIUA DAM 14 ONE"}
TÃ€I LIá»†U THAM KHáº¢O
:::
