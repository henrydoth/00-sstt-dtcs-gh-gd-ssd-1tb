---
title: "Äá» tÃ i cÆ¡ sá»Ÿ"
subtitle: "SSTT"
author: "Äá»— thanh LiÃªm"
date: today
format:
    docx:
      toc: false
      number-sections: false
      fig-dpi: 300          # optional for PNG fallback
      dev: dml              # chÃ¨n ggplot dáº¡ng vector
      reference-doc: sstt_dtcs_quato_words_input.docx
      fig-align: center
      

#bibliography: sstt_reference.bib
bibliography: sstt_reference.bib

csl: ama-brackets.csl

lang: vi
language:
  labels:
    fig: HÃ¬nh
editor: source
---

```{r}
#| include: false
# thÆ° viá»‡n
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
  dplyr, tidyr, forcats, haven,
  ggplot2, lubridate, glue, flextable,
  officer, officedown, jpeg, png, grid,
  tidyverse, purrr, RColorBrewer, emo, janitor, effectsize, patchwork, scale, stringr
)
```

```{r thiáº¿t_láº­p_máº·c_Ä‘á»‹nh, include=FALSE}
# ğŸ“¦ Thiáº¿t láº­p máº·c Ä‘á»‹nh cho flextable
set_flextable_defaults(
  font.family = "Times New Roman",
  font.size = 11,
  align = "center",
  padding = 3,
  theme_fun = theme_booktabs,
  layout = "autofit",
  width = 1,
  decimal.mark = ",",     # âœ… Dáº¥u pháº©y kiá»ƒu Viá»‡t
  big.mark = ".",         # âœ… NgÄƒn cÃ¡ch hÃ ng nghÃ¬n
  na_str = "-"            # âœ… Hiá»ƒn thá»‹ NA lÃ  "-"
)

# ğŸ¨ Thiáº¿t láº­p theme ggplot2 toÃ n cá»¥c
theme_set(
  theme_minimal(base_family = "Times New Roman") +
    theme(
      text = element_text(family = "Times New Roman"),
      plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
      axis.title = element_text(size = 12),
      axis.text = element_text(size = 11),
      legend.text = element_text(size = 11),
      legend.title = element_text(size = 11),
      strip.text = element_text(size = 12)
    )
)

# ğŸ“Š Thiáº¿t láº­p chunk máº·c Ä‘á»‹nh cho biá»ƒu Ä‘á»“
knitr::opts_chunk$set(
  fig.align = "center",   # âœ… CÄƒn giá»¯a
  out.width = "100%",     # âœ… Fit chiá»u ngang Word
  fig.asp = 0.618
)

# ğŸ”§ CÃ¡c tÃ¹y chá»n R chung
options(OutDec = ",")     # âœ… Dáº¥u pháº©y cho sá»‘ tháº­p phÃ¢n

# ğŸ¨ Ghi Ä‘Ã¨ palette máº·c Ä‘á»‹nh
scale_color_discrete <- function(...) scale_color_brewer(palette = "Set1", ...)
scale_fill_discrete  <- function(...) scale_fill_brewer(palette = "Pastel2", ...)
```

```{r}
#| include: false
ft_vn <- function(df) {
  flextable(df) %>%
    colformat_num(decimal.mark = ",", big.mark = ".", na_str = "-") %>%
    autofit()
}

```

```{r}
#| label: to mÃ u canh cho vÄƒn báº£n
#| include: false
# HÃ m tÃ´ mÃ u xanh cho vÄƒn báº£n inline Word
text_blue <- function(text) {
  ftext(
    text,
    fp_text_lite(
      color = "blue",
      font.family = "Times New Roman"
    )
  )
}
```

```{r}
#| include: false

current_datetime <- now()

thu <- c("CHá»¦ NHáº¬T", "THá»¨ 2", "THá»¨ 3", "THá»¨ 4", "THá»¨ 5", "THá»¨ 6", "THá»¨ 7")[wday(current_datetime)]

# Giá» 12h cÃ³ AM/PM, sau Ä‘Ã³ dá»‹ch sang tiáº¿ng Viá»‡t
gio <- format(current_datetime, "%I:%M %p") %>%
  str_replace("AM", "sÃ¡ng") %>%
  str_replace("PM", "chiá»u")

ngay <- day(current_datetime)
thang <- month(current_datetime)
nam <- year(current_datetime)

formatted_datetime <- glue("{gio}, {thu}, NGÃ€Y {ngay} THÃNG {thang} NÄ‚M {nam}")

```

::: {custom-style="CAN GIUA DAM 14 ONE"}
Lá»œI NÃ“I Äáº¦U
:::

```{r}
#| include: false

# Danh sÃ¡ch lá»i cáº£m Æ¡n vÃ  mÃ u chá»¯
messages <- c(
  "Vá»£ vÃ  cÃ¡c con vÃ¬ Ä‘Ã£ cho tÃ´i tÃ¬nh yÃªu, Ã½ nghÄ©a cuá»™c Ä‘á»i",
  "Bá»‘ máº¹ vÃ¬ Ä‘Ã£ cho tÃ´i cuá»™c Ä‘á»i",
  "Tháº§y cÃ´ vÃ¬ Ä‘Ã£ cho tÃ´i kiáº¿n thá»©c",
  "Báº¡n bÃ¨ vÃ¬ Ä‘Ã£ háº¿t lÃ²ng giÃºp Ä‘á»¡, Ä‘á»™ng viÃªn",
  "Äá»“ng nghiá»‡p vÃ¬ Ä‘Ã£ há»£p tÃ¡c vÃ  giÃºp Ä‘á»¡"
)

colors <- c("red", "blue", "green", "orange", "purple")

# Chá»n ngáº«u nhiÃªn má»™t cÃ¢u + mÃ u
msg <- sample(messages, 1)
color <- sample(colors, 1)

# CÃ¢u cáº£m Æ¡n (font Segoe Print, size 16, mÃ u ngáº«u nhiÃªn)
ft_msg <- ftext(
  glue("TÃ´i xin chÃ¢n thÃ nh cáº£m Æ¡n {msg}."), 
  prop = fp_text(font.family = "Segoe Print", font.size = 16, color = color)
)

# TÃªn ngÆ°á»i kÃ½ (Segoe Print, size 16, khÃ´ng mÃ u)
ft_name <- ftext(
  "Äá»— Thanh LiÃªm", 
  prop = fp_text(font.family = "Segoe Print", font.size = 16)
)
```

`r ft_msg`

`r ft_name`

```{=openxml}
<w:p><w:r><w:br/></w:r></w:p>
```
```{r}
#| echo: false
#| fig-align: center
# fig-cap: HÃ¬nh áº£nh ngáº«u nhiÃªn
#| out-width: 4in


imgs <- list.files("images", pattern = "\\.(jpg|jpeg|png)$", full.names = TRUE)
img <- sample(imgs, 1)

ext <- tools::file_ext(img)

# Read and display image based on format
if (ext == "png") {
  img_data <- png::readPNG(img)
} else {
  img_data <- jpeg::readJPEG(img)
}

grid::grid.raster(img_data)
```

```{r}
#| echo: false


quotes <- c(
  "The best way to predict the future is to invent it. â€“ Alan Kay",
  "Life is what happens when you're busy making other plans. â€“ John Lennon",
  "Do not dwell in the past, do not dream of the future, concentrate the mind on the present moment. â€“ Buddha",
  "Success is not final, failure is not fatal: It is the courage to continue that counts. â€“ Winston Churchill",
  "In the middle of difficulty lies opportunity. â€“ Albert Einstein"
)

quote <- sample(quotes, 1)

# Print one line break before the table
cat("\n")

ft <- flextable(data.frame(Quote = quote))
ft <- set_table_properties(ft, width = .75, layout = "autofit")
ft <- italic(ft, j = "Quote")
ft <- align(ft, align = "center", part = "all")
ft <- border_remove(ft)
ft <- padding(ft, padding = 6)
ft <- fontsize(ft, size = 16, part = "all")
ft <- color(ft, color = "blue", part = "all")

ft

# Print one line break after the table
cat("\n")
```

TP Há»“ ChÃ­ Minh: `r formatted_datetime`

# MÃƒ Lá»†NH

## Táº£i dá»¯ liá»‡u vÃ  xá»­ lÃ½

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false


df_raw <- read_sav("sstt304_28_03_24.sav", encoding = "latin1")
write_csv(df_raw, "sstt304_clean.csv")
```

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false


df <-  read_csv("sstt304_clean.csv") 
df <- df %>%
    dplyr::filter(new.old.tests != 1, mmse.new <=29) %>%
    drop_na(mmse.new)

```

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false

df <- df %>%
  filter(
    !is.na(date.visit),
    !is.na(year.born),
    !is.na(mmse.new),
    !is.na(gender)
  ) %>%
  mutate(
    year.visit = year(date.visit),
    tuoi = year.visit - year.born,

    gender = case_when(
      gender == 1 ~ "Nam",
      gender == 2 ~ "Ná»¯",
      TRUE ~ NA_character_
    ),
    gender = factor(gender, levels = c("Nam", "Ná»¯")),

    edu = case_when(
      edu.level == 1 ~ "Tiá»ƒu há»c",
      edu.level %in% c(2, 3) ~ "Trung há»c",
      edu.level == 4 ~ "Äáº¡i há»c",
      TRUE ~ NA_character_
    ),
    edu = factor(edu, levels = c("Tiá»ƒu há»c", "Trung há»c", "Äáº¡i há»c")),

    diagno_lam_sang = case_when(
      diagno == 1 ~ "Suy giáº£m nháº­n thá»©c nháº¹",
      diagno == 2 ~ "Suy giáº£m nháº­n thá»©c chá»§ quan",
      diagno == 3 ~ "Alzheimer",
      diagno == 4 ~ "Sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u",
      diagno == 5 ~ "Sa sÃºt trÃ­ tuá»‡ thÃ¹y trÃ¡n thÃ¡i dÆ°Æ¡ng",
      diagno == 7 ~ "Sa sÃºt trÃ­ tuá»‡ há»—n há»£p",
      diagno == 8 ~ "Sa sÃºt trÃ­ tuá»‡ do Parkinson",
      diagno == 9 ~ "Sa sÃºt trÃ­ tuá»‡ khÃ¡c",
      TRUE ~ NA_character_
    )
  ) %>%
  filter(
    tuoi >= 40,
    diagno_lam_sang != "Suy giáº£m nháº­n thá»©c chá»§ quan"
  ) %>%
  mutate(
    nhom_tuoi = case_when(
      tuoi < 50 ~ "40â€“49",
      tuoi < 60 ~ "50â€“59",
      tuoi < 70 ~ "60â€“69",
      tuoi < 80 ~ "70â€“79",
      TRUE      ~ "80+"
    ),
    diagno_lam_sang = factor(diagno_lam_sang, levels = c(
      "Suy giáº£m nháº­n thá»©c nháº¹",
      "Alzheimer",
      "Sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u",
      "Sa sÃºt trÃ­ tuá»‡ há»—n há»£p",
      "Sa sÃºt trÃ­ tuá»‡ thÃ¹y trÃ¡n thÃ¡i dÆ°Æ¡ng",
      "Sa sÃºt trÃ­ tuá»‡ do Parkinson",
      "Sa sÃºt trÃ­ tuá»‡ khÃ¡c"
    )),

    phan_loan_roi_loan_nhan_thuc_tieu_chuan_vang = case_when(
      diagno_lam_sang == "Suy giáº£m nháº­n thá»©c nháº¹" ~ "MCI",
      !is.na(diagno) ~ "Sa sÃºt trÃ­ tuá»‡",
      TRUE ~ NA_character_
    ),
    phan_loan_roi_loan_nhan_thuc_tieu_chuan_vang = factor(
      phan_loan_roi_loan_nhan_thuc_tieu_chuan_vang,
      levels = c("MCI", "Sa sÃºt trÃ­ tuá»‡")
    ),

    chan_doan_giai_doan_lam_sang = case_when(
      stage == 1 ~ "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      stage == 2 ~ "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      stage == 3 ~ "Sa sÃºt trÃ­ tuá»‡ náº·ng",
      TRUE ~ NA_character_
    ),
    chan_doan_giai_doan_lam_sang = factor(
      chan_doan_giai_doan_lam_sang,
      levels = c("Sa sÃºt trÃ­ tuá»‡ nháº¹", "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh", "Sa sÃºt trÃ­ tuá»‡ náº·ng")
    ),

    phan_loan_roi_loan_nhan_thuc = case_when(
      mmse.new >= 26 & mmse.new <= 29 ~ "MCI",
      mmse.new < 26 ~ "Sa sÃºt trÃ­ tuá»‡",
      TRUE ~ NA_character_
    ),
    phan_loan_roi_loan_nhan_thuc = factor(
      phan_loan_roi_loan_nhan_thuc,
      levels = c("MCI", "Sa sÃºt trÃ­ tuá»‡")
    ),

    mmse_group = case_when(
      mmse.new >= 26 & mmse.new <= 29 ~ "Suy giáº£m nháº­n thá»©c nháº¹",
      mmse.new >= 21 & mmse.new <= 25 ~ "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      mmse.new >= 11 & mmse.new <= 20 ~ "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      mmse.new >= 0  & mmse.new <= 10 ~ "Sa sÃºt trÃ­ tuá»‡ náº·ng",
      TRUE ~ NA_character_
    ),
    mmse_group = factor(mmse_group, levels = c(
      "Suy giáº£m nháº­n thá»©c nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      "Sa sÃºt trÃ­ tuá»‡ náº·ng"
    )),
    mmse_group = fct_drop(mmse_group),

    lam_sang_group = case_when(
      !is.na(chan_doan_giai_doan_lam_sang) ~ as.character(chan_doan_giai_doan_lam_sang),
      diagno_lam_sang == "Suy giáº£m nháº­n thá»©c nháº¹" ~ "Suy giáº£m nháº­n thá»©c nháº¹",
      TRUE ~ NA_character_
    ),
    lam_sang_group = factor(lam_sang_group, levels = c(
      "Suy giáº£m nháº­n thá»©c nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      "Sa sÃºt trÃ­ tuá»‡ náº·ng"
    ))
  )
```

## Äáº·c Ä‘iá»ƒm máº«u nghiÃªn cá»©u

### Äáº·c Ä‘iá»ƒm theo tuá»•i

```{r}
# ğŸ“¦ LÃ m sáº¡ch dá»¯ liá»‡u vÃ  gÃ¡n nhÃ£n nhÃ³m
df_clean <- df %>%
  filter(!is.na(tuoi), !is.na(phan_loan_roi_loan_nhan_thuc)) %>%
  mutate(
    nhom_nhan_thuc = recode(phan_loan_roi_loan_nhan_thuc,
                            "MCI" = "Suy giáº£m nháº­n thá»©c nháº¹",
                            "Sa sÃºt trÃ­ tuá»‡" = "Sa sÃºt trÃ­ tuá»‡")
  )

# ğŸ“Š TÃ­nh thá»‘ng kÃª mÃ´ táº£ theo nhÃ³m
age_summary <- df_clean %>%
  group_by(nhom_nhan_thuc) %>%
  summarise(
    mean_age = mean(tuoi, na.rm = TRUE),
    sd_age   = sd(tuoi, na.rm = TRUE),
    .groups = "drop"
  )

# ğŸ” TÃ¡ch tá»«ng nhÃ³m
sgnt <- age_summary %>% filter(nhom_nhan_thuc == "Suy giáº£m nháº­n thá»©c nháº¹")
sstt <- age_summary %>% filter(nhom_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡")

# ğŸ“‹ Táº¡o báº£ng mÃ´ táº£ thá»‘ng kÃª
table_tuoi <- df_clean %>%
  group_by(nhom_nhan_thuc) %>%
  summarise(
    `Trung bÃ¬nh Â± SD` = sprintf("%.1f Â± %.1f", mean(tuoi, na.rm = TRUE), sd(tuoi, na.rm = TRUE)) %>% str_replace_all("\\.", ","),
    `Trung vá»‹ (Q1â€“Q3)` = sprintf("%.1f (%.1fâ€“%.1f)",
                                 median(tuoi, na.rm = TRUE),
                                 quantile(tuoi, 0.25, na.rm = TRUE),
                                 quantile(tuoi, 0.75, na.rm = TRUE)) %>% str_replace_all("\\.", ","),
    `Min â€“ Max` = sprintf("%d â€“ %d", min(tuoi, na.rm = TRUE), max(tuoi, na.rm = TRUE)),
    .groups = "drop"
  ) %>%
  pivot_longer(-nhom_nhan_thuc, names_to = "Chá»‰ sá»‘", values_to = "GiÃ¡ trá»‹") %>%
  pivot_wider(names_from = nhom_nhan_thuc, values_from = "GiÃ¡ trá»‹")

# ğŸ§ª Kiá»ƒm Ä‘á»‹nh t-test
p_val <- t.test(tuoi ~ nhom_nhan_thuc, data = df_clean)$p.value
p_val_fmt <- ifelse(p_val < 0.001, "â‰¤ 0,001", str_replace(sprintf("%.3f", p_val), "\\.", ","))  # âœ… ÄÃ£ sá»­a dáº¥u

# ğŸ–¼ï¸ Báº£ng flextable
final_table <- table_tuoi %>%
  mutate(`GiÃ¡ trá»‹ p` = if_else(`Chá»‰ sá»‘` == "Trung bÃ¬nh Â± SD", p_val_fmt, ""))

ft_tuoi <- flextable(final_table) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  set_caption("Báº£ng: So sÃ¡nh tuá»•i giá»¯a cÃ¡c nhÃ³m nháº­n thá»©c (Ä‘á»‹nh dáº¡ng tiáº¿ng Viá»‡t)") %>%
  set_table_properties(width = 1, layout = "autofit")

ft_tuoi

# ğŸ“ˆ Váº½ biá»ƒu Ä‘á»“ ggplot
tuoi_gp <- ggplot(df_clean, aes(x = nhom_nhan_thuc, y = tuoi, fill = nhom_nhan_thuc)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(aes(color = nhom_nhan_thuc), width = 0.2, size = 1.5, alpha = 0.5) +
  labs(x = NULL, y = "Tuá»•i") +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    legend.position = "none",
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11)
  )

tuoi_gp

# âœï¸ Inline: káº¿t quáº£ báº£ng
inline_bang_tuoi_ketqua <- glue(
  "Tuá»•i trung bÃ¬nh nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ lÃ  {scales::number(sgnt$mean_age, accuracy = 0.1, decimal.mark = ',')} Â± {scales::number(sgnt$sd_age, accuracy = 0.1, decimal.mark = ',')} tuá»•i; ",
  "nhÃ³m Sa sÃºt trÃ­ tuá»‡ lÃ  {scales::number(sstt$mean_age, accuracy = 0.1, decimal.mark = ',')} Â± {scales::number(sstt$sd_age, accuracy = 0.1, decimal.mark = ',')} tuá»•i. ",
  "Sá»± khÃ¡c biá»‡t cÃ³ Ã½ nghÄ©a thá»‘ng kÃª vá»›i p {p_val_fmt}."
)

# âœï¸ Inline: káº¿t quáº£ biá»ƒu Ä‘á»“
inline_bieudo_tuoi_ketqua <- "Biá»ƒu Ä‘á»“ há»™p cho tháº¥y sá»± khÃ¡c biá»‡t trong phÃ¢n bá»‘ tuá»•i giá»¯a hai nhÃ³m nháº­n thá»©c."

# ğŸ“Š TÃ­nh tuá»•i trung bÃ¬nh toÃ n máº«u
mean_age_all <- mean(df_clean$tuoi, na.rm = TRUE)

# âœï¸ Inline: bÃ n luáº­n tá»•ng há»£p cÃ³ tuá»•i toÃ n máº«u
inline_tuoi_banluan <- case_when(
  sgnt$mean_age < sstt$mean_age ~ glue(
    "Trong nghiÃªn cá»©u nÃ y, tuá»•i trung bÃ¬nh toÃ n máº«u nghiÃªn cá»©u lÃ  {scales::number(mean_age_all, accuracy = 0.1, decimal.mark = ',')} tuá»•i; ",
    "tuá»•i trung bÃ¬nh nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ lÃ  {scales::number(sgnt$mean_age, accuracy = 0.1, decimal.mark = ',')} tuá»•i, ",
    "nhÃ³m Sa sÃºt trÃ­ tuá»‡ lÃ  {scales::number(sstt$mean_age, accuracy = 0.1, decimal.mark = ',')} tuá»•i. ",
    "NhÃ³m Sa sÃºt trÃ­ tuá»‡ cÃ³ xu hÆ°á»›ng lá»›n tuá»•i hÆ¡n, cho tháº¥y tuá»•i cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n má»©c Ä‘á»™ suy giáº£m nháº­n thá»©c."
  ),
  sgnt$mean_age > sstt$mean_age ~ "Trong nghiÃªn cá»©u nÃ y, nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ cÃ³ xu hÆ°á»›ng lá»›n tuá»•i hÆ¡n, cho tháº¥y cÃ³ thá»ƒ tá»“n táº¡i cÃ¡c yáº¿u tá»‘ ngoÃ i tuá»•i áº£nh hÆ°á»Ÿng Ä‘áº¿n má»©c Ä‘á»™ nháº­n thá»©c.",
  TRUE ~ "Trong nghiÃªn cá»©u nÃ y, hai nhÃ³m cÃ³ Ä‘á»™ tuá»•i tÆ°Æ¡ng Ä‘Æ°Æ¡ng, gá»£i Ã½ ráº±ng tuá»•i khÃ´ng pháº£i lÃ  yáº¿u tá»‘ phÃ¢n biá»‡t rÃµ giá»¯a cÃ¡c má»©c Ä‘á»™ nháº­n thá»©c."
)
```

#### Báº£ng Ä‘áº·c Ä‘iá»ƒm tuá»•i

#### Biá»ƒu Ä‘á»“ theo tuá»•i

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false
tuoi_gp <- ggplot(df, aes(x = phan_loan_roi_loan_nhan_thuc, y = tuoi, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7) +
  geom_jitter(
    aes(color = phan_loan_roi_loan_nhan_thuc),
    width = 0.2, size = 1.5, alpha = 0.5
  ) +
  labs(
    x = NULL,  
    y = "Tuá»•i"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  scale_x_discrete(labels=c("MCI" = "Suy giáº£m nháº­n thá»©c nháº¹ ", "Sa sÃºt trÃ­ tuá»‡" = "Sa sÃºt trÃ­ tuá»‡"))+
  theme(
    legend.position = "none",
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11)
  )

```

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false
tuoi_gp
```

#### Báº£ng theo nhÃ³m tuá»•i

```{r}
# ğŸ”„ Chuáº©n hÃ³a biáº¿n vÃ  gÃ¡n nhÃ£n
levels_nhom_tuoi <- c("40â€“49", "50â€“59", "60â€“69", "70â€“79", "80+")
df <- df %>%
  mutate(
    nhom_tuoi = factor(nhom_tuoi, levels = levels_nhom_tuoi),
    chuan_doan_label = recode(phan_loan_roi_loan_nhan_thuc,
                              "MCI" = "Suy giáº£m nháº­n thá»©c nháº¹",
                              "Sa sÃºt trÃ­ tuá»‡" = "Sa sÃºt trÃ­ tuá»‡")
  )

# ğŸ“‹ Táº¡o báº£ng táº§n sá»‘ theo nhÃ³m tuá»•i (lÃ m hÃ ng) vÃ  cháº©n Ä‘oÃ¡n (lÃ m cá»™t)
table_freq <- df %>%
  count(nhom_tuoi, chuan_doan_label) %>%
  group_by(nhom_tuoi) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup() %>%
  mutate(`Táº§n sá»‘ (%)` = sprintf("%d (%.1f%%)", n, percent)) %>%
  select(`NhÃ³m tuá»•i` = nhom_tuoi, `Cháº©n Ä‘oÃ¡n` = chuan_doan_label, `Táº§n sá»‘ (%)`) %>%
  pivot_wider(
    names_from = `Cháº©n Ä‘oÃ¡n`,
    values_from = `Táº§n sá»‘ (%)`,
    values_fill = "-"
  )

# ğŸ” Kiá»ƒm Ä‘á»‹nh Chi-squared
chisq_data <- table(df$chuan_doan_label, df$nhom_tuoi)
p_val <- chisq.test(chisq_data)$p.value
formatted_p <- ifelse(p_val < 0.001, "â‰¤ 0,001", str_replace(sprintf("%.3f", p_val), "\\.", ","))

# â• ThÃªm p-value vÃ o báº£ng
table_freq$`GiÃ¡ trá»‹ p` <- c(formatted_p, rep("", nrow(table_freq) - 1))

# ğŸ“Š Báº£ng flextable
ft_freq_p <- flextable(table_freq) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  bold(i = which(
    table_freq$`GiÃ¡ trá»‹ p` != "" &
    table_freq$`GiÃ¡ trá»‹ p` != "-" &
    as.numeric(gsub("[â‰¤< ]", "", table_freq$`GiÃ¡ trá»‹ p`)) < 0.05
  ), j = "GiÃ¡ trá»‹ p", part = "body") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_table_properties(width = 1, layout = "autofit")

ft_freq_p

# âœï¸ Inline: báº£ng
inline_bang_nhom_tuoi_ketqua <- glue("Táº§n sá»‘ nhÃ³m tuá»•i theo cháº©n Ä‘oÃ¡n cÃ³ Ä‘á»™ lá»‡ch khÃ¡c nhau rÃµ rá»‡t, vá»›i p {formatted_p}.")

# ğŸ“ˆ Biá»ƒu Ä‘á»“ boxplot
nhom_tuoi_gp <- ggplot(df, aes(x = nhom_tuoi, y = tuoi, fill = chuan_doan_label)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.7, position = position_dodge(width = 0.75)) +
  labs(
    x = "NhÃ³m tuá»•i",
    y = "Tuá»•i",
    fill = "Cháº©n Ä‘oÃ¡n"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    text = element_text(family = "Times New Roman"),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11),
    legend.position = "top"
  )

nhom_tuoi_gp

# âœï¸ Inline: biá»ƒu Ä‘á»“
inline_bieudo_nhom_tuoi_ketqua <- "Biá»ƒu Ä‘á»“ boxplot cho tháº¥y xu hÆ°á»›ng tÄƒng tuá»•i Ä‘á»“ng thá»i vá»›i má»©c Ä‘á»™ nháº­n thá»©c giáº£m."

# âœï¸ Inline: bÃ n luáº­n
inline_nhom_tuoi_banluan <- "NhÃ³m Sa sÃºt trÃ­ tuá»‡ chiáº¿m tá»· lá»‡ cao nháº¥t trong nhÃ³m tuá»•i â‰¥ 80, trong khi nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ phá»• biáº¿n hÆ¡n trong nhÃ³m tuá»•i 60â€“69. Xu hÆ°á»›ng nÃ y gá»£i Ã½ má»‘i quan há»‡ táº¡m thá»i giá»¯a tuá»•i vÃ  má»©c Ä‘á»™ sa sÃºt nháº­n thá»©c."

```

### Äáº·c Ä‘iá»ƒm giá»›i tÃ­nh

```{r}
#| echo: true
#| message: false
#| warning: false
#| paged-print: false
# ğŸ” PhÃ¢n tÃ­ch giá»›i tÃ­nh theo nhÃ³m cháº©n Ä‘oÃ¡n

# ğŸ§® HÃ m phá»¥: TÃ­nh pháº§n trÄƒm ná»¯ theo nhÃ³m
lay_phan_tram_nu <- function(nhom) {
  df %>%
    filter(phan_loan_roi_loan_nhan_thuc == nhom, gender == "Ná»¯") %>%
    summarise(percent = n() / sum(df$phan_loan_roi_loan_nhan_thuc == nhom) * 100) %>%
    pull(percent) %>%
    round(1)
}

# ğŸ“Š TÃ³m táº¯t dá»¯ liá»‡u giá»›i tÃ­nh
gioitinh_summary <- df %>%
  mutate(chuan_doan_label = recode(phan_loan_roi_loan_nhan_thuc, "MCI" = "Suy giáº£m nháº­n thá»©c nháº¹")) %>%
  count(chuan_doan_label, gender) %>%
  group_by(chuan_doan_label) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup()

# ğŸ“‹ Báº£ng flextable
bang_gioitinh <- gioitinh_summary %>%
  mutate(`Táº§n sá»‘ (%)` = sprintf("%d (%.1f%%)", n, percent)) %>%
  select(`Cháº©n Ä‘oÃ¡n` = chuan_doan_label, `Giá»›i tÃ­nh` = gender, `Táº§n sá»‘ (%)`) %>%
  pivot_wider(names_from = `Giá»›i tÃ­nh`, values_from = `Táº§n sá»‘ (%)`, values_fill = "-")

# ğŸ§ª TÃ­nh p-value
p_val_gender <- chisq.test(table(df$phan_loan_roi_loan_nhan_thuc, df$gender))$p.value
formatted_p_gender <- ifelse(p_val_gender < 0.001, "â‰¤ 0,001", str_replace(sprintf("%.3f", p_val_gender), "\\.", ","))

bang_gioitinh$`GiÃ¡ trá»‹ p` <- c(formatted_p_gender, rep("", nrow(bang_gioitinh) - 1))

ft_gender <- flextable(bang_gioitinh) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  bold(i = which(
    bang_gioitinh$`GiÃ¡ trá»‹ p` != "" &
    bang_gioitinh$`GiÃ¡ trá»‹ p` != "-" &
    as.numeric(gsub("[<â‰¤ ]", "", bang_gioitinh$`GiÃ¡ trá»‹ p`)) < 0.05
  ), j = "GiÃ¡ trá»‹ p", part = "body") %>%
  set_caption("Báº£ng: PhÃ¢n bá»‘ giá»›i tÃ­nh theo nhÃ³m nháº­n thá»©c (tÃ´ Ä‘áº­m náº¿u p < 0.05)") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_table_properties(width = 1, layout = "autofit")

ft_gender

# ğŸ“‰ Biá»ƒu Ä‘á»“ giá»›i tÃ­nh
gioitinh_bar_percent <- ggplot(gioitinh_summary, aes(x = chuan_doan_label, y = n, fill = gender)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  geom_text(
    aes(label = sprintf("%.1f%%", percent)),
    position = position_dodge(width = 0.8),
    vjust = -0.3,
    size = 3.5,
    family = "Times New Roman"
  ) +
  labs(x = NULL, y = "Sá»‘ lÆ°á»£ng bá»‡nh nhÃ¢n", fill = "Giá»›i tÃ­nh") +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11)
  )

gioitinh_bar_percent



# âœï¸ Inline bÃ n luáº­n
gioitinh_mci <- lay_phan_tram_nu("MCI")
gioitinh_sstt <- lay_phan_tram_nu("Sa sÃºt trÃ­ tuá»‡")

inline_bang_gioitinh_ketqua <- glue(
  "á»Ÿ nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹, ná»¯ giá»›i chiáº¿m {gioitinh_mci}%, ",
  "trong khi nhÃ³m Sa sÃºt trÃ­ tuá»‡ chiáº¿m {gioitinh_sstt}%. ",
  "Sá»± khÃ¡c biá»‡t nÃ y ", ifelse(p_val_gender < 0.05, "cÃ³", "khÃ´ng cÃ³"),
  " Ã½ nghÄ©a thá»‘ng kÃª vá»›i p = {formatted_p_gender}."
)

# âœï¸ Inline káº¿t quáº£ biá»ƒu Ä‘á»“
inline_bieudo_gioitinh_ketqua <- "Biá»ƒu Ä‘á»“ cá»™t cho tháº¥y xu hÆ°á»›ng lá»‡ch giá»›i giá»¯a hai nhÃ³m cháº©n Ä‘oÃ¡n."


inline_bang_gioitinh_banluan <- glue(
  "Káº¿t quáº£ nghiÃªn cá»©u vá» giá»›i tÃ­nh cho tháº¥y: á»Ÿ nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹, ná»¯ giá»›i chiáº¿m {gioitinh_mci}%, ",
  "trong khi nhÃ³m Sa sÃºt trÃ­ tuá»‡ chiáº¿m {gioitinh_sstt}%. "
)


```

### Äáº·c Ä‘iá»ƒm trÃ¬nh Ä‘á»™ há»c váº¥n

```{r}
#| echo: true

# ğŸ“Š TÃ³m táº¯t dá»¯ liá»‡u há»c váº¥n ğŸ§ 
hocvan_summary <- df %>%
  filter(phan_loan_roi_loan_nhan_thuc %in% c("MCI", "Sa sÃºt trÃ­ tuá»‡")) %>%  # ğŸ’¡ chá»‰ láº¥y 2 nhÃ³m
  count(phan_loan_roi_loan_nhan_thuc, edu) %>%
  group_by(phan_loan_roi_loan_nhan_thuc) %>%
  mutate(percent = n / sum(n) * 100) %>%
  ungroup()

# ğŸ§® Táº¡o báº£ng trÃ¬nh Ä‘á»™ há»c váº¥n vá»›i 2 cá»™t MCI, SSTT
table_edu <- hocvan_summary %>%
  mutate(`Táº§n sá»‘ (%)` = sprintf("%d (%.1f%%)", n, percent) %>% str_replace_all("\\.", ",")) %>%
  select(`Cháº©n Ä‘oÃ¡n` = phan_loan_roi_loan_nhan_thuc, `TrÃ¬nh Ä‘á»™ há»c váº¥n` = edu, `Táº§n sá»‘ (%)`) %>%
  pivot_wider(names_from = `Cháº©n Ä‘oÃ¡n`, values_from = `Táº§n sá»‘ (%)`, values_fill = "-")

# ğŸ§ª TÃ­nh p-value
chisq_edu <- table(df$phan_loan_roi_loan_nhan_thuc, df$edu)
use_fisher <- any(chisq_edu < 5)
p_val_edu <- if (use_fisher) fisher.test(chisq_edu)$p.value else chisq.test(chisq_edu)$p.value
formatted_p_edu <- ifelse(p_val_edu < 0.001, "â‰¤ 0,001", str_replace(sprintf("%.3f", p_val_edu), "\\.", ","))

# â• ThÃªm dÃ²ng p-value
table_edu$`GiÃ¡ trá»‹ p` <- c(formatted_p_edu, rep("", nrow(table_edu) - 1))

# ğŸ“‹ Báº£ng flextable
ft_edu <- flextable(table_edu) %>%
  autofit() %>%
  align(align = "center", part = "all") %>%
  bold(i = 1, part = "header") %>%
  bold(i = which(
    table_edu$`GiÃ¡ trá»‹ p` != "" &
    table_edu$`GiÃ¡ trá»‹ p` != "-" &
    as.numeric(gsub("[â‰¤< ]", "", table_edu$`GiÃ¡ trá»‹ p`)) < 0.05
  ), j = "GiÃ¡ trá»‹ p", part = "body") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_table_properties(width = 1, layout = "autofit") %>%
  set_caption("Báº£ng: PhÃ¢n bá»‘ trÃ¬nh Ä‘á»™ há»c váº¥n theo nhÃ³m nháº­n thá»©c")

# ğŸ¨ Biá»ƒu Ä‘á»“ ggplot trÃ¬nh Ä‘á»™ há»c váº¥n
hocvan_bar_percent <- ggplot(hocvan_summary, aes(x = edu, y = percent, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_col(position = position_dodge(width = 0.8)) +
  geom_text(
    aes(label = str_replace(sprintf("%.1f%%", percent), "\\.", ",")),
    position = position_dodge(width = 0.8),
    vjust = -0.3,
    size = 3.5,
    family = "Times New Roman"
  ) +
  labs(
    x = "TrÃ¬nh Ä‘á»™ há»c váº¥n",
    y = "Tá»· lá»‡ (%)",
    fill = "NhÃ³m nháº­n thá»©c"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 11),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11),
    legend.position = "top"
  )

# âœï¸ Inline mÃ´ táº£ báº£ng
lay_tyle_hocvan <- function(nhom, bac) {
  ket_qua <- hocvan_summary %>%
    filter(phan_loan_roi_loan_nhan_thuc == nhom, edu == bac) %>%
    pull(percent)
  if (length(ket_qua) == 0) return(0) else return(round(ket_qua, 1))
}

hv_mci_daihoc <- lay_tyle_hocvan("MCI", "Äáº¡i há»c")
hv_sstt_daihoc <- lay_tyle_hocvan("Sa sÃºt trÃ­ tuá»‡", "Äáº¡i há»c")

# ğŸ§¾ Inline mÃ´ táº£ báº£ng
inline_table_hocvan <- glue(
  "Tá»· lá»‡ trÃ¬nh Ä‘á»™ Äáº¡i há»c cao nháº¥t ghi nháº­n á»Ÿ nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ ({hv_mci_daihoc}%) so vá»›i nhÃ³m Sa sÃºt trÃ­ tuá»‡ ({hv_sstt_daihoc}%). ",
  "GiÃ¡ trá»‹ p kiá»ƒm Ä‘á»‹nh sá»± khÃ¡c biá»‡t giá»¯a hai nhÃ³m lÃ  {formatted_p_edu}."
)

# âœï¸ Inline mÃ´ táº£ biá»ƒu Ä‘á»“ cÃ³ Ä‘iá»u kiá»‡n
inline_plot_hocvan <- ifelse(
  hv_mci_daihoc > hv_sstt_daihoc,
  glue("Biá»ƒu Ä‘á»“ cho tháº¥y nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ cÃ³ xu hÆ°á»›ng Ä‘áº¡t trÃ¬nh Ä‘á»™ há»c váº¥n cao hÆ¡n."),
  glue("Biá»ƒu Ä‘á»“ cho tháº¥y nhÃ³m Sa sÃºt trÃ­ tuá»‡ cÃ³ tá»· lá»‡ trÃ¬nh Ä‘á»™ há»c váº¥n cao hÆ¡n.")
)

# ğŸ’¬ Inline bÃ n luáº­n tá»•ng quan cÃ³ Ä‘iá»u kiá»‡n
inline_banluan_hocvan <- ifelse(
  hv_mci_daihoc > hv_sstt_daihoc,
  glue("Tá»•ng quan cho tháº¥y nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ cÃ³ trÃ¬nh Ä‘á»™ há»c váº¥n cao hÆ¡n."),
  glue("NhÃ³m Sa sÃºt trÃ­ tuá»‡ cÃ³ trÃ¬nh Ä‘á»™ há»c váº¥n cao hÆ¡n trong nghiÃªn cá»©u nÃ y.")
)
```

### PhÃ¢n tÃ­ch MMSE

```{r}
#| label: khá»‘i lá»‡nh MMSE
#| echo: true


# ğŸ§  Tá»•ng há»£p báº£ng MMSE
tab_mmse <- df %>%
  count(mmse_group, name = "n") %>%
  mutate(
    percent = round(100 * n / sum(n), 1),
    percent_vi = str_replace(format(percent, decimal.mark = ","), "\\.", ","),  # âœ… xá»­ lÃ½ dáº¥u , trÆ°á»›c
    `Sá»‘ lÆ°á»£ng (Tá»· lá»‡ %)` = glue("{n} ({percent_vi}%)"),
    nhan_day_du = case_when(
      mmse_group == "BÃ¬nh thÆ°á»ng" ~ "BÃ¬nh thÆ°á»ng",
      mmse_group == "Suy giáº£m nháº­n thá»©c nháº¹" ~ "Suy giáº£m nháº­n thá»©c nháº¹",
      mmse_group == "Sa sÃºt trÃ­ tuá»‡ nháº¹" ~ "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      mmse_group == "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" ~ "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      mmse_group == "Sa sÃºt trÃ­ tuá»‡ náº·ng" ~ "Sa sÃºt trÃ­ tuá»‡ náº·ng",
      TRUE ~ as.character(mmse_group)
    )
  )

# ğŸ“‹ Táº¡o báº£ng flextable
ft_mmse <- flextable(tab_mmse %>%
    select(`PhÃ¢n Ä‘á»™ MMSE` = nhan_day_du, `Sá»‘ lÆ°á»£ng (Tá»· lá»‡ %)`)) %>%
  colformat_num(decimal.mark = ",", big.mark = ".") %>%
  set_table_properties(width = 1, layout = "autofit") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_caption("Báº£ng: Táº§n suáº¥t vÃ  tá»· lá»‡ phÃ¢n Ä‘á»™ MMSE") %>%
  autofit()

# ğŸ“Šâœ¨ Biá»ƒu Ä‘á»“ cá»™t MMSE theo thá»© tá»± tá»« nháº¹ Ä‘áº¿n náº·ng vá»›i nhÃ£n khÃ´ng bá»‹ máº¥t
ggplot_mmse <- tab_mmse %>%
  mutate(nhan_day_du = factor(
    nhan_day_du,
    levels = c(
      "Suy giáº£m nháº­n thá»©c nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ nháº¹",
      "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh",
      "Sa sÃºt trÃ­ tuá»‡ náº·ng"
    )
  )) %>%
  ggplot(aes(x = nhan_day_du, y = n, fill = nhan_day_du)) +
  geom_col(width = 0.6) +
  geom_text(
    aes(label = `Sá»‘ lÆ°á»£ng (Tá»· lá»‡ %)`),
    vjust = -0.5,
    size = 3.5,
    family = "Times New Roman"
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +  # âœ… táº¡o khoáº£ng trá»‘ng phÃ­a trÃªn
  scale_fill_brewer(palette = "Pastel1") +
  labs(y = "Sá»‘ lÆ°á»£ng") +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    axis.text.x = element_text(angle = 30, hjust = 1),
    axis.title.x = element_blank(), 
    axis.text = element_text(size = 11),
    legend.position = "none"
  )

# âœï¸ Inline mÃ´ táº£ báº£ng
mmse_top <- tab_mmse %>% slice_max(order_by = n, n = 1)
inline_bang_mmse <- glue(
  "Báº£ng cho tháº¥y phÃ¢n Ä‘á»™ MMSE phá»• biáº¿n nháº¥t lÃ  **{mmse_top$nhan_day_du}**, ",
  "chiáº¿m tá»· lá»‡ {format(mmse_top$percent, decimal.mark = ',')}%."
)

# ğŸ“ˆ Inline mÃ´ táº£ biá»ƒu Ä‘á»“
tab_mmse_xu <- tab_mmse %>%
  mutate(nhom = case_when(
    str_detect(mmse_group, "Suy giáº£m") ~ "Suy giáº£m nháº­n thá»©c nháº¹",
    str_detect(mmse_group, "Sa sÃºt") ~ "Sa sÃºt trÃ­ tuá»‡",
    mmse_group == "BÃ¬nh thÆ°á»ng" ~ "BÃ¬nh thÆ°á»ng"
  )) %>%
  group_by(nhom) %>%
  summarise(tong = sum(n), .groups = "drop")

top_xu <- tab_mmse_xu %>% slice_max(order_by = tong, n = 1)
nhom_dich <- top_xu$nhom
inline_bieudo_mmse <- glue(
  "Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n xu hÆ°á»›ng táº­p trung vÃ o nhÃ³m **{nhom_dich}**."
)

# ğŸ§  Inline bÃ n luáº­n ngáº¯n gá»n
top2 <- tab_mmse %>% arrange(desc(n)) %>% slice_head(n = 2)
inline_mmse_banluan <- text_blue(ifelse(
  top2$nhan_day_du[1] != top2$nhan_day_du[2],
  glue("Hai phÃ¢n Ä‘á»™ phá»• biáº¿n nháº¥t lÃ  {top2$nhan_day_du[1]} (chiáº¿m {top2$percent[1]}%) vÃ  {top2$nhan_day_du[2]} (chiáº¿m {top2$percent[2]}%)."),
  glue("PhÃ¢n Ä‘á»™ phá»• biáº¿n nháº¥t lÃ  **{top2$nhan_day_du[1]}**, chiáº¿m {top2$percent[1]}%")
))

# ğŸ”¢ TÃ­nh pháº§n trÄƒm ngÆ°á»i thuá»™c nhÃ³m MCI (MMSE 26â€“29)
percent_mci <- tab_mmse %>%
  filter(mmse_group == "Suy giáº£m nháº­n thá»©c nháº¹") %>%
  summarise(p = sum(n) / sum(tab_mmse$n)) %>%
  pull(p)

# ğŸ“˜ Inline mÃ´ táº£ vá»›i text_blue() vÃ  pháº§n trÄƒm kiá»ƒu Viá»‡t (dáº¥u pháº©y)
inline_mci_mota_phantram_banluan <- text_blue(glue(
  "Trong nghiÃªn cá»©u nÃ y, cÃ³ {scales::percent(percent_mci, accuracy = 0.1, decimal.mark = ',')} ngÆ°á»i tham gia Ä‘Æ°á»£c phÃ¢n vÃ o nhÃ³m MCI (MMSE 26â€“29)."
))
# ğŸ§  Inline bÃ n luáº­n ngáº¯n gá»n ve tá»‰ lá»‡ cÃ¡c nhÃ³n 
# ğŸ§  TÃ­nh tá»· lá»‡ nhÃ³m "Sa sÃºt trÃ­ tuá»‡ náº·ng"
prop_nang <- df %>%
  summarise(ti_le = mean(mmse_group == "Sa sÃºt trÃ­ tuá»‡ náº·ng") * 100) %>%
  pull(ti_le)

# ğŸ“Œ Táº¡o chuá»—i mÃ´ táº£ inline vá»›i Ä‘á»‹nh dáº¡ng pháº§n trÄƒm kiá»ƒu Viá»‡t Nam
ti_le_sstt_nang_theo_mmse <- text_blue(glue(
  "tá»· lá»‡ nhÃ³m Sa sÃºt trÃ­ tuá»‡ náº·ng lÃ  {scales::number(prop_nang, accuracy = 0.1, decimal.mark = ',')}%"
))
```

### Äáº·c Ä‘iá»ƒm cÃ¡c test nháº­n thá»©c

```{r}
# ğŸ§  Biáº¿n tháº§n kinh nháº­n thá»©c vÃ  nhÃ£n
tests_nhanthuc <- c(
  "Im.recall1", "de.recall1", "de.reg1",
  "TMT.A.time", "TMT.B.time",
  "DS.forward1", "DS.backrward1",
  "animal.test1", "clock.drawing1"
)

label_nhanthuc <- c(
  "Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
  "Ná»‘i sá»‘", "Ná»‘i sá»‘-chá»¯",
  "Äá»c sá»‘ xuÃ´i", "Äá»c sá»‘ ngÆ°á»£c",
  "LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)
names(label_nhanthuc) <- tests_nhanthuc

# ğŸ“‹ Tá»•ng há»£p báº£ng mÃ´ táº£ + kiá»ƒm Ä‘á»‹nh
table_nhanthuc_group <- purrr::map_dfr(tests_nhanthuc, function(var) {
  df_sub <- df %>%
    select(phan_loan_roi_loan_nhan_thuc, !!sym(var)) %>%
    filter(!is.na(phan_loan_roi_loan_nhan_thuc), !is.na(!!sym(var)))

  # Kiá»ƒm Ä‘á»‹nh
  formatted_p <- "-"
  if (n_distinct(df_sub$phan_loan_roi_loan_nhan_thuc) >= 2) {
    group_vals <- split(df_sub[[var]], df_sub$phan_loan_roi_loan_nhan_thuc)
    if (length(group_vals[[1]]) >= 3 && length(group_vals[[2]]) >= 3) {
      shapiro1 <- shapiro.test(group_vals[[1]])$p.value
      shapiro2 <- shapiro.test(group_vals[[2]])$p.value
      p_val <- tryCatch({
        if (shapiro1 > 0.05 && shapiro2 > 0.05) {
          t.test(!!sym(var) ~ phan_loan_roi_loan_nhan_thuc, data = df_sub)$p.value
        } else {
          wilcox.test(!!sym(var) ~ phan_loan_roi_loan_nhan_thuc, data = df_sub)$p.value
        }
      }, error = function(e) NA_real_)
      formatted_p <- ifelse(
        is.na(p_val), "-",
        ifelse(p_val < 0.001, "< 0,001", formatC(p_val, digits = 3, format = "f") |> str_replace_all("\\.", ","))
      )
    }
  }

  # TÃ³m táº¯t mÃ´ táº£
  df_stats <- df_sub %>%
    group_by(phan_loan_roi_loan_nhan_thuc) %>%
    summarise(
      `Trung bÃ¬nh Â± SD` = sprintf("%.1f Â± %.1f", mean(!!sym(var)), sd(!!sym(var))),
      `Trung vá»‹ (Q1â€“Q3)` = sprintf("%.1f (%.1fâ€“%.1f)",
                                   median(!!sym(var)),
                                   quantile(!!sym(var), 0.25),
                                   quantile(!!sym(var), 0.75)),
      `Min â€“ Max` = sprintf("%.1f â€“ %.1f", min(!!sym(var)), max(!!sym(var))),
      N = as.character(n()),
      .groups = "drop"
    ) %>%
    pivot_longer(-phan_loan_roi_loan_nhan_thuc, names_to = "Chá»‰ sá»‘", values_to = "GiÃ¡ trá»‹") %>%
    pivot_wider(names_from = phan_loan_roi_loan_nhan_thuc, values_from = "GiÃ¡ trá»‹") %>%
    mutate(
      `Test tháº§n kinh` = label_nhanthuc[[var]],
      `GiÃ¡ trá»‹ p` = if_else(`Chá»‰ sá»‘` == "Trung bÃ¬nh Â± SD", formatted_p, "")
    ) %>%
    select(`Test tháº§n kinh`, everything())

  return(df_stats)
}) %>%
  mutate(across(-`Test tháº§n kinh`, ~str_replace_all(.x, "\\.", ",")))  # ğŸ‡»ğŸ‡³ dáº¥u pháº©y Viá»‡t

# ğŸ“‹ Báº£ng flextable
ft_nhanthuc_group <- flextable(table_nhanthuc_group %>% select(-`GiÃ¡ trá»‹ p`))  %>%
  align(align = "center", part = "all") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  bold(i = 1, part = "header") %>%
  set_caption("Báº£ng: MÃ´ táº£ vÃ  kiá»ƒm Ä‘á»‹nh cÃ¡c test tháº§n kinh nháº­n thá»©c theo nhÃ³m nháº­n thá»©c") %>%
  autofit()
# ğŸ’¬ Inline mÃ´ táº£ báº£ng
# ğŸ“Š Biá»ƒu Ä‘á»“ density
df_long_nhanthuc <- df %>%
  select(phan_loan_roi_loan_nhan_thuc, all_of(tests_nhanthuc)) %>%
  pivot_longer(cols = -phan_loan_roi_loan_nhan_thuc, names_to = "test", values_to = "giatri") %>%
  mutate(test_label = fct_recode(factor(test), !!!label_nhanthuc))

plot_nhanthuc_group <- ggplot(df_long_nhanthuc, aes(x = giatri, fill = phan_loan_roi_loan_nhan_thuc)) +
  geom_density(alpha = 0.5) +
  facet_wrap(~test_label, scales = "free", ncol = 3) +
  labs(
    x = "GiÃ¡ trá»‹", y = "Máº­t Ä‘á»™",
    fill = "NhÃ³m nháº­n thá»©c",
    title = "Biá»ƒu Ä‘á»“ máº­t Ä‘á»™ cÃ¡c test tháº§n kinh theo nhÃ³m nháº­n thá»©c"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    strip.text = element_text(size = 11),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 11),
    plot.title = element_text(face = "bold", hjust = 0.5),
    legend.position = "bottom"
  )

# ğŸ’¬ Inline mÃ´ táº£ báº£ng
inline_bang_tests_group <- glue(
  "Báº£ng trÃªn  cho tháº¥y nhiá»u test cÃ³ sá»± khÃ¡c biá»‡t rÃµ rá»‡t giá»¯a nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ vÃ  'Sa sÃºt trÃ­ tuá»‡', ",
  "vá»›i giÃ¡ trá»‹ p < 0,05 Ä‘Æ°á»£c ghi nháº­n á»Ÿ cÃ¡c test"
)

# ğŸ’¬ Inline mÃ´ táº£ biá»ƒu Ä‘á»“
inline_bieudo_tests_group <- glue(
  "Biá»ƒu Ä‘á»“ máº­t Ä‘á»™ cho tháº¥y sá»± phÃ¢n tÃ¡ch giá»¯a hai nhÃ³m rÃµ nháº¥t á»Ÿ cÃ¡c test nhÆ° 'Äá»c sá»‘ ngÆ°á»£c', 'Ná»‘i sá»‘-chá»¯' vÃ  'Váº½ Ä‘á»“ng há»“', ",
  "gá»£i Ã½ Ä‘Ã¢y lÃ  cÃ¡c cÃ´ng cá»¥ nháº¡y trong phÃ¢n biá»‡t má»©c Ä‘á»™ suy giáº£m nháº­n thá»©c."
)

# ğŸ’¬ Inline bÃ¬nh luáº­n tá»•ng quan
inline_banluan_tests_group <- glue(
  "Káº¿t quáº£ kiá»ƒm Ä‘á»‹nh vÃ  biá»ƒu Ä‘á»“ Ä‘á»u cho tháº¥y xu hÆ°á»›ng rÃµ rÃ ng: nhÃ³m 'Sa sÃºt trÃ­ tuá»‡' cÃ³ hiá»‡u suáº¥t tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ trÃªn cÃ¡c test tháº§n kinh nháº­n thá»©c. ",
  "Äiá»u nÃ y cá»§ng cá»‘ vai trÃ² phÃ¢n biá»‡t cá»§a cÃ¡c cÃ´ng cá»¥ Ä‘Ã¡nh giÃ¡ nháº­n thá»©c ngáº¯n gá»n trong táº§m soÃ¡t suy giáº£m."
)
# ğŸ’¬ Inline bÃ n luáº­n tá»•ng quan
inline_banluan_tests <- glue(
  "NhÃ¬n chung, cÃ¡c test nhÆ° 'Äá»c sá»‘ ngÆ°á»£c', 'Ná»‘i sá»‘-chá»¯' cÃ³ nhiá»u giÃ¡ trá»‹ tháº¥p, pháº£n Ã¡nh má»©c suy giáº£m nháº­n thá»©c á»Ÿ bá»‡nh nhÃ¢n"
)

```

## PhÃ¢n tÃ­ch tÆ°Æ¡ng quan mmse theo nhÃ³m cháº©n Ä‘oÃ¡n

### TÃ­nh tÆ°Æ¡ng quan theo nhÃ³m (MCI vÃ  sa sÃºt trÃ­ tuá»‡)

```{r}
# HÃ m Ä‘á»‹nh dáº¡ng sá»‘ kiá»ƒu Viá»‡t
format_vn <- function(x) {
  format(round(as.numeric(x), 2), decimal.mark = ",", nsmall = 2)
}

# Danh sÃ¡ch test vÃ  nhÃ£n tiáº¿ng Viá»‡t
cor_vars <- c(
  "Im.recall1", "de.recall1", "de.reg1",
  "TMT.A.time", "TMT.B.time",
  "DS.forward1", "DS.backrward1",
  "animal.test1", "clock.drawing1"
)
cor_labels <- c(
  "Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
  "Ná»‘i sá»‘ (TMT-A)", "Ná»‘i sá»‘ - chá»¯ (TMT-B)",
  "Äá»c sá»‘ xuÃ´i", "Äá»c sá»‘ ngÆ°á»£c",
  "LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)
names(cor_labels) <- cor_vars

# TÃ­nh tÆ°Æ¡ng quan
cor_table <- purrr::map_dfr(cor_vars, function(var) {
  df_sub <- df %>% select(mmse.new, !!sym(var)) %>% drop_na()

  test <- tryCatch(
    cor.test(df_sub$mmse.new, df_sub[[var]], method = "spearman"),
    error = function(e) NULL
  )

  if (!is.null(test)) {
    r_val <- round(test$estimate, 2)
    abs_r <- abs(r_val)
    muc_do <- case_when(
      abs_r >= 0.7 ~ "Cháº·t",
      abs_r >= 0.5 ~ "KhÃ¡",
      abs_r >= 0.3 ~ "Vá»«a",
      TRUE         ~ "Yáº¿u"
    )

    data.frame(
      Test.tháº§n.kinh = cor_labels[[var]],
      Há»‡.sá»‘.tÆ°Æ¡ng.quan..r. = r_val,
      GiÃ¡.trá»‹.p = ifelse(test$p.value < 0.001, "< 0.001", sprintf("%.3f", test$p.value)),
      Má»©c.Ä‘á»™.tÆ°Æ¡ng.quan = muc_do
    )
  }
})
# Äá»‹nh dáº¡ng sá»‘ kiá»ƒu Viá»‡t
format_vn <- function(x) {
  format(round(as.numeric(x), 2), decimal.mark = ",", nsmall = 2)
}

# TÃ­nh tÆ°Æ¡ng quan Spearman cho tá»«ng nhÃ³m
cor_by_group <- purrr::map_dfr(
  .x = c("MCI", "Sa sÃºt trÃ­ tuá»‡"),
  .f = function(gr) {
    purrr::map_dfr(cor_vars, function(var) {
      df_sub <- df %>%
        filter(phan_loan_roi_loan_nhan_thuc == gr) %>%
        select(mmse.new, !!sym(var)) %>% drop_na()

      test <- tryCatch(
        cor.test(df_sub$mmse.new, df_sub[[var]], method = "spearman"),
        error = function(e) NULL
      )

      if (!is.null(test)) {
        r_val <- round(test$estimate, 2)
        abs_r <- abs(r_val)
        muc_do <- case_when(
          abs_r >= 0.7 ~ "Cháº·t",
          abs_r >= 0.5 ~ "KhÃ¡",
          abs_r >= 0.3 ~ "Vá»«a",
          TRUE         ~ "Yáº¿u"
        )

        data.frame(
          NhÃ³m = gr,
          Test.tháº§n.kinh = cor_labels[[var]],
          Há»‡.sá»‘.tÆ°Æ¡ng.quan.r = r_val,
          GiÃ¡.trá»‹.p = ifelse(test$p.value < 0.001, "< 0.001", sprintf("%.3f", test$p.value)),
          Má»©c.Ä‘á»™.tÆ°Æ¡ng.quan = muc_do
        )
      }
    })
  }
)

mota_theo_nhom <- function(nhom, muc) {
  data <- cor_by_group %>%
    filter(NhÃ³m == nhom, Má»©c.Ä‘á»™.tÆ°Æ¡ng.quan == muc)

  if (nrow(data) == 0) return(NULL)

  data <- data %>%
    mutate(
      r_txt = format(round(Há»‡.sá»‘.tÆ°Æ¡ng.quan.r, 2), decimal.mark = ","),
      p_txt = ifelse(
        GiÃ¡.trá»‹.p == "< 0.001", "< 0,001",
        format(round(as.numeric(gsub("< ", "", GiÃ¡.trá»‹.p)), 3), decimal.mark = ",")
      ),
      test_format = ifelse(
        as.numeric(gsub("< ", "", GiÃ¡.trá»‹.p)) < 0.05,
        glue("**{Test.tháº§n.kinh}** (r = {r_txt}, p = {p_txt})"),
        glue("{Test.tháº§n.kinh} (r = {r_txt}, p = {p_txt})")
      )
    )

  glue("{nrow(data)} test cá»§a nhÃ³m **{nhom}** cÃ³ tÆ°Æ¡ng quan {tolower(muc)} vá»›i MMSE: {glue_collapse(data$test_format, sep = '; ', last = ' vÃ  ')}.")
}
```

### Báº£ng flextable tÆ°Æ¡ng quan theo nhÃ³m

```{r}
ft_corr_grouped <- if (nrow(cor_by_group) > 0) {
  ft_corr_grouped <- flextable(cor_by_group) %>%
  colformat_num(j = "Há»‡.sá»‘.tÆ°Æ¡ng.quan.r", decimal.mark = ",", big.mark = ".") %>%
  autofit() %>%
  bold(i = 1, part = "header") %>%
  set_header_labels(
    NhÃ³m = "PhÃ¢n nhÃ³m",
    Test.tháº§n.kinh = "Test tháº§n kinh nháº­n thá»©c",
    Há»‡.sá»‘.tÆ°Æ¡ng.quan.r = "Há»‡ sá»‘ tÆ°Æ¡ng quan r",
    GiÃ¡.trá»‹.p = "GiÃ¡ trá»‹ p",
    Má»©c.Ä‘á»™.tÆ°Æ¡ng.quan = "Má»©c Ä‘á»™ tÆ°Æ¡ng quan"
  ) %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
    set_caption("Báº£ng: TÆ°Æ¡ng quan giá»¯a MMSE vÃ  cÃ¡c test nháº­n thá»©c theo tá»«ng nhÃ³m cháº©n Ä‘oÃ¡n") %>%
  set_table_properties(width = 1, layout = "autofit")
  ft_corr_grouped
} else {
  'KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ hiá»ƒn thá»‹ báº£ng tÆ°Æ¡ng quan theo nhÃ³m.'
} %>%
  set_table_properties(width = 1, layout = "autofit")

ft_corr_grouped

# Chuáº©n bá»‹ báº£ng long-format
cor_long <- cor_by_group %>%
  mutate(
    info = ifelse(
      GiÃ¡.trá»‹.p == "< 0.001",
      glue("{format_vn(Há»‡.sá»‘.tÆ°Æ¡ng.quan.r)} (p < 0,001)"),
      glue("{format_vn(Há»‡.sá»‘.tÆ°Æ¡ng.quan.r)} (p = {format_vn(as.numeric(GiÃ¡.trá»‹.p))})")
    )
  ) %>%
  select(NhÃ³m, Test.tháº§n.kinh, info) %>%
  pivot_wider(names_from = NhÃ³m, values_from = info)

# Táº¡o báº£ng flextable dáº¡ng wide
ft_corr_long <- flextable(cor_long) %>%
  set_header_labels(
    Test.tháº§n.kinh = "Test tháº§n kinh nháº­n thá»©c",
    `MCI` = "MCI (r, p)",
    `Sa sÃºt trÃ­ tuá»‡` = "Sa sÃºt trÃ­ tuá»‡ (r, p)"
  ) %>%
  autofit() %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  set_caption("Báº£ng: TÆ°Æ¡ng quan giá»¯a MMSE vÃ  cÃ¡c test nháº­n thá»©c theo nhÃ³m cháº©n Ä‘oÃ¡n (dáº¡ng long)") %>%
  set_table_properties(width = 1, layout = "autofit")
```

### Biá»ƒu Ä‘á»“ ggplot theo nhÃ³m

```{r}
df_plot_grouped <- cor_by_group %>%
  mutate(
    test_than_kinh = factor(Test.tháº§n.kinh, levels = rev(unique(Test.tháº§n.kinh))),
    co_y_nghia = ifelse(as.numeric(gsub("< ", "", GiÃ¡.trá»‹.p)) < 0.05, "CÃ³ Ã½ nghÄ©a", "KhÃ´ng Ã½ nghÄ©a")
  )

plot_corr_grouped <- ggplot(df_plot_grouped, aes(x = test_than_kinh, y = Há»‡.sá»‘.tÆ°Æ¡ng.quan.r, fill = co_y_nghia)) +
  geom_col(width = 0.6) +
  geom_text(
    aes(label = format_vn(Há»‡.sá»‘.tÆ°Æ¡ng.quan.r)),
    hjust = ifelse(df_plot_grouped$Há»‡.sá»‘.tÆ°Æ¡ng.quan.r >= 0, -0.1, 1.1),
    color = "black", size = 3.5, family = "Times New Roman"
  ) +
  facet_wrap(~NhÃ³m) +
  coord_flip(clip = "off") +
  scale_fill_brewer(palette = "Pastel1") +
  expand_limits(y = c(-1.05, 1.05)) +
  labs(
    title = "TÆ°Æ¡ng quan giá»¯a MMSE vÃ  cÃ¡c test nháº­n thá»©c theo tá»«ng nhÃ³m",
    x = NULL, y = "Há»‡ sá»‘ tÆ°Æ¡ng quan (r)",
    fill = "Ã nghÄ©a thá»‘ng kÃª"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    axis.text = element_text(size = 11),
    legend.position = "top"
  )

plot_corr_grouped
ft_corr_long
```

### Nháº­n xÃ©t riÃªng cho báº£ng vÃ  biá»ƒu Ä‘á»“

-   HÃ m táº¡o cÃ¢u nháº­n xÃ©t theo nhÃ³m vÃ  má»©c Ä‘á»™

```{r}
ota_theo_nhom <- function(nhom, muc) {
  data <- cor_by_group %>%
    filter(NhÃ³m == nhom, Má»©c.Ä‘á»™.tÆ°Æ¡ng.quan == muc)

  if (nrow(data) == 0) return(NULL)

  data <- data %>%
    mutate(
      r_txt = format_vn(Há»‡.sá»‘.tÆ°Æ¡ng.quan.r),
      p_txt = ifelse(
        GiÃ¡.trá»‹.p == "< 0.001", "< 0,001",
        format_vn(as.numeric(gsub("< ", "", GiÃ¡.trá»‹.p)))
      ),
      test_format = ifelse(
        as.numeric(gsub("< ", "", GiÃ¡.trá»‹.p)) < 0.05,
        glue("**{Test.tháº§n.kinh}** (r = {r_txt}, p = {p_txt})"),
        glue("{Test.tháº§n.kinh} (r = {r_txt}, p = {p_txt})")
      )
    )

  glue("{nrow(data)} test cá»§a nhÃ³m **{nhom}** cÃ³ tÆ°Æ¡ng quan {tolower(muc)} vá»›i MMSE: {glue_collapse(data$test_format, sep = '; ', last = ' vÃ  ')}.")
}
```

### Nháº­n xÃ©t riÃªng cho báº£ng flextable

```{r}
cau_bang_mci <- glue_collapse(purrr::compact(c(
  mota_theo_nhom("MCI", "Cháº·t"),
  mota_theo_nhom("MCI", "KhÃ¡"),
  mota_theo_nhom("MCI", "Vá»«a"),
  mota_theo_nhom("MCI", "Yáº¿u")
)), sep = " ")

cau_bang_sstt <- glue_collapse(purrr::compact(c(
  mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Cháº·t"),
  mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "KhÃ¡"),
  mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Vá»«a"),
  mota_theo_nhom("Sa sÃºt trÃ­ tuá»‡", "Yáº¿u")
)), sep = " ")
```

-   Nháº­n xÃ©t tá»•ng há»£p cho biá»ƒu Ä‘á»“ ggplot

```{r}
cor_wide_compare <- cor_by_group %>%
  select(NhÃ³m, Test.tháº§n.kinh, Há»‡.sá»‘.tÆ°Æ¡ng.quan.r) %>%
  pivot_wider(names_from = NhÃ³m, values_from = Há»‡.sá»‘.tÆ°Æ¡ng.quan.r)

test_tuong_quan_cao_hon_sstt <- cor_wide_compare %>%
  filter(`Sa sÃºt trÃ­ tuá»‡` - MCI >= 0.1) %>%
  arrange(desc(`Sa sÃºt trÃ­ tuá»‡` - MCI)) %>%
  pull(Test.tháº§n.kinh)

if (length(test_tuong_quan_cao_hon_sstt) > 0) {
  test_nhanh <- glue_collapse(head(test_tuong_quan_cao_hon_sstt, 3), sep = ", ", last = " vÃ  ")
  cau_inline_so_sanh_sstt_mci <- glue("Má»™t sá»‘ test nhÆ° {test_nhanh} cÃ³ tÆ°Æ¡ng quan máº¡nh hÆ¡n á»Ÿ nhÃ³m sa sÃºt trÃ­ tuá»‡.")
} else {
  cau_inline_so_sanh_sstt_mci <- "KhÃ´ng cÃ³ test nÃ o cÃ³ tÆ°Æ¡ng quan máº¡nh hÆ¡n rÃµ rá»‡t giá»¯a hai nhÃ³m."
}
```

### Inline gá»i káº¿t quáº£ trong tÃ i liá»‡u

#### Nháº­n xÃ©t tá»« báº£ng tÆ°Æ¡ng quan:

-   **NhÃ³m MCI**: `r cau_bang_mci`\
-   **NhÃ³m Sa sÃºt trÃ­ tuá»‡**: `r cau_bang_sstt`

#### Nháº­n xÃ©t tá»« biá»ƒu Ä‘á»“ tÆ°Æ¡ng quan:

`r cau_inline_so_sanh_sstt_mci`

## Má»©c Ä‘á»™ hoÃ n thÃ nh cÃ¡c test tháº§n kinh nháº­n thá»©c

```{r}
#| label: má»©c Ä‘á»™ hoÃ n thÃ nh cÃ¡c tests
# ğŸ§  Danh sÃ¡ch cÃ¡c biáº¿n test tháº§n kinh nháº­n thá»©c
neuro_vars <- c(
  "Im.recall1", "de.recall1", "de.reg1",
  "TMT.A.time", "TMT.B.time",
  "DS.forward1", "DS.backrward1",
  "animal.test1", "clock.drawing1"
)

# ğŸ“ NhÃ£n tiáº¿ng Viá»‡t tÆ°Æ¡ng á»©ng
test_labels_map <- c(
  "Im.recall1" = "Nhá»› láº¡i ngay",
  "de.recall1" = "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n",
  "de.reg1" = "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
  "TMT.A.time" = "Ná»‘i sá»‘",
  "TMT.B.time" = "Ná»‘i sá»‘-chá»¯",
  "DS.forward1" = "Äá»c chuá»—i sá»‘ xuÃ´i",
  "DS.backrward1" = "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
  "animal.test1" = "LÆ°u loÃ¡t ngÃ´n ngá»¯",
  "clock.drawing1" = "Váº½ Ä‘á»“ng há»“"
)

# âœ¨ Thá»© tá»± mong muá»‘n Ä‘á»ƒ hiá»ƒn thá»‹ nháº¥t quÃ¡n
label_order <- c(
  "Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
  "Ná»‘i sá»‘", "Ná»‘i sá»‘-chá»¯",
  "Äá»c chuá»—i sá»‘ xuÃ´i", "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
  "LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)

# ğŸ“Š TÃ­nh toÃ¡n tá»‰ lá»‡ hoÃ n thÃ nh theo nhÃ³m
completion_summary <- purrr::map_dfr(neuro_vars, function(var) {
  df %>%
    group_by(phan_loan_roi_loan_nhan_thuc) %>%
    summarise(
      Biáº¿n = var,
      HoÃ n.thÃ nh = round(100 * sum(!is.na(.data[[var]])) / n(), 1),
      .groups = "drop"
    )
})

# ğŸ“‹ Táº¡o báº£ng flextable
completion_wide <- completion_summary %>%
  select(NhÃ³m = phan_loan_roi_loan_nhan_thuc, Biáº¿n, HoÃ n.thÃ nh) %>%
  pivot_wider(names_from = NhÃ³m, values_from = HoÃ n.thÃ nh) %>%
  mutate(`Test tháº§n kinh` = factor(test_labels_map[Biáº¿n], levels = label_order)) %>%
  arrange(`Test tháº§n kinh`) %>%
  select(`Test tháº§n kinh`, `MCI`, `Sa sÃºt trÃ­ tuá»‡`)

ft_hoanthanh <- flextable(completion_wide) %>%
  set_header_labels(
    `Test tháº§n kinh` = "Test tháº§n kinh nháº­n thá»©c",
    `MCI` = "MCI (%)",
    `Sa sÃºt trÃ­ tuá»‡` = "Sa sÃºt trÃ­ tuá»‡ (%)"
  ) %>%
  colformat_num(decimal.mark = ",", suffix = "%") %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  autofit() %>%
  #set_caption("Báº£ng: Tá»‰ lá»‡ hoÃ n thÃ nh cÃ¡c test tháº§n kinh nháº­n thá»©c theo nhÃ³m cháº©n Ä‘oÃ¡n") %>%
  set_table_properties(width = 1, layout = "autofit")

# ğŸ“Š Chuáº©n bá»‹ vÃ  váº½ biá»ƒu Ä‘á»“ ggplot theo Ä‘Ãºng thá»© tá»±
label_order <- c(
  "Nhá»› láº¡i ngay", "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n", "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n",
  "Ná»‘i sá»‘", "Ná»‘i sá»‘-chá»¯",
  "Äá»c chuá»—i sá»‘ xuÃ´i", "Äá»c chuá»—i sá»‘ ngÆ°á»£c",
  "LÆ°u loÃ¡t ngÃ´n ngá»¯", "Váº½ Ä‘á»“ng há»“"
)

plot_hoanthanh <- completion_summary %>%
  mutate(
    NhÃ³m = factor(phan_loan_roi_loan_nhan_thuc, levels = c("MCI", "Sa sÃºt trÃ­ tuá»‡")),
    NhÃ£n = factor(test_labels_map[Biáº¿n], levels = rev(label_order))
  ) %>%
  ggplot(aes(x = NhÃ£n, y = HoÃ n.thÃ nh, fill = NhÃ³m)) +
  geom_col(position = position_dodge(width = 0.8), width = 0.7) +
  geom_text(
    aes(label = paste0(HoÃ n.thÃ nh, "%")),
    position = position_dodge(width = 0.8),
    hjust = -0.5,  # ğŸ‘ˆ NhÃ£n náº±m bÃªn pháº£i ngoÃ i cá»™t
    size = 3.5,
    family = "Times New Roman"
  ) +
  coord_flip(clip = "off") +
  scale_x_discrete(expand = expansion(mult = c(0.2, 0.2))) +
  scale_fill_brewer(palette = "Pastel2") +
  expand_limits(y = max(completion_summary$HoÃ n.thÃ nh) + 15) +  # ğŸ‘ˆ ThÃªm khoáº£ng trá»‘ng cho nhÃ£n
  labs(
   # title = "Tá»‰ lá»‡ hoÃ n thÃ nh cÃ¡c test tháº§n kinh nháº­n thá»©c",
    x = NULL, y = "Tá»‰ lá»‡ hoÃ n thÃ nh (%)", fill = "NhÃ³m"
  ) +
  theme_minimal(base_family = "Times New Roman") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 13),
    axis.text = element_text(size = 10),
    legend.position = "top"
  )

# âœï¸ Nháº­n xÃ©t tá»± Ä‘á»™ng
nhom_thap_mci <- completion_summary %>%
  filter(phan_loan_roi_loan_nhan_thuc == "MCI") %>%
  arrange(HoÃ n.thÃ nh) %>%
  slice(1)

nhom_thap_sstt <- completion_summary %>%
  filter(phan_loan_roi_loan_nhan_thuc == "Sa sÃºt trÃ­ tuá»‡") %>%
  arrange(HoÃ n.thÃ nh) %>%
  slice(1)

cau_hoanthanh_bang <- glue(
  "Tá»‰ lá»‡ hoÃ n thÃ nh nhÃ¬n chung cao, tá»« khoáº£ng ",
  "{min(completion_summary$HoÃ n.thÃ nh)}% Ä‘áº¿n {max(completion_summary$HoÃ n.thÃ nh)}%. ",
  "Test {test_labels_map[nhom_thap_mci$Biáº¿n]} tháº¥p nháº¥t á»Ÿ nhÃ³m MCI ({nhom_thap_mci$HoÃ n.thÃ nh}%), ",
  "vÃ  test {test_labels_map[nhom_thap_sstt$Biáº¿n]} tháº¥p nháº¥t á»Ÿ nhÃ³m sa sÃºt trÃ­ tuá»‡ ({nhom_thap_sstt$HoÃ n.thÃ nh}%)."
)

cau_hoanthanh_ggplot <- glue(
  "Biá»ƒu Ä‘á»“ cho tháº¥y pháº§n lá»›n test Ä‘Æ°á»£c thá»±c hiá»‡n vá»›i tá»‰ lá»‡ cao trong cáº£ hai nhÃ³m, ",
  "chá»‰ cÃ³ má»™t sá»‘ test gáº·p khÃ³ khÄƒn hÆ¡n á»Ÿ nhÃ³m MCI hoáº·c sa sÃºt trÃ­ tuá»‡."
)
```

```{r}
ft_hoanthanh
```

```{r}
plot_hoanthanh
```

### Nháº­n xÃ©t tá»« báº£ng:

`r cau_hoanthanh_bang`

### Nháº­n xÃ©t tá»« biá»ƒu Ä‘á»“:

`r cau_hoanthanh_ggplot`

## ÄÃ¡nh giÃ¡ sá»± tÆ°Æ¡ng Ä‘á»“ng giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng theo tiÃªu chuáº©n lÃ¢m sÃ ng

TiÃªu chuáº©n lÃ¢m sÃ ng (biáº¿n lam_sang_group) vÃ  tiÃªu chuáº©n phÃ¢n Ä‘á»™ MMSE (nhÃ³m lam_sang_group)Ä‘á»‘i vá»›i cÃ¡c má»©c Ä‘á»™ "Suy giáº£m nháº­n thá»©c nháº¹", "Sa sÃºt trÃ­ tuá»‡ nháº¹","Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh","Sa sÃºt trÃ­ tuá»‡ náº·ng"

```{r}
# ğŸ“¦ Chuáº©n bá»‹ dá»¯ liá»‡u vÃ  mÃ£ hÃ³a thá»© báº­c
df_ord <- df %>%
  filter(
    !is.na(mmse_group),
    !is.na(lam_sang_group),
    mmse_group != "BÃ¬nh thÆ°á»ng"  # âŒ Loáº¡i bá» nhÃ³m BÃ¬nh thÆ°á»ng
  ) %>%
  mutate(
    mmse_group = droplevels(mmse_group),
    lam_sang_group = droplevels(lam_sang_group),
    mmse_num = as.numeric(mmse_group),
    lam_sang_num = as.numeric(lam_sang_group)
  )

# ğŸ“ˆ Kiá»ƒm Ä‘á»‹nh Spearman vÃ  Kendall
test_spearman <- cor.test(df_ord$mmse_num, df_ord$lam_sang_num, method = "spearman")
test_kendall  <- cor.test(df_ord$mmse_num, df_ord$lam_sang_num, method = "kendall")

rho <- round(test_spearman$estimate, 2)
pval_s <- test_spearman$p.value
pval_s_fmt <- ifelse(pval_s < 0.001, "< 0.001", sprintf("%.3f", pval_s))

tau <- round(test_kendall$estimate, 2)
pval_k <- test_kendall$p.value
pval_k_fmt <- ifelse(pval_k < 0.001, "< 0.001", sprintf("%.3f", pval_k))

# ğŸ§¾ Táº¡o báº£ng táº§n suáº¥t dáº¡ng chÃ©o
tab_ordinal_long <- df_ord %>%
  count(`PhÃ¢n loáº¡i lÃ¢m sÃ ng` = lam_sang_group, `PhÃ¢n Ä‘á»™ MMSE` = mmse_group) %>%
  group_by(`PhÃ¢n loáº¡i lÃ¢m sÃ ng`) %>%
  mutate(
    Tá»·_lá»‡ = round(100 * n / sum(n), 1),
    Táº§n_suáº¥t = glue("{n} ({Tá»·_lá»‡}%)")
  ) %>%
  select(-n, -Tá»·_lá»‡) %>%
  pivot_wider(names_from = `PhÃ¢n Ä‘á»™ MMSE`, values_from = Táº§n_suáº¥t, values_fill = "-") %>%
  mutate(
    `GiÃ¡ trá»‹ p` = c(pval_s_fmt, rep("", n() - 1)),
    `Spearman Ï` = c(rho, rep("", n() - 1)),
    `Kendall Ï„` = c(tau, rep("", n() - 1))
  )

# ğŸ“Š Báº£ng flextable
ft_ord <- flextable(tab_ordinal_long) %>%
  set_caption("Báº£ng: PhÃ¢n bá»‘ chÃ©o giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng (loáº¡i BT)") %>%
  autofit() %>%
  font(fontname = "Times New Roman", part = "all") %>%
  fontsize(size = 11, part = "all") %>%
  align(align = "center", part = "all")

# ğŸ¨ NhÃ£n rÃºt gá»n
short_labels <- c(
  "Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
  "Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)

# ğŸŒ¡ï¸ Heatmap vá»›i mÃ u pastel
df_heatmap <- df_ord %>%
  count(lam_sang_group, mmse_group)

plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
  geom_tile(color = "white") +
  geom_text(aes(label = n), color = "black", size = 4) +
  scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +
  scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
  scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
  labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
  theme_minimal(base_family = "Times New Roman") +
  theme(axis.text = element_text(size = 11), panel.grid = element_blank())

# ğŸ”µ Scatter ordinal pastel
plot_scatter <- ggplot(df_ord, aes(x = mmse_num, y = lam_sang_num)) +
  geom_jitter(width = 0.2, height = 0.2, alpha = 0.6, color = "#40E0D0") +  # xanh ngá»c
  geom_smooth(method = "lm", se = FALSE, color = "#FF6F61", linetype = "dashed") +  # cam Ä‘Ã o
  scale_x_continuous(
    breaks = seq_along(levels(df_ord$mmse_group)),
    labels = short_labels[levels(df_ord$mmse_group)]
  ) +
  scale_y_continuous(
    breaks = seq_along(levels(df_ord$lam_sang_group)),
    labels = short_labels[levels(df_ord$lam_sang_group)]
  ) +
  labs(x = "PhÃ¢n Ä‘á»™ MMSE", y = "PhÃ¢n loáº¡i lÃ¢m sÃ ng") +
  theme_minimal(base_family = "Times New Roman") +
  theme(axis.text = element_text(size = 11), panel.grid = element_blank())

# ğŸ“ Inline codes mÃ´ táº£
cau_chen_bieu_do_heatmap <- glue(
  "Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n sÆ° phÃ¢n bá»‘ chÃ©o cho tháº¥y má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng, hay cÃ²n gá»i tiÃªu chuáº©n vÃ ng. Biá»ƒu Ä‘á»“ cho tháº¥y há»‡ sá»‘ Spearman Ï = {rho}, Kendall Ï„ = {tau}, vá»›i p = {pval_s_fmt}. ",
  if (pval_s < 0.05) "Káº¿t quáº£ cÃ³ Ã½ nghÄ©a thá»‘ng kÃª." else "Káº¿t quáº£ khÃ´ng cÃ³ Ã½ nghÄ©a thá»‘ng kÃª."
)

cau_bieudo_ordinal <- glue(
  "Biá»ƒu Ä‘á»“ minh há»a phÃ¢n bá»‘ táº­p trung á»Ÿ cÃ¡c má»©c Ä‘á»™ tÆ°Æ¡ng á»©ng, ",
  "cho tháº¥y xu hÆ°á»›ng Ä‘á»“ng biáº¿n giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng."
)

cau_chen_bieu_do_gop_2_loai  <- glue(
  "Biá»ƒu Ä‘á»“ bÃªn trÃ¡i  thá»ƒ hiá»‡n sÆ° phÃ¢n bá»‘ chÃ©o cho tháº¥y má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng, hay cÃ²n gá»i tiÃªu chuáº©n vÃ ng. Biá»ƒu Ä‘á»“ cho tháº¥y há»‡ sá»‘ Spearman Ï = {rho}, Kendall Ï„ = {tau}, vá»›i p = {pval_s_fmt}. ",
  if (pval_s < 0.05) "Káº¿t quáº£ cÃ³ Ã½ nghÄ©a thá»‘ng kÃª." else "Káº¿t quáº£ khÃ´ng cÃ³ Ã½ nghÄ©a thá»‘ng kÃª. ",  "Biá»ƒu Ä‘á»“ bÃªn pháº£i minh há»a phÃ¢n bá»‘ táº­p trung á»Ÿ cÃ¡c má»©c Ä‘á»™ tÆ°Æ¡ng á»©ng, ", "cho tháº¥y xu hÆ°á»›ng Ä‘á»“ng biáº¿n giá»¯a phÃ¢n Ä‘á»™ giai Ä‘oáº¡n bá»‡nh theo tiÃªu chuáº©n MMSE vÃ  phÃ¢n Ä‘á»™ theo tiÃªu chuáº©n lÃ¢m sÃ ng."
)
```

#### gá»™p 2 biá»ƒu Ä‘á»“

```{r}
#| label: plot_heat_scatter_ordinal
#| fig-cap: "Biá»ƒu Ä‘á»“ heatmap vÃ  scatter ordinal thá»ƒ hiá»‡n má»‘i liÃªn há»‡ giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  giai Ä‘oáº¡n lÃ¢m sÃ ng"
#| echo: true
#| message: false
#| warning: false
#| fig-align: center
#| out.width: "100%"

pacman::p_load(patchwork)  # ğŸ“¦ GhÃ©p biá»ƒu Ä‘á»“

# ğŸŒˆ NhÃ£n rÃºt gá»n
short_labels <- c(
  "Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
  "Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)

# ğŸŒ¡ï¸ Heatmap pastel
df_heatmap <- df_ord %>%
  count(lam_sang_group, mmse_group)

plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
  geom_tile(color = "white") +
  geom_text(aes(label = n), color = "black", size = 4) +
  scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +  # pastel xanh-há»“ng
  scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
  scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
  labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ trÃªn lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
  theme_minimal(base_family = "Times New Roman") +
  theme(
   axis.text = element_text(size = 11),
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid = element_blank()
  )

# ğŸ”µ Scatter ordinal pastel
plot_scatter <- ggplot(df_ord, aes(x = mmse_num, y = lam_sang_num)) +
  geom_jitter(width = 0.2, height = 0.2, alpha = 0.6, color = "#40E0D0") +  # turquoise
  geom_smooth(method = "lm", se = FALSE, color = "#FF6F61", linetype = "dashed") +  # coral
  scale_x_continuous(
    breaks = seq_along(levels(df_ord$mmse_group)),
    labels = short_labels[levels(df_ord$mmse_group)]
  ) +
  scale_y_continuous(
    breaks = seq_along(levels(df_ord$lam_sang_group)),
    labels = short_labels[levels(df_ord$lam_sang_group)]
  ) +
  labs(x = "PhÃ¢n Ä‘á»™ theo MMSE", y = "PhÃ¢n Ä‘á»™ trÃªn lÃ¢m sÃ ng") +
  theme_minimal(base_family = "Times New Roman") +
  theme(
   axis.text = element_text(size = 11),
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid = element_blank()
  )


```

#### gá»™p chung Ä‘á»ƒ chÃ¨n powerpoint

```{r}
# ğŸŒˆ NhÃ£n rÃºt gá»n
short_labels <- c(
  "Suy giáº£m nháº­n thá»©c nháº¹" = "SGNT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ nháº¹" = "SSTT nháº¹",
  "Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh" = "SSTT TB",
  "Sa sÃºt trÃ­ tuá»‡ náº·ng" = "SSTT náº·ng"
)

# ğŸŒ¡ï¸ Heatmap pastel
df_heatmap <- df_ord %>%
  count(lam_sang_group, mmse_group)

plot_heat <- ggplot(df_heatmap, aes(x = mmse_group, y = lam_sang_group, fill = n)) +
  geom_tile(color = "white") +
  geom_text(aes(label = n), color = "black", size = 4) +
  scale_fill_gradient(low = "#a8edea", high = "#fed6e3") +  # pastel xanh-há»“ng
  scale_x_discrete(labels = short_labels[levels(df_ord$mmse_group)]) +
  scale_y_discrete(labels = short_labels[levels(df_ord$lam_sang_group)]) +
  labs(x = "PhÃ¢n Ä‘á»™ MMSE", y = "PhÃ¢n loáº¡i lÃ¢m sÃ ng", fill = "Táº§n suáº¥t") +
  theme_minimal(base_family = "Times New Roman") +  # âœ… hoÃ n chá»‰nh font
  theme(
    axis.text = element_text(size = 11),
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid = element_blank()
  )
```

#### Báº£ng flextable (chÆ°a cáº§n chÃ¨n )

```{r}
#| eval: false
#| include: false
ft_ord
```

#### biá»ƒu Ä‘á»“ gá»™p

```{r}
plot_heat + plot_scatter + plot_layout(ncol = 2)
```

##### `r cau_chen_bieu_do_gop_2_loai`

#### Biá»ƒu Ä‘á»“ heatmap

```{r}
plot_heat
```

##### `r cau_chen_bieu_do_heatmap`

#### Biá»ƒu Ä‘á»“ scatter vá» sá»± phÃ¹ há»£p

```{r}
plot_scatter
```

##### `r cau_bieudo_ordinal`

::: {custom-style="CAN GIUA DAM 14 ONE"}
Äáº¶T Váº¤N Äá»€
:::

Viá»‡t Nam lÃ  má»™t trong cÃ¡c quá»‘c gia cÃ³ tá»‘c Ä‘á»™ giÃ  hÃ³a dÃ¢n sá»‘ nhanh nháº¥t tháº¿ giá»›i. NgÆ°á»i ta Æ°á»›c tÃ­nh ráº±ng hÆ¡n 10% dÃ¢n sá»‘ Viá»‡t Nam bao gá»“m nhá»¯ng ngÆ°á»i tá»« 60 tuá»•i trá»Ÿ lÃªn, tá»« nÄƒm 2015 Ä‘áº¿n nÄƒm 2020[@nguyen2024nhan_thuc], tá»· lá»‡ dÃ¢n sá»‘ trÃªn 65 tuá»•i á»Ÿ Viá»‡t Nam tÄƒng tá»« 6,7% lÃªn 7,9% vÃ  sáº½ tiáº¿p tá»¥c cho tháº¥y xu hÆ°á»›ng tÄƒng Ä‘áº¿n nÄƒm 2050 [@nguyen2021share]. Tá»· lá»‡ dÃ¢n sá»‘ tá»« 60 tuá»•i trá»Ÿ lÃªn dá»± kiáº¿n sáº½ chiáº¿m 20,4% tá»•ng dÃ¢n sá»‘ Viá»‡t Nam vÃ o nÄƒm 20383. Dá»±a trÃªn cÃ¡c xu hÆ°á»›ng nhÃ¢n kháº©u há»c nÃ y, dá»± kiáº¿n Ä‘áº¿n nÄƒm 2050, sáº½ cÃ³ 29 triá»‡u ngÆ°á»i trÃªn 60 tuá»•i, chiáº¿m má»™t pháº§n ba dÃ¢n sá»‘ cáº£ nÆ°á»›c, trong Ä‘Ã³ nhá»¯ng ngÆ°á»i trÃªn 80 tuá»•i dá»± kiáº¿n sáº½ chiáº¿m Ã­t nháº¥t 6% toÃ n bá»™ dÃ¢n sá»‘ [@helpage2019vietnam].

CÃ¹ng vá»›i viá»‡c giÃ  hÃ³a dÃ¢n sá»‘, tá»‰ lá»‡ ngÆ°á»i sa sÃºt trÃ­ tuá»‡ cÅ©ng tÄƒng lÃªn, sá»‘ ngÆ°á»i máº¯c chá»©ng sa sÃºt trÃ­ tuá»‡ Æ°á»›c tÃ­nh tÄƒng gáº¥p Ä‘Ã´i sau má»—i 20 nÄƒm, tá»« 660.000 vÃ o nÄƒm 2015 lÃªn 1,2 triá»‡u vÃ o nÄƒm 2030 vÃ  2,4 triá»‡u vÃ o nÄƒm 2050[@nguyen2020dementia]. Sa sÃºt trÃ­ tuá»‡ (SSTT) lÃ  má»™t bá»‡nh lÃ½ cá»§a nÃ£o bá»™, gÃ¢y ra suy giáº£m chá»©c nÄƒng nháº­n thá»©c, hÃ nh vi vÃ  hoáº¡t Ä‘á»™ng sá»‘ng cá»§a bá»‡nh nhÃ¢n. Sa sÃºt trÃ­ tuá»‡ lÃ  thuáº­t ngá»¯ rá»™ng dÃ¹ng Ä‘á»ƒ mÃ´ táº£ tÃ¬nh tráº¡ng máº¥t trÃ­ nhá»›, nháº­n thá»©c, lÃ½ trÃ­, ká»¹ nÄƒng xÃ£ há»™i vÃ  thá»ƒ cháº¥t.

CÃ³ nhiá»u loáº¡i sa sÃºt trÃ­ tuá»‡ bao gá»“m bá»‡nh Alzheimer, sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u, sa sÃºt trÃ­ tuá»‡ trÃ¡n thÃ¡i dÆ°Æ¡ng vÃ  bá»‡nh thá»ƒ Lewy. Sa sÃºt trÃ­ tuá»‡ cÃ³ thá»ƒ xáº£y ra vá»›i báº¥t ká»³ ai, nhÆ°ng phá»• biáº¿n hÆ¡n sau tuá»•i 65[@aihw2022dementia].

Tá»« nÄƒm 2019 Ä‘áº¿n nay, ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Ã£ sá»­ dá»¥ng bá»™ tráº¯c nghiá»‡m (Test) Ä‘Ã¡nh giÃ¡ chá»©c nÄƒng tháº§n kinh nháº­n thá»©c Viá»‡t Nam (VnCA- Vietnamese Cognitive Assessment), Há»™i bá»‡nh Alzheimer vÃ  Rá»‘i loáº¡n tháº§n kinh nháº­n thá»©c Viá»‡t Nam (Vietnam Alzheimer Disease & Neurocognitive Disorders Association â€“ VnADA), chuyÃªn gia Trung tÃ¢m Bá»‡nh thoÃ¡i hÃ³a tháº§n kinh Äá»©c (DZNE), ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 cÃ¹ng phÃ¡t triá»ƒn.

**Má»¥c tiÃªu nghiÃªn cá»©u cá»§a nhiá»‡m vá»¥**

-   NghiÃªn cá»©u má»‘i tÆ°Æ¡ng quan cá»§a thang Ä‘iá»ƒm MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c táº¡i Bá»‡nh viá»‡n 30-4.

-   ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng cá»§a bá»™ Test tháº§n kinh nháº­n thá»©c trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ Sa sÃºt trÃ­ tuá»‡ táº¡i Bá»‡nh viá»‡n 30-4

# Tá»”NG QUANG TÃ€I LIá»†U

## Tá»•ng quan vá» suy giáº£m nháº­n thá»©c nháº¹ vÃ  sa sÃºt trÃ­ tuá»‡

Suy giáº£m nháº­n thá»©c nháº¹ (Mild Cognitive Impairment â€“ MCI) vÃ  sa sÃºt trÃ­ tuá»‡ (dementia) lÃ  hai tÃ¬nh tráº¡ng phá»• biáº¿n á»Ÿ ngÆ°á»i cao tuá»•i, biá»ƒu hiá»‡n qua sá»± suy giáº£m chá»©c nÄƒng nháº­n thá»©c á»Ÿ cÃ¡c má»©c Ä‘á»™ khÃ¡c nhau. MCI Ä‘Æ°á»£c xem lÃ  giai Ä‘oáº¡n chuyá»ƒn tiáº¿p giá»¯a quÃ¡ trÃ¬nh lÃ£o hÃ³a bÃ¬nh thÆ°á»ng vÃ  sa sÃºt trÃ­ tuá»‡, Ä‘áº·c trÆ°ng bá»Ÿi sá»± suy giáº£m má»™t hoáº·c nhiá»u lÄ©nh vá»±c nháº­n thá»©c nhÆ°ng chÆ°a áº£nh hÆ°á»Ÿng rÃµ rá»‡t Ä‘áº¿n hoáº¡t Ä‘á»™ng sá»‘ng hÃ ng ngÃ y. NgÆ°á»£c láº¡i, sa sÃºt trÃ­ tuá»‡ lÃ  há»™i chá»©ng tiáº¿n triá»ƒn máº¡n tÃ­nh, trong Ä‘Ã³ sá»± suy giáº£m nháº­n thá»©c Ä‘á»§ má»©c Ä‘á»™ Ä‘á»ƒ áº£nh hÆ°á»Ÿng nghiÃªm trá»ng Ä‘áº¿n kháº£ nÄƒng tá»± chÄƒm sÃ³c, nghá» nghiá»‡p vÃ  chá»©c nÄƒng xÃ£ há»™i cá»§a ngÆ°á»i bá»‡nh @Petersen2014.

### Dá»‹ch tá»… há»c

Theo Tá»• chá»©c Y táº¿ Tháº¿ giá»›i (WHO), tÃ­nh Ä‘áº¿n nÄƒm 2023, cÃ³ khoáº£ng 55 triá»‡u ngÆ°á»i Ä‘ang sá»‘ng chung vá»›i sa sÃºt trÃ­ tuá»‡ trÃªn toÃ n cáº§u, vá»›i khoáº£ng 10 triá»‡u ca máº¯c má»›i má»—i nÄƒm. Con sá»‘ nÃ y Ä‘Æ°á»£c dá»± bÃ¡o sáº½ tÄƒng lÃªn 139 triá»‡u ngÆ°á»i vÃ o nÄƒm 2050 do tá»‘c Ä‘á»™ giÃ  hÃ³a dÃ¢n sá»‘ @WHO2023. Sa sÃºt trÃ­ tuá»‡ hiá»‡n lÃ  nguyÃªn nhÃ¢n Ä‘á»©ng thá»© 7 gÃ¢y tá»­ vong toÃ n cáº§u vÃ  lÃ  nguyÃªn nhÃ¢n hÃ ng Ä‘áº§u gÃ¢y phá»¥ thuá»™c á»Ÿ ngÆ°á»i cao tuá»•i.

Táº¡i Viá»‡t Nam, cÃ¡c nghiÃªn cá»©u cho tháº¥y tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ á»Ÿ ngÆ°á»i â‰¥60 tuá»•i dao Ä‘á»™ng tá»« 4% Ä‘áº¿n 8%, trong khi MCI chiáº¿m khoáº£ng 10â€“20% á»Ÿ nhÃ³m ngÆ°á»i cao tuá»•i @Nguyen2020. Viá»‡t Nam hiá»‡n cÃ³ hÆ¡n 12 triá»‡u ngÆ°á»i tá»« 60 tuá»•i trá»Ÿ lÃªn, con sá»‘ nÃ y dá»± kiáº¿n sáº½ vÆ°á»£t 20 triá»‡u vÃ o nÄƒm 2039, lÃ m gia tÄƒng gÃ¡nh náº·ng vá» cÃ¡c bá»‡nh lÃ½ nháº­n thá»©c. TÃ¬nh tráº¡ng nÃ y Ä‘áº·c biá»‡t Ä‘Ã¡ng quan ngáº¡i á»Ÿ cÃ¡c vÃ¹ng nÃ´ng thÃ´n vÃ  miá»n nÃºi, nÆ¡i thiáº¿u há»¥t nguá»“n lá»±c y táº¿ vÃ  Ä‘á»™i ngÅ© chuyÃªn ngÃ nh lÃ£o khoa.

### CÆ¡ cháº¿ bá»‡nh sinh

CÆ¡ cháº¿ bá»‡nh sinh cá»§a MCI vÃ  sa sÃºt trÃ­ tuá»‡ ráº¥t phá»©c táº¡p, liÃªn quan Ä‘áº¿n nhiá»u yáº¿u tá»‘ tháº§n kinh, máº¡ch mÃ¡u, chuyá»ƒn hÃ³a vÃ  di truyá»n. á» bá»‡nh Alzheimer â€“ nguyÃªn nhÃ¢n phá»• biáº¿n nháº¥t â€“ sá»± tÃ­ch tá»¥ cá»§a máº£ng Î²-amyloid vÃ  Ä‘Ã¡m rá»‘i sá»£i tau trong nÃ£o gÃ¢y tá»•n thÆ°Æ¡ng synap vÃ  cháº¿t táº¿ bÃ o tháº§n kinh @Selkoe2012. CÃ¡c thay Ä‘á»•i nÃ y báº¯t Ä‘áº§u Ã¢m tháº§m tá»« nhiá»u nÄƒm trÆ°á»›c khi biá»ƒu hiá»‡n lÃ¢m sÃ ng xuáº¥t hiá»‡n, thÆ°á»ng khá»Ÿi phÃ¡t tá»« vÃ¹ng háº£i mÃ£ (hippocampus) â€“ trung tÃ¢m ghi nhá»› cá»§a nÃ£o â€“ vÃ  lan dáº§n ra vá» nÃ£o.

NgoÃ i ra, tá»•n thÆ°Æ¡ng vi máº¡ch nÃ£o vÃ  thiáº¿u mÃ¡u nÃ£o máº¡n tÃ­nh cÅ©ng Ä‘Ã³ng vai trÃ² quan trá»ng trong bá»‡nh sinh cá»§a sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u. CÃ¡c yáº¿u tá»‘ nguy cÆ¡ nhÆ° tÄƒng huyáº¿t Ã¡p, Ä‘Ã¡i thÃ¡o Ä‘Æ°á»ng, rá»‘i loáº¡n lipid mÃ¡u vÃ  hÃºt thuá»‘c lÃ¡ lÃ m suy giáº£m tÃ­nh toÃ n váº¹n cá»§a hÃ ng rÃ o mÃ¡uâ€“nÃ£o, dáº«n Ä‘áº¿n vi nhá»“i mÃ¡u nÃ£o nhiá»u á»• nhá» (lacunar infarcts) vÃ  tá»•n thÆ°Æ¡ng cháº¥t tráº¯ng. Yáº¿u tá»‘ viÃªm tháº§n kinh, stress oxy hÃ³a, rá»‘i loáº¡n chuyá»ƒn hÃ³a glucose á»Ÿ nÃ£o, máº¥t cÃ¢n báº±ng cháº¥t dáº«n truyá»n tháº§n kinh (Ä‘áº·c biá»‡t lÃ  acetylcholine vÃ  glutamate), cÅ©ng gÃ³p pháº§n vÃ o tiáº¿n trÃ¬nh thoÃ¡i hÃ³a tháº§n kinh @Cummings2019.

Vá» máº·t di truyá»n, sá»± mang gen APOE Îµ4 lÃ  yáº¿u tá»‘ nguy cÆ¡ cao Ä‘á»‘i vá»›i bá»‡nh Alzheimer khá»Ÿi phÃ¡t muá»™n. Tuy nhiÃªn, khÃ´ng pháº£i táº¥t cáº£ nhá»¯ng ngÆ°á»i mang gen nÃ y Ä‘á»u phÃ¡t triá»ƒn bá»‡nh, cho tháº¥y vai trÃ² cá»§a mÃ´i trÆ°á»ng sá»‘ng, lá»‘i sá»‘ng vÃ  kháº£ nÄƒng dá»± trá»¯ nháº­n thá»©c trong viá»‡c Ä‘iá»u hÃ²a nguy cÆ¡.

### CÃ¡c thá»ƒ lÃ¢m sÃ ng cá»§a sa sÃºt trÃ­ tuá»‡

Sa sÃºt trÃ­ tuá»‡ bao gá»“m nhiá»u thá»ƒ bá»‡nh khÃ¡c nhau, vá»›i Ä‘áº·c Ä‘iá»ƒm bá»‡nh sinh vÃ  lÃ¢m sÃ ng riÃªng biá»‡t:

-   **Sa sÃºt trÃ­ tuá»‡ do Alzheimer (Alzheimer's disease dementia)**: lÃ  thá»ƒ phá»• biáº¿n nháº¥t, chiáº¿m khoáº£ng 60â€“70% tá»•ng sá»‘ ca. Äáº·c trÆ°ng bá»Ÿi suy giáº£m trÃ­ nhá»› gáº§n lÃ  triá»‡u chá»©ng khá»Ÿi phÃ¡t, sau Ä‘Ã³ lan sang cÃ¡c chá»©c nÄƒng nháº­n thá»©c khÃ¡c nhÆ° ngÃ´n ngá»¯, Ä‘iá»u hÃ nh vÃ  Ä‘á»‹nh hÆ°á»›ng. Bá»‡nh tiáº¿n triá»ƒn cháº­m nhÆ°ng liÃªn tá»¥c qua cÃ¡c giai Ä‘oáº¡n tá»« nháº¹ Ä‘áº¿n náº·ng.

-   **Sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u (vascular dementia)**: chiáº¿m khoáº£ng 15â€“20% vÃ  thÆ°á»ng gáº·p á»Ÿ ngÆ°á»i cÃ³ tiá»n sá»­ Ä‘á»™t quá»µ hoáº·c yáº¿u tá»‘ nguy cÆ¡ tim máº¡ch. Bá»‡nh cÃ³ thá»ƒ khá»Ÿi phÃ¡t Ä‘á»™t ngá»™t sau má»™t biáº¿n cá»‘ máº¡ch mÃ¡u nÃ£o, hoáº·c tiáº¿n triá»ƒn theo kiá»ƒu báº­c thang. Triá»‡u chá»©ng Ä‘iá»ƒn hÃ¬nh gá»“m rá»‘i loáº¡n chÃº Ã½, cháº­m cháº¡p tÃ¢m tháº§n váº­n Ä‘á»™ng, rá»‘i loáº¡n chá»©c nÄƒng Ä‘iá»u hÃ nh vÃ  cáº£m xÃºc khÃ´ng á»•n Ä‘á»‹nh.

-   **Sa sÃºt trÃ­ tuá»‡ thá»ƒ Lewy (Dementia with Lewy bodies)**: Ä‘áº·c trÆ°ng bá»Ÿi dao Ä‘á»™ng nháº­n thá»©c theo ngÃ y, áº£o giÃ¡c thá»‹ giÃ¡c sá»‘ng Ä‘á»™ng, rá»‘i loáº¡n giáº¥c ngá»§ REM vÃ  dáº¥u hiá»‡u ngoáº¡i thÃ¡p giá»‘ng Parkinson. Nháº¡y cáº£m vá»›i thuá»‘c chá»‘ng loáº¡n tháº§n lÃ  dáº¥u hiá»‡u quan trá»ng giÃºp gá»£i Ã½ cháº©n Ä‘oÃ¡n.

-   **Sa sÃºt trÃ­ tuá»‡ do Parkinson (Parkinsonâ€™s disease dementia)**: thÆ°á»ng xuáº¥t hiá»‡n á»Ÿ giai Ä‘oáº¡n muá»™n cá»§a bá»‡nh Parkinson, khi triá»‡u chá»©ng váº­n Ä‘á»™ng Ä‘Ã£ tá»“n táº¡i Ã­t nháº¥t 1 nÄƒm. Bá»‡nh nhÃ¢n thÆ°á»ng biá»ƒu hiá»‡n cháº­m tÆ° duy, suy giáº£m chá»©c nÄƒng Ä‘iá»u hÃ nh, khÃ³ khÄƒn trong chuyá»ƒn Ä‘á»•i chÃº Ã½ vÃ  giáº£m trÃ­ nhá»› lÃ m viá»‡c.

### Triá»‡u chá»©ng lÃ¢m sÃ ng

á» giai Ä‘oáº¡n MCI, bá»‡nh nhÃ¢n cÃ³ thá»ƒ biá»ƒu hiá»‡n suy giáº£m trÃ­ nhá»› gáº§n, khÃ³ ghi nhá»› cÃ¡c cuá»™c háº¹n hoáº·c thÃ´ng tin vá»«a há»c. NgoÃ i ra, cÃ³ thá»ƒ cÃ³ biá»ƒu hiá»‡n giáº£m kháº£ nÄƒng táº­p trung, giáº£m hiá»‡u quáº£ trong cÃ¡c hoáº¡t Ä‘á»™ng Ä‘Ã²i há»i xá»­ lÃ½ thÃ´ng tin nhÆ° quáº£n lÃ½ tÃ i chÃ­nh hoáº·c láº­p káº¿ hoáº¡ch. Tuy nhiÃªn, kháº£ nÄƒng tá»± chÄƒm sÃ³c váº«n cÃ²n nguyÃªn váº¹n hoáº·c chá»‰ suy giáº£m ráº¥t nháº¹.

NgÆ°á»£c láº¡i, sa sÃºt trÃ­ tuá»‡ biá»ƒu hiá»‡n báº±ng suy giáº£m rÃµ rá»‡t á»Ÿ nhiá»u lÄ©nh vá»±c nháº­n thá»©c nhÆ° trÃ­ nhá»›, chÃº Ã½, ngÃ´n ngá»¯, chá»©c nÄƒng Ä‘iá»u hÃ nh vÃ  nháº­n thá»©c thá»‹ giÃ¡c â€“ khÃ´ng gian. Triá»‡u chá»©ng bao gá»“m: hay láº·p cÃ¢u, quÃªn tÃªn ngÆ°á»i quen, máº¥t Ä‘á»‹nh hÆ°á»›ng thá»i gian â€“ khÃ´ng gian, khÃ³ khÄƒn trong sá»­ dá»¥ng tá»« ngá»¯ hoáº·c theo dÃµi cÃ¢u chuyá»‡n, láº¡c Ä‘Æ°á»ng ngay cáº£ á»Ÿ nÆ¡i quen thuá»™c, thay Ä‘á»•i tÃ­nh cÃ¡ch, vÃ  rá»‘i loáº¡n hÃ nh vi nhÆ° lo Ã¢u, kÃ­ch Ä‘á»™ng hoáº·c tráº§m cáº£m. á» giai Ä‘oáº¡n náº·ng, bá»‡nh nhÃ¢n máº¥t hoÃ n toÃ n kháº£ nÄƒng tá»± chÄƒm sÃ³c vÃ  phá»¥ thuá»™c hoÃ n toÃ n vÃ o ngÆ°á»i thÃ¢n.

### Cháº©n Ä‘oÃ¡n phÃ¢n biá»‡t

Viá»‡c cháº©n Ä‘oÃ¡n cáº§n phÃ¢n biá»‡t vá»›i cÃ¡c tÃ¬nh tráº¡ng nhÆ°:

-   **Tráº§m cáº£m náº·ng**: cÃ³ thá»ƒ gÃ¢y ra "sa sÃºt trÃ­ tuá»‡ giáº£" vá»›i biá»ƒu hiá»‡n than phiá»n trÃ­ nhá»› kÃ©m, nhÆ°ng thÆ°á»ng há»“i phá»¥c khi Ä‘iá»u trá»‹ tráº§m cáº£m.

-   **Thiáº¿u há»¥t vitamin B12, suy giÃ¡p, rá»‘i loáº¡n Ä‘iá»‡n giáº£i**: cÃ³ thá»ƒ gÃ¢y ra triá»‡u chá»©ng tÆ°Æ¡ng tá»± nhÆ°ng cáº£i thiá»‡n sau khi Ä‘iá»u trá»‹ nguyÃªn nhÃ¢n.

-   **Sáº£ng (delirium)**: thÆ°á»ng khá»Ÿi phÃ¡t cáº¥p tÃ­nh, dao Ä‘á»™ng vá» má»©c Ä‘á»™ tá»‰nh tÃ¡o, thÆ°á»ng cÃ³ yáº¿u tá»‘ khá»Ÿi phÃ¡t rÃµ (nhiá»…m trÃ¹ng, thuá»‘c).

-   **Rá»‘i loáº¡n tÃ¢m tháº§n phÃ¢n liá»‡t, rá»‘i loáº¡n lo Ã¢u máº¡n tÃ­nh**: cÃ³ thá»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n nháº­n thá»©c nhÆ°ng khÃ´ng cÃ³ tiáº¿n triá»ƒn máº¡n tÃ­nh nhÆ° sa sÃºt trÃ­ tuá»‡.

Cháº©n Ä‘oÃ¡n chÃ­nh xÃ¡c cáº§n dá»±a vÃ o khai thÃ¡c bá»‡nh sá»­, thÄƒm khÃ¡m tháº§n kinh, cÃ¡c cÃ´ng cá»¥ sÃ ng lá»c nhÆ° MMSE, cÃ¹ng vá»›i hÃ¬nh áº£nh há»c tháº§n kinh (CT, MRI) vÃ  xÃ©t nghiá»‡m sinh hÃ³a.

### Diá»…n tiáº¿n lÃ¢m sÃ ng

MCI cÃ³ diá»…n tiáº¿n Ä‘a dáº¡ng: má»™t sá»‘ trÆ°á»ng há»£p cÃ³ thá»ƒ á»•n Ä‘á»‹nh nhiá»u nÄƒm, má»™t sá»‘ cÃ³ thá»ƒ phá»¥c há»“i náº¿u nguyÃªn nhÃ¢n lÃ  thá»© phÃ¡t (nhÆ° stress, thiáº¿u B12), nhÆ°ng má»™t tá»‰ lá»‡ lá»›n sáº½ tiáº¿n triá»ƒn thÃ nh sa sÃºt trÃ­ tuá»‡. CÃ¡c nghiÃªn cá»©u cho tháº¥y khoáº£ng 10â€“15% ngÆ°á»i MCI chuyá»ƒn sang sa sÃºt trÃ­ tuá»‡ má»—i nÄƒm @Petersen2014.

Sa sÃºt trÃ­ tuá»‡ lÃ  tÃ¬nh tráº¡ng khÃ´ng há»“i phá»¥c vÃ  tiáº¿n triá»ƒn dáº§n theo thá»i gian. Bá»‡nh thÆ°á»ng tráº£i qua 3 giai Ä‘oáº¡n:

-   **Giai Ä‘oáº¡n nháº¹**: quÃªn gáº§n, giáº£m chÃº Ã½, rá»‘i loáº¡n Ä‘á»‹nh hÆ°á»›ng nháº¹

-   **Giai Ä‘oáº¡n trung bÃ¬nh**: giáº£m kháº£ nÄƒng tá»± chÄƒm sÃ³c, láº·p tá»«, máº¥t kháº£ nÄƒng giáº£i quyáº¿t váº¥n Ä‘á», láº¡c Ä‘Æ°á»ng

-   **Giai Ä‘oáº¡n náº·ng**: máº¥t kháº£ nÄƒng ngÃ´n ngá»¯, liá»‡t giÆ°á»ng, phá»¥ thuá»™c hoÃ n toÃ n, biáº¿n chá»©ng nhiá»…m trÃ¹ng, suy kiá»‡t

Thá»i gian sá»‘ng trung bÃ¬nh tá»« lÃºc cháº©n Ä‘oÃ¡n Ä‘áº¿n tá»­ vong dao Ä‘á»™ng 6â€“10 nÄƒm, phá»¥ thuá»™c thá»ƒ bá»‡nh, tuá»•i khá»Ÿi phÃ¡t, bá»‡nh kÃ¨m vÃ  chÄƒm sÃ³c xÃ£ há»™i.

### Äiá»u trá»‹ vÃ  chÄƒm sÃ³c há»— trá»£

Viá»‡c Ä‘iá»u trá»‹ sa sÃºt trÃ­ tuá»‡ hiá»‡n nay chá»§ yáº¿u mang tÃ­nh cháº¥t triá»‡u chá»©ng vÃ  há»— trá»£, vÃ¬ háº§u háº¿t cÃ¡c thá»ƒ bá»‡nh Ä‘á»u khÃ´ng cÃ³ phÆ°Æ¡ng phÃ¡p chá»¯a khá»i hoÃ n toÃ n. Má»¥c tiÃªu Ä‘iá»u trá»‹ bao gá»“m lÃ m cháº­m tiáº¿n triá»ƒn bá»‡nh, kiá»ƒm soÃ¡t triá»‡u chá»©ng hÃ nh vi, cáº£i thiá»‡n cháº¥t lÆ°á»£ng sá»‘ng vÃ  há»— trá»£ ngÆ°á»i chÄƒm sÃ³c.

#### 1. Äiá»u trá»‹ báº±ng thuá»‘c

-   **Cháº¥t á»©c cháº¿ cholinesterase** (donepezil, rivastigmine, galantamine): thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng trong sa sÃºt trÃ­ tuá»‡ do Alzheimer hoáº·c thá»ƒ Lewy. CÃ¡c thuá»‘c nÃ y giÃºp cáº£i thiá»‡n triá»‡u chá»©ng nháº­n thá»©c vÃ  hÃ nh vi á»Ÿ má»©c Ä‘á»™ nháº¹ Ä‘áº¿n trung bÃ¬nh.

-   **Memantine**: cháº¥t Ä‘á»‘i khÃ¡ng NMDA, cÃ³ thá»ƒ dÃ¹ng Ä‘Æ¡n Ä‘á»™c hoáº·c phá»‘i há»£p vá»›i thuá»‘c cholinesterase trong giai Ä‘oáº¡n trung bÃ¬nh Ä‘áº¿n náº·ng.

-   **Thuá»‘c kiá»ƒm soÃ¡t hÃ nh vi**: bao gá»“m thuá»‘c chá»‘ng loáº¡n tháº§n (risperidone, quetiapine), thuá»‘c chá»‘ng tráº§m cáº£m (SSRIs), thuá»‘c an tháº§n nháº¹, nhÆ°ng cáº§n sá»­ dá»¥ng tháº­n trá»ng vÃ¬ nguy cÆ¡ tÃ¡c dá»¥ng phá»¥ á»Ÿ ngÆ°á»i cao tuá»•i.

#### 2. Äiá»u trá»‹ khÃ´ng dÃ¹ng thuá»‘c

-   **Trá»‹ liá»‡u nháº­n thá»©c** (cognitive stimulation therapy): gá»“m cÃ¡c hoáº¡t Ä‘á»™ng nhÆ° luyá»‡n trÃ­ nhá»›, trÃ² chuyá»‡n nhÃ³m, bÃ i táº­p tÆ° duy logic.

-   **Can thiá»‡p hoáº¡t Ä‘á»™ng chá»©c nÄƒng**: há»— trá»£ bá»‡nh nhÃ¢n giá»¯ Ä‘Æ°á»£c kháº£ nÄƒng tá»± chÄƒm sÃ³c cÃ ng lÃ¢u cÃ ng tá»‘t thÃ´ng qua phá»¥c há»“i chá»©c nÄƒng, hÆ°á»›ng dáº«n ká»¹ nÄƒng sinh hoáº¡t.

-   **GiÃ¡o dá»¥c vÃ  há»— trá»£ ngÆ°á»i chÄƒm sÃ³c**: giÃºp giáº£m gÃ¡nh náº·ng tÃ¢m lÃ½ vÃ  nÃ¢ng cao hiá»‡u quáº£ chÄƒm sÃ³c dÃ i háº¡n.

#### 3. ChÄƒm sÃ³c dÃ i háº¡n

-   **Thiáº¿t káº¿ mÃ´i trÆ°á»ng an toÃ n**: trÃ¡nh nguy cÆ¡ tÃ© ngÃ£, láº¡c Ä‘Æ°á»ng; táº¡o khÃ´ng gian quen thuá»™c, yÃªn tÄ©nh, dá»… Ä‘á»‹nh hÆ°á»›ng.

-   **Há»— trá»£ dinh dÆ°á»¡ng vÃ  váº­n Ä‘á»™ng**: duy trÃ¬ thá»ƒ tráº¡ng, trÃ¡nh suy kiá»‡t vÃ  biáº¿n chá»©ng do náº±m lÃ¢u.

-   **Há»— trá»£ giai Ä‘oáº¡n cuá»‘i**: chÄƒm sÃ³c giáº£m nháº¹, Ä‘iá»u trá»‹ triá»‡u chá»©ng, chuáº©n bá»‹ tÃ¢m lÃ½ cho ngÆ°á»i thÃ¢n.

Má»—i thá»ƒ lÃ¢m sÃ ng cÃ³ thá»ƒ Ä‘Ã¡p á»©ng Ä‘iá»u trá»‹ khÃ¡c nhau. VÃ­ dá»¥, bá»‡nh nhÃ¢n thá»ƒ Lewy ráº¥t nháº¡y cáº£m vá»›i thuá»‘c chá»‘ng loáº¡n tháº§n, cáº§n trÃ¡nh dÃ¹ng haloperidol. Trong khi Ä‘Ã³, sa sÃºt trÃ­ tuá»‡ máº¡ch mÃ¡u cáº§n kiá»ƒm soÃ¡t cháº·t cÃ¡c yáº¿u tá»‘ nguy cÆ¡ tim máº¡ch Ä‘á»ƒ lÃ m cháº­m tiáº¿n triá»ƒn bá»‡nh.

### TiÃªu chuáº©n cháº©n Ä‘oÃ¡n theo DSM-5

Theo DSM-5 @DSM5, rá»‘i loáº¡n nháº­n thá»©c Ä‘Æ°á»£c chia thÃ nh:

-   **Rá»‘i loáº¡n nháº­n thá»©c nháº¹ (Mild Neurocognitive Disorder)**: cÃ³ báº±ng chá»©ng vá» suy giáº£m nháº¹ má»™t hoáº·c nhiá»u lÄ©nh vá»±c nháº­n thá»©c (qua ngÆ°á»i thÃ¢n hoáº·c test chuáº©n hÃ³a); khÃ´ng áº£nh hÆ°á»Ÿng rÃµ rá»‡t Ä‘áº¿n sinh hoáº¡t hÃ ng ngÃ y; ngÆ°á»i bá»‡nh cÃ³ thá»ƒ cáº§n ná»— lá»±c bÃ¹ trá»«.

-   **Rá»‘i loáº¡n nháº­n thá»©c náº·ng (Major Neurocognitive Disorder)**: suy giáº£m rÃµ rá»‡t, áº£nh hÆ°á»Ÿng Ä‘áº¿n sinh hoáº¡t Ä‘á»™c láº­p, cáº§n há»— trá»£ trong hoáº¡t Ä‘á»™ng hÃ ng ngÃ y.

Cháº©n Ä‘oÃ¡n cáº§n loáº¡i trá»« nguyÃªn nhÃ¢n khÃ¡c nhÆ° sáº£ng, tráº§m cáº£m náº·ng, vÃ  cáº§n xÃ¡c Ä‘á»‹nh nguyÃªn nhÃ¢n ná»n náº¿u cÃ³ thá»ƒ (Alzheimer, máº¡ch mÃ¡u, thá»ƒ há»—n há»£p...).

## Giá»›i thiá»‡u vá» bá»™ tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c

```{r}
#| label: Báº£ng cÃ¡c tráº¯c nghiá»‡m
#| message: false
#| warning: false
#| include: false
#| paged-print: false
# Dá»¯ liá»‡u báº£ng tráº¯c nghiá»‡m Ä‘Ã£ chuáº©n hÃ³a
bo_test_vnca <- tibble::tibble(
  STT = c(1, 2, 3, 3, 4, 4, 5, 5, 6, 7),
  Linh_vuc = c(
    "SÃ ng lá»c chung sa sÃºt trÃ­ tuá»‡ (Global Dementia Screening)",
    "Nhá»› tá»« (Verbal Memory)",
    rep("Tá»‘c Ä‘á»™ váº­n Ä‘á»™ng thá»‹ giÃ¡c (Visuomotor Speed)", 2),
    rep("Nhá»› tá»« (Verbal Memory)", 2),
    rep("Sá»± chÃº Ã½ (Attention)", 2),
    "NgÃ´n ngá»¯ (Language)",
    "XÃ¢y dá»±ng hÃ¬nh áº£nh qua thá»‹ giÃ¡c (Visuoconstruction)"
  ),
  Trac_nghiem = c(
    "MMSE â€“ ÄÃ¡nh giÃ¡ tráº¡ng thÃ¡i tÃ¢m tháº§n tá»‘i thiá»ƒu",
    "Nhá»› danh sÃ¡ch tá»« (Word List Recall)",
    "Trail Making Test A (TMT-A)",
    "Trail Making Test B (TMT-B)",
    "Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n (Delayed Recall)",
    "Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n (Delayed Recognition)",
    "Äá»c xuÃ´i dÃ£y sá»‘ (Digit Span Forward)",
    "Äá»c ngÆ°á»£c dÃ£y sá»‘ (Digit Span Backward)",
    "NÃ³i lÆ°u loÃ¡t tá»« vá» cÃ¡c con váº­t",
    "Váº½ Ä‘á»“ng há»“ (Clock Drawing Test)"
  ),
  Diem_BT = c(
    "â‰¥ 26/30", "â‰¥ 12/30",
    "â‰¤ 180 giÃ¢y", "â‰¤ 300 giÃ¢y",
    "â‰¥ 4/10", "â‰¥ 6/10",
    "â‰¥ 6/12", "â‰¥ 4/12",
    "â‰¥ 9", "Tá»« 1 Ä‘áº¿n 6"
  )
)

```

### Báº£ng cÃ¡c tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c trong bá»™ VNCA

```{r}
#| echo: false
# Táº¡o flextable Ä‘áº¹p, cÃ³ gá»™p dÃ²ng vÃ  fit khá»• Word
flextable(bo_test_vnca) %>%
  set_caption("Báº£ng tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c trong bá»™ VNCA") %>%
  merge_v(j = c("STT", "Linh_vuc")) %>%
  align(align = "center", part = "all") %>%
  valign(j = c("STT", "Linh_vuc"), valign = "top") %>%
  set_header_labels(
    STT = "STT",
    Linh_vuc = "LÄ©nh vá»±c",
    Trac_nghiem = "Tráº¯c nghiá»‡m",
    Diem_BT = "Äiá»ƒm BT"
  ) %>%
  set_table_properties(width = 1, layout = "autofit")
```

### MÃ´ táº£ cÃ¡c tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c trong bá»™ VNCA

-   **SÃ ng lá»c chá»©ng sa sÃºt trÃ­ tuá»‡** sá»­ dá»¥ng *Mini-Mental State Examination (MMSE)* lÃ  má»™t trong nhá»¯ng test Ä‘Æ°á»£c dÃ¹ng thÆ°á»ng xuyÃªn nháº¥t trong táº§m soÃ¡t SSTT. NÃ³ bao gá»“m cÃ¡c ná»™i dung vá» Ä‘á»‹nh hÆ°á»›ng, chÃº Ã½, trÃ­ nhá»›, ngÃ´n ngá»¯ vÃ  kÄ© nÄƒng thá»‹ giÃ¡c khÃ´ng gian. Tá»•ng Ä‘iá»ƒm Ä‘áº¡t Ä‘Æ°á»£c tá»« 0 Ä‘áº¿n 30, vá»›i Ä‘iá»ƒm cÃ ng tháº¥p cho tháº¥y cÃ ng suy giáº£m chá»©c nÄƒng nháº­n thá»©c náº·ng ná».

-   **Nhá»› tá»«** bao gá»“m danh sÃ¡ch 10 tá»« sáº½ Ä‘Æ°á»£c láº·p láº¡i cho Ä‘á»‘i tÆ°á»£ng 3 láº§n vá»›i tá»•ng Ä‘iá»ƒm lÃ  30. Ba láº§n nÃ y nháº±m kháº£o sÃ¡t láº§n lÆ°á»£t lÃ  nhá»› tá»« láº¡i ngay, nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n, nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n.

-   **Táº­p trung chÃº Ã½** bao gá»“m *Digit span* (NÃ³i láº­p láº¡i dÃ£y sá»‘), nÃ³i láº¡i xuÃ´i dÃ£y sá»‘, nháº±m kháº£o sÃ¡t sá»± chÃº Ã½ vÃ  trÃ­ nhá»› gáº§n (Ä‘iá»ƒm tá»« 0 Ä‘áº¿n 14) vÃ  nÃ³i láº¡i ngÆ°á»£c dÃ£y sá»‘, nháº±m kháº£o sÃ¡t sá»± chÃº Ã½ vÃ  trÃ­ nhá»› lÃ m viá»‡c (Ä‘iá»ƒm tá»« 0 Ä‘áº¿n 12). NgÆ°á»i kháº£o sÃ¡t sáº½ Ä‘á»c dÃ£y sá»‘ (1 sá»‘/giÃ¢y) vÃ  yÃªu cáº§u Ä‘á»‘i tÆ°á»£ng tham gia nÃ³i láº¡i.

-   **Váº­n Ä‘á»™ng thá»‹ giÃ¡c**: Bao gá»“m *Trail Making Tests A & B (TMT-A, TMT-B)* Ä‘Ã¡nh giÃ¡ sá»± tÃ¬m kiáº¿m thá»‹ giÃ¡c, dÃ² tÃ¬m, tá»‘c Ä‘á»™ xá»­ lÃ½, sá»± linh hoáº¡t tháº§n kinh vÃ  chá»©c nÄƒng Ä‘iá»u hÃ nh.\
    **TMT-A** yÃªu cáº§u Ä‘á»‘i tÆ°á»£ng váº½ Ä‘Æ°á»ng tháº³ng ná»‘i 25 con sá»‘ trong vÃ²ng trÃ²n theo thá»© tá»± trÃªn giáº¥y.\
    **TMT-B** cÃ³ yÃªu cáº§u tÆ°Æ¡ng tá»± nhÆ°ng ngÆ°á»i lÃ m pháº£i thay Ä‘á»•i giá»¯a chá»¯ vÃ  sá»‘. Äiá»ƒm Ä‘Æ°á»£c cho theo thá»i gian hoÃ n thÃ nh test, vá»›i giá»›i háº¡n bÃ¬nh thÆ°á»ng dÆ°á»›i 150 giÃ¢y cho test TMT-A vÃ  300 giÃ¢y cho test TMT-B.

-   **NgÃ´n ngá»¯**: *NÃ³i lÆ°u loÃ¡t tá»« vá» con váº­t* kháº£o sÃ¡t sá»± lÆ°u loÃ¡t ngÃ´n ngá»¯, cá»¥ thá»ƒ lÃ  Ä‘Æ°a ra lá»i nÃ³i, trÃ­ nhá»› ngá»¯ nghÄ©a vÃ  ngÃ´n ngá»¯. Äá»‘i tÆ°á»£ng pháº£i nÃ³i ra nhiá»u tÃªn con váº­t khÃ¡c nhau nháº¥t cÃ³ thá»ƒ trong 60 giÃ¢y. Äiá»ƒm Ä‘Æ°á»£c cho theo má»—i con váº­t nÃªu ra, Ä‘iá»ƒm cÃ ng cao cho tháº¥y chá»©c nÄƒng ngÃ´n ngá»¯ cÃ ng tá»‘t.

-   **Thá»‹ giÃ¡c khÃ´ng gian**: *Tráº¯c nghiá»‡m váº½ Ä‘á»“ng há»“* Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ kháº£o sÃ¡t kháº£ nÄƒng xÃ¢y dá»±ng hÃ¬nh áº£nh qua thá»‹ giÃ¡c. NgÆ°á»i lÃ m Ä‘Æ°á»£c cung cáº¥p má»™t tá» giáº¥y tráº¯ng vÃ  yÃªu cáº§u váº½ trÃªn Ä‘Ã³ má»™t Ä‘á»“ng há»“, cÃ³ Ä‘áº§y Ä‘á»§ cÃ¡c sá»‘ giá» vÃ  váº½ kim Ä‘á»“ng há»“ chá»‰ 11 giá» 10 phÃºt. Káº¿t quáº£ Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ tá»« 1 Ä‘áº¿n 6 Ä‘iá»ƒm theo thang **Shulman**.\
    Tráº¯c nghiá»‡m váº½ Ä‘á»“ng há»“ giÃ¡n tiáº¿p Ä‘Ã¡nh giÃ¡ sá»± chÃº Ã½ phá»©c táº¡p, chá»©c nÄƒng Ä‘iá»u hÃ nh, há»c táº­p vÃ  trÃ­ nhá»›, chá»©c nÄƒng ngÃ´n ngá»¯, giÃ¡c quan váº­n Ä‘á»™ng vÃ  nháº­n thá»©c xÃ£ há»™i â€” vá»‘n lÃ  nhá»¯ng lÄ©nh vá»±c nháº­n thá»©c giÃºp Ä‘Ã¡nh giÃ¡ tá»•ng thá»ƒ.

### CÃ¡c nghiÃªn cá»©u trong vÃ  ngoÃ i nÆ°á»›c

### Má»‘i tÆ°Æ¡ng quan giá»¯a MMSE vÃ  bÃ i Nhá»› tá»« (Words List Recall)

BÃ i **nhá»› tá»«** (gá»“m nhá»› láº¡i ngay, trÃ¬ hoÃ£n vÃ  nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n) pháº£n Ã¡nh trÃ­ nhá»› gáº§n vÃ  trÃ­ nhá»› dÃ i háº¡n â€“ cÃ¡c lÄ©nh vá»±c bá»‹ áº£nh hÆ°á»Ÿng sá»›m trong sa sÃºt trÃ­ tuá»‡.

Táº¡i Viá»‡t Nam, Nguyá»…n Thá»‹ Háº¡nh vÃ  cá»™ng sá»± cho tháº¥y MMSE cÃ³ tÆ°Æ¡ng quan trung bÃ¬nh vá»›i **nhá»› tá»« trÃ¬ hoÃ£n** (r = 0,59) vÃ  yáº¿u hÆ¡n vá»›i **nhá»› láº¡i ngay** (r = 0,42) @nguyen2020mmse.\
Tráº§n Há»“ng QuÃ¢n vÃ  Ä‘á»“ng nghiá»‡p cÅ©ng ghi nháº­n ráº±ng ngÆ°á»i cÃ³ MMSE tháº¥p thÆ°á»ng chá»‰ nhá»› Ä‘Æ°á»£c dÆ°á»›i 5 tá»« sau 10 phÃºt trÃ¬ hoÃ£n, pháº£n Ã¡nh suy giáº£m trÃ­ nhá»› dÃ i háº¡n rÃµ rá»‡t @tran2021tri_nho. Nhiá»u nghiÃªn cá»©u quá»‘c táº¿ cÅ©ng kháº³ng Ä‘á»‹nh má»‘i liÃªn há»‡ nÃ y: - NghiÃªn cá»©u cá»§a Ivnik vÃ  cá»™ng sá»± (1990) ghi nháº­n MMSE tÆ°Æ¡ng quan cao vá»›i **delayed recall** (r â‰ˆ 0,60) trong bá»™ AVLT @ivnik1990avlt. - Welsh et al. (1994) cho tháº¥y bÃ i **CERAD word list recall** cÃ³ thá»ƒ dá»± Ä‘oÃ¡n tá»‘t má»©c Ä‘á»™ suy giáº£m MMSE á»Ÿ bá»‡nh nhÃ¢n Alzheimer nháº¹ (r â‰ˆ 0,68) @welsh1994cerad. - Sarazin vÃ  cá»™ng sá»± (2007) nháº­n tháº¥y ráº±ng giáº£m Ä‘iá»ƒm word list recall lÃ  chá»‰ dáº¥u sá»›m cá»§a Alzheimer vÃ  cÃ³ má»‘i tÆ°Æ¡ng quan máº¡nh vá»›i MMSE trong suá»‘t quÃ¡ trÃ¬nh tiáº¿n triá»ƒn bá»‡nh @sarazin2007amnestic.

Nhá»¯ng káº¿t quáº£ nÃ y cá»§ng cá»‘ giÃ¡ trá»‹ cá»§a bÃ i **nhá»› tá»« trÃ¬ hoÃ£n** nhÆ° má»™t chá»‰ bÃ¡o nháº­n thá»©c nháº¡y trong sÃ ng lá»c sa sÃºt trÃ­ tuá»‡ vÃ  cho tháº¥y sá»± Ä‘á»“ng thuáº­n giá»¯a MMSE vá»›i cÃ¡c bÃ i kiá»ƒm tra trÃ­ nhá»› chuyÃªn sÃ¢u.

# Äá»I TÆ¯á»¢NG VÃ€ PHÆ¯Æ NG PHÃP NGHIÃŠN Cá»¨U

## DÃ¢n sá»‘ má»¥c tiÃªu:

Bá»‡nh nhÃ¢n sa sÃºt trÃ­ tuá»‡ trong bá»‘i cáº£nh ngoáº¡i trÃº á»Ÿ cÃ¡c khoa â€“ phÃ²ng khÃ¡m lÃ¢m sÃ ng chuyÃªn vá» trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡.

## DÃ¢n sá»‘ chá»n máº«u:

Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m vÃ  Ä‘iá»u trá»‹ táº¡i phÃ²ng khÃ¡m thuá»™c ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡, bá»‡nh viá»‡n 30-4.

### Cá»¡ máº«u:

Cá»¡ máº«u tá»‘i thiá»ƒu cho nghiÃªn cá»©u Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh theo cÃ´ng thá»©c Æ°á»›c lÆ°á»£ng má»™t tá»· lá»‡:

$$
  n = \frac{Z_{(1 - \alpha/2)}^2 \cdot p(1 - p)}{\varepsilon^2}
$$

Trong Ä‘Ã³:

-   $n$: cá»¡ máº«u cáº§n thiáº¿t
-   $\alpha$: má»©c Ã½ nghÄ©a thá»‘ng kÃª, chá»n $\alpha = 0.05$
-   $Z_{(1 - \alpha/2)} = 1.96$: giÃ¡ trá»‹ Z tÆ°Æ¡ng á»©ng vá»›i má»©c tin cáº­y 95%
-   $p$: tá»· lá»‡ Ä‘iá»u trá»‹ hiá»‡u quáº£. Theo nghiÃªn cá»©u cá»§a Schroeder RW, tá»· lá»‡ tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c phÃ¡t hiá»‡n bá»‡nh nhÃ¢n sa sÃºt trÃ­ tuá»‡ lÃ  **75%**, nÃªn chá»n $p = 0.75$
-   $\varepsilon = 0.05$: sai sá»‘ cháº¥p nháº­n trong nghiÃªn cá»©u

Thay vÃ o cÃ´ng thá»©c:

$$
  n = \frac{(1.96)^2 \cdot 0.75 \cdot (1 - 0.75)}{(0.05)^2} = \frac{3.8416 \cdot 0.1875}{0.0025} = \frac{0.7203}{0.0025} \approx 288.12
$$

**â†’ Cá»¡ máº«u cáº§n thiáº¿t lÃ  Ã­t nháº¥t 288 bá»‡nh nhÃ¢n.**

### Ká»¹ thuáº­t chá»n máº«u:

Äá»‘i vá»›i há»“i cá»©u: PhÆ°Æ¡ng phÃ¡p chá»n máº«u Ä‘Æ°á»£c sá»­ dá»¥ng lÃ  phÆ°Æ¡ng phÃ¡p chá»n máº«u dá»±a vÃ o danh sÃ¡ch bá»‡nh nhÃ¢n Ä‘ang Ä‘iá»u trá»‹ táº¡i khoa, Ä‘á»‘i chiáº¿u cÃ¡c tiÃªu chuáº©n chá»n vÃ o vÃ  tiÃªu chuáº©n loáº¡i trá»« vá»›i há»“ sÆ¡ bá»‡nh Ã¡n cÃ³ sáºµn. Sau Ä‘Ã³, trong sá»‘ nhá»¯ng bá»‡nh nhÃ¢n hoÃ n toÃ n phÃ¹ há»£p vá»›i tiÃªu chuáº©n chá»n vÃ o vÃ  khÃ´ng cÃ³ báº¥t ká»³ tiÃªu chuáº©n loáº¡i trá»« nÃ o sáº½ Ä‘Æ°á»£c chá»n.

Äá»‘i vá»›i tiáº¿n cá»©u, nhá»¯ng bá»‡nh nhÃ¢n Ä‘Æ°á»£c chá»n lá»±a sáº½ Ä‘Æ°á»£c tiáº¿n hÃ nh xin Ä‘á»“ng thuáº­n tham gia nghiÃªn cá»©u vÃ  thu tháº­p sá»‘ liá»‡u vÃ o ngÃ y khÃ¡m bá»‡nh káº¿ tiáº¿p gáº§n nháº¥t.

## CÃ¡c biáº¿n sá»‘ nghiÃªn cá»©u

```{r}
#| include: false
data <- data.frame(
  Ten_bien = c(
    "Tuá»•i", "Giá»›i tÃ­nh", "Tuá»•i khá»Ÿi phÃ¡t", "Thá»i gian phÃ¡t hiá»‡n bá»‡nh", 
    "TrÃ¬nh Ä‘á»™ há»c váº¥n", "Nghá» nghiá»‡p trÆ°á»›c Ä‘Ã¢y", "TÃ¬nh tráº¡ng hÃ´n nhÃ¢n", 
    "Tiá»n sá»­ gia Ä‘Ã¬nh", "Bá»‡nh Ä‘i kÃ¨m", "Thang MMSE", "Tiá»ƒu thang MMSE",
    "Word List", "Digit span forward", "Digit span backward",
    "TMT-A", "TMT-B", "Kháº£o sÃ¡t sá»± lÆ°u loÃ¡t ngÃ´n ngá»¯.",
    "Tráº¯c nghiá»‡m váº½ Ä‘á»“ng há»“", "Cháº©n Ä‘oÃ¡n", "Giai Ä‘oáº¡n"
  ),
  Loai_bien = c(
    "Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng", 
    "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", 
    "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", 
    "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh lÆ°á»£ng", "Äá»‹nh tÃ­nh", "Äá»‹nh tÃ­nh"
  ),
  Gia_tri_don_vi = c(
    "NÄƒm", "Nam/Ná»¯", "Khá»Ÿi phÃ¡t sá»›m/khá»Ÿi phÃ¡t muá»™n", "NÄƒm",
    "Cáº¥p 1, cáº¥p 2, cáº¥p 3, cao Ä‘áº³ng/Ä‘áº¡i há»c, khÃ´ng xÃ¡c Ä‘á»‹nh", 
    "ToÃ n thá»i gian, bÃ¡n thá»i gian, vá» hÆ°u", 
    "CÃ³ chá»“ng vá»£, gÃ³a, ly thÃ¢n/ly hÃ´n", "CÃ³ bá»‹ SSTT", "CÃ³, khÃ´ng", 
    "GiÃ¡ trá»‹ tá»« 0 - 30", "TÃ¹y thuá»™c chá»©c nÄƒng nháº­n thá»©c", 
    "GiÃ¡ trá»‹ tá»« 0 â€“ 30", "GiÃ¡ trá»‹ tá»« 0 â€“ 14", "GiÃ¡ trá»‹ tá»« 0 â€“ 12", 
    "Thá»i gian Ä‘áº¡t khi dÆ°á»›i 150 giÃ¢y", "Thá»i gian Ä‘áº¡t khi dÆ°á»›i 300 giÃ¢y", 
    "Sá»‘ lÆ°á»£ng cÃ¡c con váº­t ngÆ°á»i lÃ m tráº¯c nghiá»‡m ká»ƒ tÃªn", 
    "1 Ä‘áº¿n 6 Ä‘iá»ƒm theo thang Shulman", "SCI, MCI vÃ  SSTT", 
    "Giai Ä‘oáº¡n nháº¹, trung bÃ¬nh, náº·ng"
  )
)

```

```{r}
#| echo: false

ft <- data %>%
  flextable() %>%
  set_header_labels(
    Ten_bien = "TÃªn biáº¿n",
    Loai_bien = "Loáº¡i biáº¿n",
    Gia_tri_don_vi = "GiÃ¡ trá»‹ / ÄÆ¡n vá»‹"
  ) %>%
  autofit() %>%
  set_table_properties(width = 1, layout = "autofit") %>%
  font(fontname = "Times New Roman", part = "all")  %>%
  fontsize(size = 13, part = "all")

ft

```

### PhÆ°Æ¡ng phÃ¡p tiáº¿n hÃ nh.

Bá»‡nh nhÃ¢n tá»›i khÃ¡m táº¡i ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Æ°á»£c BÃ¡c sÄ© tháº§n kinh chá»‰ Ä‘á»‹nh lÃ m tráº¯c nghiá»‡m tháº§n kinh nháº­n thá»©c bá»Ÿi cÃ¡c nhÃ¢n viÃªn Y táº¿ Ä‘Æ°á»£c huáº¥n luyá»‡n theo quy trÃ¬nh thá»±c hiá»‡n bá»™ test chuáº©n. - PhÆ°Æ¡ng phÃ¡p há»“i cá»©u. Tra cá»©u há»“ sÆ¡ bá»‡nh Ã¡n táº¥t cáº£ nhá»¯ng bá»‡nh nhÃ¢n Ä‘Æ°á»£c khÃ¡m táº¡i Ä‘Æ¡n vá»‹ tá»« 4/2019 tá»›i thá»i Ä‘iá»ƒm nghiÃªn cá»©u. ÄÃ¡nh giÃ¡ láº¡i bá»™ test náº¿u bá»‡nh nhÃ¢n tÃ¡i khÃ¡m trong thá»i gian nghiÃªn cá»©u. - PhÆ°Æ¡ng phÃ¡p tiáº¿n cá»©u. Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m trong thá»i gian nghiÃªn cá»©u Ä‘Æ°á»£c thÄƒm khÃ¡m, lÃ m test, cháº©n Ä‘oÃ¡n vÃ  Ä‘Ã¡nh giÃ¡ má»©c Ä‘á»™ sa sÃºt trÃ­ tuá»‡ tÃªn lÃ¢m sÃ ng. NghiÃªn cá»©u Ä‘Ã¡nh giÃ¡ ÄÃ¡nh giÃ¡ má»‘i tÆ°Æ¡ng quan giá»¯a MSSE vÃ  cÃ¡c test khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c khÃ¡c, tá»· lá»‡ hoÃ n thÃ nh Test tháº§n kinh nháº­n thá»©c Ä‘á»‘i vá»›i suy giáº£m nháº­n thá»©c nháº¹ vÃ  Sa sÃºt trÃ­ tuá»‡. ÄÃ¡nh giÃ¡ má»‘i tÆ°Æ¡ng quan phÃ¢n Ä‘á»™ sa sÃºt trÃ­ tuá»‡ á»Ÿ thang Ä‘iá»ƒm MMSE vÃ  phÃ¢n Ä‘á»™ sa sÃºt trÃ­ tuá»‡ trÃªn lÃ¢m sÃ ng.

## PhÆ°Æ¡ng phÃ¡p vÃ  cÃ´ng cá»¥ Ä‘o lÆ°á»ng, thu tháº­p sá»‘ liá»‡u

-   Nháº­p liá»‡u vÃ  quáº£n lÃ½ dá»¯ liá»‡u báº±ng pháº§n má»m SPSS 20, xá»­ lÃ½ sá»‘ liá»‡u báº±ng pháº§n má»m R 4.2.3 (Packages sá»­ dá»¥ng trong nghiÃªn cá»©u: table1, dplyr, ggplot2, boot, simpleboot, afex.)
-   MÃ´ táº£ cÃ¡c biáº¿n Ä‘á»‹nh lÆ°á»£ng: báº±ng trung bÃ¬nh, Ä‘á»™ lá»‡ch chuáº©n, giÃ¡ trá»‹ nhá» nháº¥t, giÃ¡ trá»‹ lá»›n nháº¥t (phÃ¢n bá»‘ chuáº©n), hoáº·c trung vá»‹ vÃ  tá»© phÃ¢n vá»‹ (khÃ´ng phÃ¢n phá»‘i chuáº©n), sá»­ dá»¥ng bootstrap 10.000 lÆ°á»£t Ä‘á»ƒ tÃ­nh khoáº£ng tin cáº­y 95%.
-   MÃ´ táº£ cÃ¡c biáº¿n Ä‘á»‹nh tÃ­nh: báº±ng táº§n sá»‘ vÃ  tá»· lá»‡ pháº§n trÄƒm.
-   So sÃ¡nh giÃ¡ trá»‹ trung bÃ¬nh á»Ÿ cÃ¡c nhÃ³m dÃ¹ng kiá»ƒm Ä‘á»‹nh Independent Sample t-test..
-   So sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c tá»· lá»‡ vá»›i cÃ¡c biáº¿n Ä‘á»‹nh tÃ­nh dÃ¹ng kiá»ƒm Ä‘á»‹nh Chi bÃ¬nh phÆ°Æ¡ng (Ï‡2), hoáº·c kiá»ƒm Ä‘á»‹nh Fisher's Exact.
-   ÄÃ¡nh giÃ¡ má»‘i liÃªn quan cÃ¡c giá»¯a biáº¿n Ä‘á»‹nh lÆ°á»£ng: MMSE cÃ¡c tráº¯c nghiá»‡m khÃ¡c, sá»­ dá»¥ng há»‡ sá»‘ tÆ°Æ¡ng quan Pearson (phÃ¢n bá»‘ chuáº©n), hoáº·c sá»­ dá»¥ng há»‡ sá»‘ tÆ°Æ¡ng quan Spearman (khÃ´ng phÃ¢n phá»‘i chuáº©n). Há»‡ sá»‘ tÆ°Æ¡ng quan (r) Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ nhÆ° sau: â€¢ \|r\| â‰¥ 0, 7: TÆ°Æ¡ng quan cháº·t â€¢ \|r\| = 0, 5- 0,7: TÆ°Æ¡ng quan khÃ¡ cháº·t â€¢ \|r\| â‰¥ 0, 3 â€“ 0,5: TÆ°Æ¡ng quan vá»«a â€¢ \|r\| \< 0,3: TÆ°Æ¡ng quan yáº¿u â€¢ \|r\| =0 KhÃ´ng tÆ°Æ¡ng quan
-   ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ hoÃ n thÃ nh lÃ m Test tháº§n kinh nháº­n thá»©c báº±ng táº§n sá»‘ vÃ  tá»· lá»‡ pháº§n trÄƒm.
-   ÄÃ¡nh giÃ¡ má»‘i liÃªn quan cÃ¡c giá»¯a phÃ¢n loáº¡i bá»‡nh theo MMSE vÃ  phÃ¢n loáº¡i bá»‡nh trÃªn lÃ¢m sÃ ng dÃ¹ng kiá»ƒm Ä‘á»‹nh Chi bÃ¬nh phÆ°Æ¡ng (Ï‡2), hoáº·c kiá»ƒm Ä‘á»‹nh Fisher's Exact. Äáº¡o Ä‘á»©c nghiÃªn cá»©u
-   NghiÃªn cá»©u Ä‘Æ°á»£c thÃ´ng qua há»™i Ä‘á»“ng Äáº¡o Ä‘á»©c Ä‘á»‘i vá»›i nghiÃªn cá»©u Y sinh.
-   ÄÃ¢y lÃ  nghiÃªn cá»©u quan sÃ¡t, khÃ´ng can thiá»‡p vÃ o quÃ¡ trÃ¬nh Ä‘iá»u trá»‹ bá»‡nh nhÃ¢n, cÃ¡c hoáº¡t Ä‘á»™ng cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ hoÃ n toÃ n tuÃ¢n theo phÃ¡c Ä‘á»“ cá»§a Bá»‡nh viá»‡n.
-   Má»i thÃ´ng tin liÃªn quan Ä‘áº¿n bá»‡nh nhÃ¢n sáº½ Ä‘Æ°á»£c báº£o máº­t. TÃ¡c giáº£ nghiÃªn cá»©u tuÃ¢n thá»§ quy trÃ¬nh nghiÃªn cá»©u

### Äáº¡o Ä‘á»©c trong nghiÃªn cá»©u

# Káº¾T QUáº¢ NGHIÃŠN Cá»¨U

CÃ³ **`r nrow(df)`** ngÆ°á»i Ä‘Æ°á»£c tuyá»ƒn chá»n vÃ o máº«u nghiÃªn cá»©u. ToÃ n bá»™ ngÆ°á»i tham gia nghiÃªn cá»©u thá»a Ä‘áº§y Ä‘á»§ cÃ¡c tiÃªu chuáº©n chá»n máº«u vÃ  khÃ´ng cÃ³ báº¥t cá»© tiÃªu chuáº©n loáº¡i trá»« nÃ o. Äá»‘i vá»›i trÆ°á»ng há»£p há»“i cá»©u, chÃºng tÃ´i truy suáº¥t há»“ sÆ¡ bá»‡nh Ã¡n. Äá»‘i vá»›i tiáº¿n cá»©u sau khi Ä‘Æ°á»£c cung cáº¥p thÃ´ng tin vá» nghiÃªn cá»©u vÃ  cÃ³ sá»± Ä‘á»“ng thuáº­n tham gia cá»§a ngÆ°á»i cÃ³ quyá»n giÃ¡m há»™ bá»‡nh nhÃ¢n, ngÆ°á»i tham gia nghiÃªn cá»©u chÃºng tÃ´i ghi nháº­n thÃ´ng tin trÃªn há»“ sÆ¡ bá»‡nh Ã¡n Ä‘á»ƒ tiáº¿n hÃ nh thu tháº­p dá»¯ liá»‡u. Káº¿t quáº£ nghiÃªn cá»©u trÃ¬nh bÃ y nhÆ° sau: [Äáº·c Ä‘iá»ƒm máº«u cá»§a nghiÃªn cá»©u,](#dac-diem-kq) [má»‘i tÆ°Æ¡ng quan MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c,](#tuong-quan-kq) [Ä‘Ã¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test tháº§n kinh nháº­n thá»©c](#ung-dung-kq)

## Äáº·c Ä‘iá»ƒm máº«u cá»§a nghiÃªn cá»©u {#dac-diem-kq}

### Äáº·c Ä‘iá»ƒm theo tuá»•i nhÃ  nhÃ³m tuÃ´i

#### Äáº·c Ä‘iá»ƒm theo tuá»•i

-   Báº£ng thá»‘ng kÃª tuá»•i bá»‡nh nhÃ¢n.

```{r}
#| echo: false
ft_tuoi
```

##### `r inline_bang_tuoi_ketqua`

-   Biá»ƒu Ä‘á»“ theo tuá»•i

```{r}
#| echo: false
tuoi_gp
```

##### `r inline_bieudo_tuoi_ketqua`

#### Äáº·c Ä‘iá»ƒm nhÃ³m tuá»•i

-   Báº£ng nhÃ³m tuá»•i

```{r tbl-nhom_tuoi_ketqua-flextable, echo=FALSE, results='asis'}
#| message: false
#| warning: false
#| paged-print: false
ft_freq_p
```

##### `r inline_bang_nhom_tuoi_ketqua`

-   Biá»ƒu Ä‘á»“ theo nhÃ³m tuá»•i

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
nhom_tuoi_gp
```

##### `r inline_bieudo_nhom_tuoi_ketqua`

### Giá»›i tÃ­nh

-   Báº£ng theo giá»›i tÃ­nh

```{r tbl-gioi_tinh_ketqua-flextable, echo=FALSE, results='asis'}
ft_gender
```

##### `r inline_bang_gioitinh_ketqua`

-   Biá»ƒu Ä‘á»“ theo giá»›i tÃ­nh

```{r}
#| echo: false
#| message: false
#| warning: false
#| paged-print: false
gioitinh_bar_percent
```

##### `r inline_bang_gioitinh_ketqua`

### TrÃ¬nh Ä‘á»™ há»c váº¥n

-   Báº£ng trÃ¬nh Ä‘á»™ há»c váº¥n

```{r results='asis'}
#| echo: false
ft_edu
```

##### `r inline_table_hocvan`

-   Biá»ƒu Ä‘á»“ trÃ¬nh Ä‘á»™ há»c váº¥n

```{r}
hocvan_bar_percent
```

##### `r inline_plot_hocvan`

### Äáº·c Ä‘iá»ƒm MMSE

#### Báº£ng phÃ¢n loáº¡i suy giáº£m nháº­n thá»©c vÃ  sa sÃºt trÃ­ tuá»‡ theo MMSE

```{r}
#| echo: false
ft_mmse

```

##### `r inline_bang_mmse`

#### Biá»ƒu Ä‘á»“ phÃ¢n loáº¡i mmse

```{r}
#| echo: false
ggplot_mmse

```

##### `r inline_bieudo_mmse`

#### Biá»ƒu Ä‘á»“ phÃ¢n loáº¡i suy giáº£m nháº­n thá»©c vÃ  sa sÃºt trÃ­ tuá»‡ theo MMSE

```{r}
#| label: Biá»ƒu Ä‘á»“  phÃ¢n loáº¡i suy giáº£m nháº­n thá»©c vÃ  sa sÃºt trÃ­ tuá»‡ theo MMSE chen káº¿t quáº£ 
#| echo: false
ggplot_mmse
```

### Äáº·c Ä‘iá»ƒm cÃ¡c test tháº§n kinh nháº­n thá»©c

#### Báº£ng Ä‘áº·c Ä‘iá»ƒm cÃ¡c test tháº§n kinh nháº­n thá»©c

```{r}
#| echo: false
ft_nhanthuc_group
```

##### `r inline_bang_tests_group`

#### Biá»ƒu Ä‘á»“ Ä‘áº·c Ä‘iá»ƒm cÃ¡c test tháº§n kinh nháº­n thá»©c

```{r}
#| echo: false
plot_nhanthuc_group
```

##### `r inline_bieudo_tests_group`

## Má»‘i tÆ°Æ¡ng quan MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c {#tuong-quan-kq}

### Báº£ng má»‘i tÆ°Æ¡ng quan MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c

```{r}
#| echo: false
ft_corr_long
```

##### **NhÃ³m MCI**: `r cau_bang_mci` , `r cau_bang_sstt`

### Biá»ƒu Ä‘á»“ má»‘i tÆ°Æ¡ng quan MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c

```{r}
#| echo: false
plot_corr_grouped
```

##### `r cau_inline_so_sanh_sstt_mci`

## ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test tháº§n kinh nháº­n thá»©c {#ung-dung-kq}

### ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c

#### Báº£ng má»©c Ä‘á»™ hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c

```{r}
#| label: B má»©c Ä‘á»™ hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c
#| echo: false
ft_hoanthanh
```

##### `r cau_hoanthanh_bang`

```{r}
#| label: BD hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c
#| echo: false
plot_hoanthanh
```

##### `r cau_hoanthanh_ggplot`

#### Biá»ƒu Ä‘á»“ má»©c Ä‘á»™ hoÃ n thÃ nh bá»™ test tháº§n kinh nháº­n thá»©c

Äáº·c Ä‘iá»ƒm hiá»‡u quáº£ á»©ng dá»¥ng

### ÄÃ¡nh giÃ¡ sá»± tÆ°Æ¡ng Ä‘á»“ng giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng theo tiÃªu chuáº©n lÃ¢m sÃ ng

#### Biá»ƒu Ä‘á»“ heatmap

```{r}
#| label: Biá»ƒu Ä‘á»“ heatmap
#| message: false
#| warning: false
#| include: false
plot_heat
```

##### `r cau_chen_bieu_do_heatmap`

#### Biá»ƒu Ä‘á»“ tÃ¡n xáº¡ Ä‘Ã¡nh giÃ¡ sá»± tÆ°Æ¡ng Ä‘á»“ng giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng theo tiÃªu chuáº©n lÃ¢m sÃ ng

```{r}
#| label: Sá»± tÆ°Æ¡ng Ä‘á»“ng giá»¯a phÃ¢n Ä‘á»™ MMSE vÃ  phÃ¢n loáº¡i lÃ¢m sÃ ng theo tiÃªu chuáº©n lÃ¢m sÃ ng káº¿t quáº£
#| echo: false
plot_scatter
```

##### `r cau_bieudo_ordinal`

# BÃ€N LUáº¬N

## Äáº·c Ä‘iá»ƒm máº«u cá»§a nghiÃªn cá»©u

### Äáº·c Ä‘iá»ƒm theo Tuá»•i

::: {custom-style="chu_xanh"}
`r inline_tuoi_banluan`
:::

Káº¿t quáº£ nghiÃªn cá»©u cho cho tháº¥y tuá»•i lÃ  má»™t yáº¿u tá»‘ liÃªn quan rÃµ rá»‡t Ä‘áº¿n má»©c Ä‘á»™ suy giáº£m chá»©c nÄƒng nháº­n thá»©c.

PhÃ¡t hiá»‡n nÃ y phÃ¹ há»£p vá»›i nhiá»u nghiÃªn cá»©u trÆ°á»›c Ä‘Ã¢y. Theo dá»¯ liá»‡u tá»« Tá»• chá»©c Y táº¿ Tháº¿ giá»›i (WHO), tuá»•i cao lÃ  yáº¿u tá»‘ nguy cÆ¡ lá»›n nháº¥t dáº«n Ä‘áº¿n sa sÃºt trÃ­ tuá»‡, vá»›i tá»· lá»‡ hiá»‡n máº¯c tÄƒng máº¡nh á»Ÿ nhÃ³m ngÆ°á»i trÃªn 65 tuá»•i. Cá»¥ thá»ƒ, tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ tÄƒng gáº¥p Ä‘Ã´i sau má»—i 5 nÄƒm tuá»•i sau má»‘c 65 tuá»•i @who2021dementia.

TÆ°Æ¡ng tá»±, nghiÃªn cá»©u cá»§a Prince vÃ  cá»™ng sá»± (2015) thuá»™c bÃ¡o cÃ¡o World Alzheimer Report cÅ©ng chá»‰ ra ráº±ng nguy cÆ¡ máº¯c sa sÃºt trÃ­ tuá»‡ gia tÄƒng theo tuá»•i, Ä‘áº·c biá»‡t rÃµ rÃ ng tá»« 60 tuá»•i trá»Ÿ lÃªn. Äiá»u nÃ y kháº³ng Ä‘á»‹nh ráº±ng tuá»•i Ä‘Ã³ng vai trÃ² trung tÃ¢m trong sinh bá»‡nh há»c cá»§a sa sÃºt trÃ­ tuá»‡ @prince2015world.

Viá»‡c nhÃ³m sa sÃºt trÃ­ tuá»‡ cÃ³ Ä‘á»™ tuá»•i trung bÃ¬nh cao hÆ¡n cÅ©ng pháº£n Ã¡nh xu hÆ°á»›ng bá»‡nh lÃ½ tiáº¿n triá»ƒn tá»« giai Ä‘oáº¡n suy giáº£m nháº­n thá»©c nháº¹ sang giai Ä‘oáº¡n náº·ng hÆ¡n. ÄÃ¢y lÃ  cÆ¡ sá»Ÿ quan trá»ng cho viá»‡c sÃ ng lá»c vÃ  can thiá»‡p sá»›m á»Ÿ ngÆ°á»i cao tuá»•i, tá»« Ä‘Ã³ cÃ³ thá»ƒ lÃ m cháº­m quÃ¡ trÃ¬nh tiáº¿n triá»ƒn bá»‡nh vÃ  giáº£m gÃ¡nh náº·ng xÃ£ há»™i.

::: {custom-style="chu_xanh"}
`r inline_nhom_tuoi_banluan`
:::

Xu hÆ°á»›ng nÃ y pháº£n Ã¡nh má»‘i liÃªn quan cháº·t cháº½ giá»¯a tuá»•i cao vÃ  má»©c Ä‘á»™ tiáº¿n triá»ƒn cá»§a suy giáº£m nháº­n thá»©c. Khi tuá»•i tÄƒng, nguy cÆ¡ chuyá»ƒn tá»« giai Ä‘oáº¡n suy giáº£m nháº­n thá»©c nháº¹ sang sa sÃºt trÃ­ tuá»‡ cÅ©ng tÄƒng theo. Petersen vÃ  cá»™ng sá»± (2018) Ä‘Ã£ chá»‰ ra ráº±ng má»—i nÄƒm cÃ³ khoáº£ng 10â€“15% bá»‡nh nhÃ¢n MCI chuyá»ƒn sang giai Ä‘oáº¡n sa sÃºt trÃ­ tuá»‡, vÃ  tá»· lá»‡ nÃ y gia tÄƒng á»Ÿ ngÆ°á»i lá»›n tuá»•i @petersen2018mci.

NgoÃ i ra, Tá»• chá»©c Y táº¿ Tháº¿ giá»›i (World Health Organization, 2021) nháº¥n máº¡nh ráº±ng tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ tÄƒng gáº¥p Ä‘Ã´i sau má»—i 5 nÄƒm tuá»•i sau má»‘c 65 tuá»•i. Äiá»u nÃ y hoÃ n toÃ n phÃ¹ há»£p vá»›i káº¿t quáº£ nghiÃªn cá»©u nÃ y, khi tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ tÄƒng tá»« 67,8% á»Ÿ nhÃ³m 50â€“59 tuá»•i lÃªn Ä‘áº¿n 100% á»Ÿ nhÃ³m â‰¥80 tuá»•i @who2021dementia.

PhÃ¡t hiá»‡n nÃ y cho tháº¥y táº§m quan trá»ng cá»§a viá»‡c sÃ ng lá»c nháº­n thá»©c á»Ÿ nhá»¯ng nhÃ³m tuá»•i sá»›m hÆ¡n (tá»« 50 tuá»•i trá»Ÿ Ä‘i), nháº±m phÃ¡t hiá»‡n cÃ¡c biá»ƒu hiá»‡n ban Ä‘áº§u cá»§a rá»‘i loáº¡n nháº­n thá»©c vÃ  can thiá»‡p ká»‹p thá»i Ä‘á»ƒ lÃ m cháº­m quÃ¡ trÃ¬nh tiáº¿n triá»ƒn. Äá»“ng thá»i, viá»‡c táº­p trung chÄƒm sÃ³c vÃ  quáº£n lÃ½ bá»‡nh lÃ½ sa sÃºt trÃ­ tuá»‡ á»Ÿ ngÆ°á»i cao tuá»•i, Ä‘áº·c biá»‡t tá»« 70 tuá»•i trá»Ÿ lÃªn, lÃ  vÃ´ cÃ¹ng cáº¥p thiáº¿t trong bá»‘i cáº£nh dÃ¢n sá»‘ giÃ  hÃ³a nhanh chÃ³ng.

### Äáº·c Ä‘iá»ƒm theo giá»›i tÃ­nh

::: {custom-style="chu_xanh"}
`r inline_bang_gioitinh_banluan`
:::

Káº¿t quáº£ nghiÃªn cá»©u cho tháº¥y tá»· lá»‡ ná»¯ giá»›i chiáº¿m Æ°u tháº¿ á»Ÿ cáº£ hai nhÃ³m rá»‘i loáº¡n nháº­n thá»©c. Trong nhÃ³m suy giáº£m nháº­n thá»©c nháº¹, ná»¯ giá»›i chiáº¿m 69,4%, trong khi nam giá»›i chá»‰ chiáº¿m 30,6%. á» nhÃ³m sa sÃºt trÃ­ tuá»‡, ná»¯ giá»›i chiáº¿m 60,1%, nam lÃ  39,9%. \## BÃ n luáº­n vá» tuá»•i tÃ¡c

Tuá»•i tÃ¡c lÃ  má»™t yáº¿u tá»‘ nguy cÆ¡ khÃ´ng thá»ƒ thay Ä‘á»•i trong sa sÃºt trÃ­ tuá»‡. Trong nghiÃªn cá»©u hiá»‡n táº¡i, tuá»•i trung bÃ¬nh cá»§a nhÃ³m sa sÃºt trÃ­ tuá»‡ cao hÆ¡n rÃµ rá»‡t so vá»›i nhÃ³m suy giáº£m nháº­n thá»©c nháº¹. Äiá»u nÃ y hoÃ n toÃ n phÃ¹ há»£p vá»›i báº±ng chá»©ng dá»‹ch tá»… há»c trÃªn toÃ n cáº§u, khi tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ tÄƒng dáº§n theo tuá»•i, Ä‘áº·c biá»‡t sau 65 tuá»•i [@livingston2020lancet].

Theo WHO, cá»© má»—i 5 nÄƒm sau tuá»•i 65 thÃ¬ nguy cÆ¡ máº¯c sa sÃºt trÃ­ tuá»‡ tÄƒng gáº§n gáº¥p Ä‘Ã´i [@who2021dementia]. Má»™t nghiÃªn cá»©u táº¡i Viá»‡t Nam cá»§a LÃª VÄƒn Tuáº¥n vÃ  cá»™ng sá»± (2019) cÅ©ng xÃ¡c nháº­n ngÆ°á»i â‰¥75 tuá»•i cÃ³ nguy cÆ¡ cao hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i nhÃ³m 60â€“74 tuá»•i [@le2019travinhsstt].

Nhá»¯ng phÃ¡t hiá»‡n nÃ y nháº¥n máº¡nh vai trÃ² cá»§a cÃ¡c chÆ°Æ¡ng trÃ¬nh can thiá»‡p sá»›m, táº§m soÃ¡t Ä‘á»‹nh ká»³, vÃ  giÃ¡o dá»¥c cá»™ng Ä‘á»“ng táº­p trung vÃ o lá»©a tuá»•i trung niÃªn Ä‘á»ƒ giáº£m thiá»ƒu gÃ¡nh náº·ng bá»‡nh lÃ½ á»Ÿ giai Ä‘oáº¡n cao tuá»•i.

Xu hÆ°á»›ng nÃ y phÃ¹ há»£p vá»›i nhiá»u nghiÃªn cá»©u quá»‘c táº¿ vÃ  trong nÆ°á»›c, cho tháº¥y ná»¯ giá»›i lÃ  nhÃ³m cÃ³ nguy cÆ¡ cao hÆ¡n máº¯c cÃ¡c rá»‘i loáº¡n nháº­n thá»©c. Theo Tá»• chá»©c Y táº¿ Tháº¿ giá»›i, phá»¥ ná»¯ sá»‘ng thá» hÆ¡n nam giá»›i, dáº«n Ä‘áº¿n tá»· lá»‡ máº¯c sa sÃºt trÃ­ tuá»‡ cao hÆ¡n á»Ÿ ná»¯ [@who2021dementia]. BÃ¡o cÃ¡o toÃ n cáº§u vá» sa sÃºt trÃ­ tuá»‡ nÄƒm 2015 cÅ©ng nháº¥n máº¡nh ráº±ng phá»¥ ná»¯ chiáº¿m pháº§n lá»›n dÃ¢n sá»‘ máº¯c bá»‡nh, Ä‘áº·c biá»‡t á»Ÿ nhÃ³m tuá»•i â‰¥75 [@prince2015world].

NghiÃªn cá»©u cá»§a Petersen vÃ  cá»™ng sá»± (2018) táº¡i Hoa Ká»³ cÅ©ng ghi nháº­n phá»¥ ná»¯ khÃ´ng chá»‰ cÃ³ nguy cÆ¡ cao hÆ¡n máº¯c bá»‡nh mÃ  cÃ²n cÃ³ tá»‘c Ä‘á»™ tiáº¿n triá»ƒn nhanh hÆ¡n á»Ÿ má»™t sá»‘ thá»ƒ bá»‡nh nhÆ° Alzheimer [@petersen2018mci].

Táº¡i Viá»‡t Nam, nhiá»u kháº£o sÃ¡t cá»™ng Ä‘á»“ng Ä‘Ã£ ghi nháº­n xu hÆ°á»›ng tÆ°Æ¡ng tá»±. VÃ­ dá»¥, nghiÃªn cá»©u cá»§a Nguyá»…n Thá»‹ Nhung vÃ  cá»™ng sá»± (2014) thá»±c hiá»‡n táº¡i HÃ  Ná»™i trÃªn 300 ngÆ°á»i cao tuá»•i cho tháº¥y tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ á»Ÿ ná»¯ giá»›i (28,7%) cao hÆ¡n Ä‘Ã¡ng ká»ƒ so vá»›i nam giá»›i (17,9%) [@nhung2014]. Má»™t nghiÃªn cá»©u khÃ¡c táº¡i TP. Há»“ ChÃ­ Minh do Tráº§n VÄƒn Háº£o vÃ  cá»™ng sá»± (2020) cÅ©ng cho tháº¥y tá»· lá»‡ ná»¯ máº¯c rá»‘i loáº¡n nháº­n thá»©c giai Ä‘oáº¡n sá»›m lÃ  62,3%, cao hÆ¡n nam giá»›i (37,7%) [@hao2020].

Nhá»¯ng khÃ¡c biá»‡t nÃ y cÃ³ thá»ƒ lÃ½ giáº£i bá»Ÿi cÃ¡c yáº¿u tá»‘ sinh há»c (suy giáº£m estrogen sau mÃ£n kinh), tuá»•i thá» cao hÆ¡n, vÃ  Ä‘áº·c biá»‡t lÃ  yáº¿u tá»‘ xÃ£ há»™i: ná»¯ giá»›i lá»›n tuá»•i á»Ÿ Viá»‡t Nam thÆ°á»ng cÃ³ trÃ¬nh Ä‘á»™ há»c váº¥n tháº¥p hÆ¡n, Ã­t tham gia vÃ o cÃ¡c hoáº¡t Ä‘á»™ng trÃ­ tuá»‡ vÃ  xÃ£ há»™i, Ä‘á»“ng thá»i chá»‹u áº£nh hÆ°á»Ÿng tá»« vai trÃ² truyá»n thá»‘ng trong gia Ä‘Ã¬nh. ÄÃ¢y Ä‘á»u lÃ  nhá»¯ng yáº¿u tá»‘ lÃ m tÄƒng nguy cÆ¡ suy giáº£m nháº­n thá»©c.

Tá»« Ä‘Ã³ cÃ³ thá»ƒ tháº¥y ráº±ng giá»›i tÃ­nh lÃ  má»™t yáº¿u tá»‘ quan trá»ng trong viá»‡c Ä‘Ã¡nh giÃ¡ nguy cÆ¡ sa sÃºt trÃ­ tuá»‡ vÃ  cáº§n Ä‘Æ°á»£c xem xÃ©t khi xÃ¢y dá»±ng chiáº¿n lÆ°á»£c phÃ²ng ngá»«a. CÃ¡c chÆ°Æ¡ng trÃ¬nh táº§m soÃ¡t vÃ  can thiá»‡p cáº§n thiáº¿t káº¿ phÃ¹ há»£p vá»›i Ä‘áº·c Ä‘iá»ƒm cá»§a ná»¯ giá»›i trung niÃªn vÃ  cao tuá»•i, nháº±m nÃ¢ng cao nháº­n thá»©c, cáº£i thiá»‡n cháº¥t lÆ°á»£ng sá»‘ng vÃ  giáº£m gÃ¡nh náº·ng bá»‡nh táº­t cho cá»™ng Ä‘á»“ng.

### Äáº·c Ä‘iá»ƒm trÃ¬nh Ä‘á»™ há»c váº¥n

::: {custom-style="chu_xanh"}
`r inline_banluan_hocvan`
:::

TrÃ¬nh Ä‘á»™ há»c váº¥n lÃ  má»™t trong nhá»¯ng yáº¿u tá»‘ quan trá»ng áº£nh hÆ°á»Ÿng Ä‘áº¿n nguy cÆ¡ máº¯c suy giáº£m nháº­n thá»©c vÃ  sa sÃºt trÃ­ tuá»‡. Trong nghiÃªn cá»©u nÃ y, nhÃ³m suy giáº£m nháº­n thá»©c nháº¹ (MCI) cÃ³ tá»· lá»‡ trÃ¬nh Ä‘á»™ Ä‘áº¡i há»c cao hÆ¡n rÃµ rá»‡t (38,8%) so vá»›i nhÃ³m sa sÃºt trÃ­ tuá»‡ (25,1%). Trong khi Ä‘Ã³, nhÃ³m sa sÃºt trÃ­ tuá»‡ cÃ³ tá»· lá»‡ ngÆ°á»i há»c tiá»ƒu há»c cao hÆ¡n Ä‘Ã¡ng ká»ƒ (15,5% so vá»›i 4,7% á»Ÿ nhÃ³m MCI). Sá»± khÃ¡c biá»‡t nÃ y cÃ³ Ã½ nghÄ©a thá»‘ng kÃª (*p* = 0,004), cho tháº¥y há»c váº¥n cÃ³ thá»ƒ Ä‘Ã³ng vai trÃ² báº£o vá»‡ quan trá»ng Ä‘á»‘i vá»›i chá»©c nÄƒng nháº­n thá»©c.

CÃ¡c nghiÃªn cá»©u quá»‘c táº¿ cÅ©ng kháº³ng Ä‘á»‹nh Ä‘iá»u nÃ y. BÃ¡o cÃ¡o cá»§a á»¦y ban Lancet (2020) cho biáº¿t viá»‡c khÃ´ng há»c háº¿t trung há»c lÃ  má»™t trong nhá»¯ng yáº¿u tá»‘ nguy cÆ¡ lá»›n nháº¥t dáº«n Ä‘áº¿n sa sÃºt trÃ­ tuá»‡ [@livingston2020lancet]. Tá»• chá»©c Y táº¿ Tháº¿ giá»›i (WHO) cÅ©ng xáº¿p trÃ¬nh Ä‘á»™ há»c váº¥n tháº¥p vÃ o nhÃ³m cÃ¡c yáº¿u tá»‘ nguy cÆ¡ cÃ³ thá»ƒ phÃ²ng ngá»«a Ä‘Æ°á»£c [@who2021dementia].

Má»™t trong nhá»¯ng giáº£ thuyáº¿t Ä‘Æ°á»£c cháº¥p nháº­n rá»™ng rÃ£i lÃ  lÃ½ thuyáº¿t "dá»± trá»¯ nháº­n thá»©c" (*cognitive reserve*), cho ráº±ng há»c váº¥n cao giÃºp nÃ£o bá»™ táº¡o ra máº¡ng lÆ°á»›i tháº§n kinh linh hoáº¡t hÆ¡n vÃ  kháº£ nÄƒng bÃ¹ trá»« tá»‘t hÆ¡n khi cÃ³ tá»•n thÆ°Æ¡ng do lÃ£o hÃ³a hay bá»‡nh lÃ½ [@stern2012cognitive].

Táº¡i Viá»‡t Nam, nhiá»u nghiÃªn cá»©u cÅ©ng cho káº¿t quáº£ tÆ°Æ¡ng tá»±. LÃª VÄƒn Tuáº¥n vÃ  cá»™ng sá»± (2019) kháº£o sÃ¡t táº¡i TrÃ  Vinh cho tháº¥y ngÆ°á»i mÃ¹ chá»¯ cÃ³ nguy cÆ¡ sa sÃºt trÃ­ tuá»‡ cao gáº¥p hÆ¡n 3 láº§n so vá»›i ngÆ°á»i biáº¿t chá»¯ (OR = 3,3; KTC 95%: 1,4â€“7,9) [@le2019travinhsstt]. TÆ°Æ¡ng tá»±, Tráº§n VÄƒn HÃ o (2020) táº¡i VÄ©nh Long ghi nháº­n tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ á»Ÿ nhÃ³m há»c váº¥n tháº¥p cao hÆ¡n nhÃ³m há»c váº¥n cao cÃ³ Ã½ nghÄ©a thá»‘ng kÃª [@tran2020vinhlonghocvan].

Nhá»¯ng báº±ng chá»©ng nÃ y nháº¥n máº¡nh táº§m quan trá»ng cá»§a giÃ¡o dá»¥c trong giai Ä‘oáº¡n Ä‘áº§u Ä‘á»i nhÆ° má»™t biá»‡n phÃ¡p can thiá»‡p lÃ¢u dÃ i nháº±m phÃ²ng ngá»«a sa sÃºt trÃ­ tuá»‡ á»Ÿ ngÆ°á»i cao tuá»•i.

### Äáº·c Ä‘iá»ƒm thang Ä‘iá»ƒm MMSE

`r inline_mmse_banluan`. Tá»· lá»‡ cao nháº¥t thuá»™c vá» nhÃ³m sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh pháº£n Ã¡nh tÃ¬nh tráº¡ng nhiá»u bá»‡nh nhÃ¢n chá»‰ Ä‘Æ°á»£c phÃ¡t hiá»‡n khi bá»‡nh Ä‘Ã£ tiáº¿n triá»ƒn á»Ÿ má»©c Ä‘á»™ Ä‘Ã¡ng ká»ƒ. ÄÃ¢y lÃ  thá»±c tráº¡ng phá»• biáº¿n trong lÃ¢m sÃ ng Viá»‡t Nam, Ä‘Æ°á»£c Ä‘á» cáº­p trong nghiÃªn cá»©u cá»§a **TS Tráº§n CÃ´ng Tháº¯ng vÃ  cá»™ng sá»± (2016)** khi kháº£o sÃ¡t trÃªn 500 ngÆ°á»i â‰¥60 tuá»•i táº¡i bá»‡nh viá»‡n lÃ£o khoa trung Æ°Æ¡ng â€“ ghi nháº­n tá»· lá»‡ sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh vÃ  náº·ng chiáº¿m trÃªn 50%, trong khi tá»· lá»‡ phÃ¡t hiá»‡n MCI cÃ²n tháº¥p [@tran2016mmse].

Theo hÆ°á»›ng dáº«n quá»‘c táº¿, phÃ¡t hiá»‡n sá»›m á»Ÿ giai Ä‘oáº¡n MCI lÃ  má»¥c tiÃªu quan trá»ng vÃ¬ Ä‘Ã¢y lÃ  giai Ä‘oáº¡n cÃ³ thá»ƒ can thiá»‡p hiá»‡u quáº£ nháº±m lÃ m cháº­m tiáº¿n triá»ƒn hoáº·c tháº­m chÃ­ phá»¥c há»“i chá»©c nÄƒng nháº­n thá»©c [@petersen2018mci]. Tuy nhiÃªn, trong nghiÃªn cá»©u nÃ y, `r inline_mci_mota_phantram_banluan` Äiá»u nÃ y pháº£n Ã¡nh má»™t lá»— há»•ng trong viá»‡c táº§m soÃ¡t Ä‘á»‹nh ká»³ vÃ  nÃ¢ng cao nháº­n thá»©c cá»™ng Ä‘á»“ng.

BÃ¡o cÃ¡o cá»§a **á»¦y ban Lancet (2020)** cÅ©ng nháº¥n máº¡nh ráº±ng viá»‡c phÃ¡t hiá»‡n sá»›m, Ä‘áº·c biá»‡t á»Ÿ cÃ¡c nÆ°á»›c thu nháº­p trung bÃ¬nh nhÆ° Viá»‡t Nam, lÃ  chÃ¬a khÃ³a Ä‘á»ƒ giáº£m thiá»ƒu gÃ¡nh náº·ng kinh táº¿ vÃ  xÃ£ há»™i cá»§a sa sÃºt trÃ­ tuá»‡ [@livingston2020lancet].

Trong nghiÃªn cá»©u chÃºng tÃ´i tháº¥y ráº±ng *`r ti_le_sstt_nang_theo_mmse`* Ä‘iá»u nÃ y cÅ©ng Ä‘Ã¡ng chÃº Ã½, cho tháº¥y váº«n cÃ²n má»™t tá»· lá»‡ khÃ´ng nhá» ngÆ°á»i bá»‡nh Ä‘áº¿n khÃ¡m khi Ä‘Ã£ suy giáº£m chá»©c nÄƒng rÃµ rá»‡t, kÃ¨m theo gÃ¡nh náº·ng chÄƒm sÃ³c lá»›n cho gia Ä‘Ã¬nh vÃ  xÃ£ há»™i.

Tá»•ng thá»ƒ, phÃ¢n bá»‘ phÃ¢n Ä‘á»™ MMSE trong nghiÃªn cá»©u pháº£n Ã¡nh thá»±c tráº¡ng lÃ¢m sÃ ng táº¡i Viá»‡t Nam: cháº©n Ä‘oÃ¡n muá»™n, phÃ¡t hiá»‡n MCI cÃ²n háº¡n cháº¿. Viá»‡c tÄƒng cÆ°á»ng truyá»n thÃ´ng, Ä‘Ã o táº¡o nhÃ¢n viÃªn y táº¿ cÆ¡ sá»Ÿ vÃ  tÃ­ch há»£p táº§m soÃ¡t trÃ­ nhá»› vÃ o khÃ¡m sá»©c khá»e Ä‘á»‹nh ká»³ sáº½ lÃ  hÆ°á»›ng Ä‘i cáº§n thiáº¿t trong chiáº¿n lÆ°á»£c quá»‘c gia vá» sa sÃºt trÃ­ tuá»‡.

### Äáº·c Ä‘iá»ƒm cÃ¡c test tháº§n kinh nháº­n thá»©c

::: {custom-style="chu_xanh"}
inline_banluan_tests
:::

BÃ n luáº­n: Kháº£ nÄƒng ghi nhá»› vÃ  nháº­n biáº¿t trong sa sÃºt trÃ­ tuá»‡ Trong nghiÃªn cá»©u nÃ y, chÃºng tÃ´i quan sÃ¡t tháº¥y sá»± suy giáº£m rÃµ rá»‡t á»Ÿ cáº£ ba chá»©c nÄƒng ghi nhá»› tá»©c thÃ¬ ("Nhá»› láº¡i ngay"), ghi nhá»› sau thá»i gian trÃ¬ hoÃ£n ("Nhá»› láº¡i cÃ³ trÃ¬ hoÃ£n") vÃ  nháº­n biáº¿t trÃ¬ hoÃ£n ("Nháº­n biáº¿t cÃ³ trÃ¬ hoÃ£n") khi má»©c Ä‘á»™ sa sÃºt trÃ­ tuá»‡ tiáº¿n triá»ƒn tá»« nháº¹ Ä‘áº¿n trung bÃ¬nh vÃ  náº·ng.

Trung bÃ¬nh Ä‘iá»ƒm "Nhá»› láº¡i ngay" lÃ  `r round(mean(df$nholai_ngay, na.rm=TRUE), 1)`, khi phÃ¢n tÃ­ch theo nhÃ³m MMSE, nhÃ³m Suy giáº£m nháº­n thá»©c nháº¹ Ä‘áº¡t trung bÃ¬nh `r round(mean(df$nholai_ngay[df$mmse_group == 'Suy giáº£m nháº­n thá»©c nháº¹'], na.rm=TRUE), 1)`, trong khi nhÃ³m Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh chá»‰ cÃ²n `r round(mean(df$nholai_ngay[df$mmse_group == 'Sa sÃºt trÃ­ tuá»‡ trung bÃ¬nh'], na.rm=TRUE), 1)` Äiá»u nÃ y cho tháº¥y sá»± tá»•n thÆ°Æ¡ng tiáº¿n triá»ƒn cá»§a trÃ­ nhá»› ngáº¯n háº¡n â€“ vá»‘n phá»¥ thuá»™c vÃ o hoáº¡t Ä‘á»™ng cá»§a thÃ¹y thÃ¡i dÆ°Æ¡ng giá»¯a vÃ  há»“i háº£i mÃ£.

Nhá»¯ng káº¿t quáº£ nÃ y kháº³ng Ä‘á»‹nh táº§m quan trá»ng cá»§a viá»‡c Ä‘Ã¡nh giÃ¡ trÃ­ nhá»› ngáº¯n háº¡n vÃ  trung háº¡n trong cháº©n Ä‘oÃ¡n sá»›m vÃ  phÃ¢n biá»‡t cÃ¡c má»©c Ä‘á»™ sa sÃºt trÃ­ tuá»‡, tá»« Ä‘Ã³ há»— trá»£ xÃ¢y dá»±ng káº¿ hoáº¡ch can thiá»‡p phÃ¹ há»£p.

### Äiá»ƒm háº¡n cháº¿

### TÃ­nh má»›i

### tÃ­nh á»©ng dá»¥ng cá»§a Ä‘á» tÃ i

::: {custom-style="CAN GIUA DAM 14 ONE"}
Káº¾T LUáº¬N
:::

Má»¥c tiÃªu 1 Má»¥c tiÃªu 2

## Táº¡o slide bÃ¡o cÃ¡o

### Táº¡o slide bÃ¡o cÃ¡o

```{r}
my_pres  <- read_pptx("sstt_SLIDE_input.pptx") 

myftr <- "Bá»‡nh viá»‡n 30-4"
```

### Slide tiÃªu Ä‘á»

### Slide vai trÃ² test tháº§n kinh nháº­n thá»©c

```{r}
#| label: slide vai tro test than kinh nhan thuc
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Vai trÃ² test tháº§n kinh nháº­n thá»©c", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("Viá»‡c phÃ¢n tÃ­ch tá»‘t cÃ¡c thang Ä‘iá»ƒm tÃ¢m tháº§n kinh nÃ y há»— trá»£ cÃ¡c bÃ¡c sÄ© lÃ¢m sÃ ng trong viá»‡c cháº©n Ä‘oÃ¡n, cháº©n Ä‘oÃ¡n phÃ¢n biá»‡t thá»ƒ bá»‡nh" ,  "xÃ¡c Ä‘á»‹nh lÄ©nh vá»±c nháº­n thá»©c bá»‹ khiáº¿m khuyáº¿t, má»©c Ä‘á»™ náº·ng","Chá»n lá»±a cÃ¡c phÆ°Æ¡ng phÃ¡p can thiá»‡p nháº­n thá»©c khÃ´ng dÃ¹ng thuá»‘c nhÆ° táº­p luyá»‡n nháº­n thá»©c (cognitive training), phá»¥c há»“i nháº­n thá»©c (cognitive rehabilitation), kÃ­ch thÃ­ch nháº­n thá»©c (cognitive stimulation); theo dÃµi diá»…n tiáº¿n khiáº¿m khuyáº¿t nháº­n thá»©c Ä‘áº·c biá»‡t trong cÃ¡c trÆ°á»ng há»£p than phiá»n giáº£m nháº­n thá»©c chá»§ quan (subjective cognitive impairment), suy giáº£m nháº­n thá»©c nháº¹ (mild cognitive impairment)."), location = ph_location_type(type = "body"))
```

### Slide ná»™i dung chÃ­nh

## Slide ná»™i dung bÃ¡o cÃ¡o

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 1, 1,1 ),
  str_list = c("Äáº·t váº¥n Ä‘á»", "Äá»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cá»©u", "Káº¿t quáº£ - BÃ n luáº­n", "Káº¿t luáº­n"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "Ná»™i dung trÃ¬nh bÃ y", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide má»¥c tiÃªu nghiÃªn cá»©u.

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2),
  str_list = c("CÃ¢u há»i nghiÃªn cá»©u", "GiÃ¡ trÃ­ cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test lÃ  gÃ¬?", "Má»¥c tiÃªu", "NghiÃªn cá»©u má»‘i tÆ°Æ¡ng quan cá»§a thang Ä‘iá»ƒm MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c táº¡i Bá»‡nh viá»‡n 30-4.", "ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng cá»§a bá»™ Test tháº§n kinh nháº­n thá»©c trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ Sa sÃºt trÃ­ tuá»‡ táº¡i Bá»‡nh viá»‡n 30-4"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "CÃ¢u há»i NC, má»¥c tiÃªu", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide Ä‘áº·t váº¥n Ä‘Ãª

```{r}
#| label: slide dat van de
#| include: false
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Äáº·t váº¥n Ä‘á»", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("SSTT lÃ  má»™t bá»‡nh lÃ½ cá»§a nÃ£o bá»™, gÃ¢y ra suy giáº£m chá»©c nÄƒng nháº­n thá»©c, hÃ nh vi vÃ  hoáº¡t Ä‘á»™ng sá»‘ng cá»§a bá»‡nh nhÃ¢n.",
  "Tá»« nÄƒm 2019 Ä‘áº¿n nay, ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Ã£ sá»­ dá»¥ng bá»™ tráº¯c nghiá»‡m  Ä‘Ã¡nh giÃ¡ chá»©c nÄƒng tháº§n kinh nháº­n thá»©c Viá»‡t Nam (VnCA)",
  "PhÃ¡t hiá»‡n, Ä‘Ã¡nh giÃ¡ Ä‘Ãºng má»©c nhá»¯ng thay Ä‘á»•i sá»›m nháº¥t vá» hÃ nh vi vÃ  nháº­n thá»©c cá»§a bá»‡nh nhÃ¢n giÃºp cÃ¡c nhÃ  lÃ¢m sÃ ng cháº©n Ä‘oÃ¡n sá»›m, tá»‘i Æ°u hÃ³a chiáº¿n lÆ°á»£c Ä‘iá»u trá»‹, gÃ³p pháº§n giáº£m thiá»ƒu gÃ¡nh náº·ng bá»‡nh táº­t do SSTT gÃ¢y ra"), location = ph_location_type(type = "body"))


```

### Slide Ä‘á»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cá»©u

```{r}
#| label: slide doi tuong va phuong phap nghien cuu
#| echo: true
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2,2, 1, 2, 2, 2),
  str_list = c("Thiáº¿t káº¿ ngiÃªn cá»©u", "MÃ´ táº£ cáº¯t ngang", "TiÃªu chuáº©n chá»n", "Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m táº¡i ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  SSTT ", "Tá»« 40 tuá»•i trá»Ÿ lÃªn", "CÃ³ than phiá»n vá» trÃ­ nhá»› hoáº·c nháº­n thá»©c","TiÃªu chuáº©n loáº¡i trá»«", "KhÃ´ng há»£p tÃ¡c", "Bá»‡nh nhÃ¢n Ä‘ang bá»‹ mÃª sáº£ng, lÃº láº«n cáº¥p", "Suy giáº£m nháº­n thá»©c khÃ´ng do nguyÃªn nhÃ¢n tÃ¢m tháº§n kinh khÃ¡c" ),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "Äá»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cÃºu", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide vá» Ä‘áº·c Ä‘iá»ƒm tuá»•i ğŸŒ¹

```{r}
#| label: slide tuoi flex ggplo 2
#| echo: true

my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm  tuá»•i  (Báº£ng vÃ  biá»ƒu Ä‘á»“) ", location = ph_location_type(type = "title")) #them title


# Create and format the flextable
ft_tuoi <- ft_tuoi  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft_tuoi <- width(ft_tuoi, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = tuoi_gp
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft_tuoi,   location = ph_location_label(ph_label = "Content Placeholder 2"))

# chen inline
# Äá»‹nh dáº¡ng vÄƒn báº£n vá»›i fontsize = 16
inline_text <- ftext(inline_bieudo_tuoi_ketqua, 
                     prop = fp_text(font.size = 16))

# GÃ³i trong fpar() Ä‘á»ƒ táº¡o paragraph
inline_paragraph <- fpar(inline_text)

# ChÃ¨n vÃ o PowerPoint (vÃ­ dá»¥ placeholder label lÃ  "Footer Placeholder 5")
my_pres <- ph_with(
  my_pres,
  value = inline_paragraph,
  location = ph_location_label(ph_label = "Footer Placeholder 5")
)
```

### Slide vá» Ä‘áº·c Ä‘iá»ƒm giá»›i ğŸŒ¹

```{r}
#| label: slide tuoi footnote
#| echo: true

my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm  giá»›i tÃ­nh ", location = ph_location_type(type = "title")) #them title


# Create and format the flextable
ft_gender <- ft_gender  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft_gender <- width(ft_gender, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = gioitinh_bar_percent
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft_gender,   location = ph_location_label(ph_label = "Content Placeholder 2"))

# chen inline
# Äá»‹nh dáº¡ng vÄƒn báº£n vá»›i fontsize = 16
inline_text <- ftext(inline_bieudo_gioitinh_ketqua , 
                     prop = fp_text(font.size = 16))

# GÃ³i trong fpar() Ä‘á»ƒ táº¡o paragraph
inline_paragraph <- fpar(inline_text)

# ChÃ¨n vÃ o PowerPoint (vÃ­ dá»¥ placeholder label lÃ  "Footer Placeholder 5")
my_pres <- ph_with(
  my_pres,
  value = inline_paragraph,
  location = ph_location_label(ph_label = "Footer Placeholder 5")
)
```

### xuat sang powerpoint

```{r}
print(my_pres , "sstt_SLIDE_output.pptx")
```

::: {custom-style="CAN GIUA DAM 14 ONE"}
TÃ€I LIá»†U THAM KHáº¢O
:::
