## T·∫°o slide b√°o c√°o

```{r}
my_pres  <- read_pptx("sstt_SLIDE_input.pptx") 

myftr <- "B·ªánh vi·ªán 30-4"
```

### Ki·ªÉm tra layout

```{r}
#| label: kiem tra layout
#| echo: true
layout_summary(my_pres)

glimpse(layout_summary(my_pres))
# Inspect layout structure
knitr::kable(layout_summary(my_pres))

# Inspect properties of a specific layout
knitr::kable(layout_properties(my_pres, layout = "Title and Content", master = "Office Theme"))


```

### Slide ti√™u ƒë·ªÅ

```{r}
#| include: false
# T·∫°o slide ti√™u ƒë·ªÅ
# Add title slide
my_pres <- add_slide(my_pres, layout = "Title Slide", master = "Office Theme")

# Add title and subtitle
my_pres <- ph_with(my_pres, value = "Hi·ªáu qu·∫£ ch·∫©n ƒëo√°n v√† ƒëi·ªÅu tr·ªã b·ªô test th·∫ßn kinh nh·∫≠n th·ª©c",
                   location = ph_location_type(type = "ctrTitle"))
my_pres <- ph_with(my_pres, value = "BS.CK2. ƒê·ªó Thanh Li√™m - ƒê∆°n v·ªã tr√≠ nh·ªõ v√† sa s√∫t tr√≠ tu·ªá BV 30-4", 
                   location = ph_location_type(type = "subTitle"))

# Add footer
my_pres <- ph_with(my_pres, value = "ƒêV ch·ªß tr√¨: Khoa T√¢m th·∫ßn kinh", location = ph_location_type(type = "ftr"))
# Add footer with date
my_pres <- ph_with(my_pres, value = format(Sys.Date(), "%d/%m/%Y"), location = ph_location_type(type = "dt"))
# Add infor to footer

my_pres <- ph_with(my_pres, value = "ƒê·ªÅ t√†i c·∫•p c∆° s·ªü", location = ph_location_type(type = "sldNum"))
```

## Slide n·ªôi dung b√°o c√°o

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 1, 1,1 ),
  str_list = c("ƒê·∫∑t v·∫•n ƒë·ªÅ", "ƒê·ªëi t∆∞·ª£ng v√† ph∆∞∆°ng ph√°p nghi√™n c·ª©u", "K·∫øt qu·∫£ - B√†n lu·∫≠n", "K·∫øt lu·∫≠n"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "N·ªôi dung tr√¨nh b√†y", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide m·ª•c ti√™u nghi√™n c·ª©u.

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2),
  str_list = c("C√¢u h·ªèi nghi√™n c·ª©u", "Gi√° tr√≠ ch·∫©n ƒëo√°n v√† ƒëi·ªÅu tr·ªã b·ªô test l√† g√¨?", "M·ª•c ti√™u", "Nghi√™n c·ª©u m·ªëi t∆∞∆°ng quan c·ªßa thang ƒëi·ªÉm MMSE v·ªõi c√°c test th·∫ßn kinh nh·∫≠n th·ª©c kh√°c trong b·ªô Test th·∫ßn kinh nh·∫≠n th·ª©c t·∫°i B·ªánh vi·ªán 30-4.", "ƒê√°nh gi√° hi·ªáu qu·∫£ ·ª©ng d·ª•ng c·ªßa b·ªô Test th·∫ßn kinh nh·∫≠n th·ª©c trong ch·∫©n ƒëo√°n v√† ƒëi·ªÅu tr·ªã Sa s√∫t tr√≠ tu·ªá t·∫°i B·ªánh vi·ªán 30-4"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "C√¢u h·ªèi NC, m·ª•c ti√™u", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide ƒë·∫∑t v·∫•n ƒë√™

```{r}
#| label: slide dat van de
#| include: false
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "ƒê·∫∑t v·∫•n ƒë·ªÅ", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("SSTT l√† m·ªôt b·ªánh l√Ω c·ªßa n√£o b·ªô, g√¢y ra suy gi·∫£m ch·ª©c nƒÉng nh·∫≠n th·ª©c, h√†nh vi v√† ho·∫°t ƒë·ªông s·ªëng c·ªßa b·ªánh nh√¢n.",
  "T·ª´ nƒÉm 2019 ƒë·∫øn nay, ƒê∆°n v·ªã Tr√≠ nh·ªõ v√† Sa s√∫t tr√≠ tu·ªá B·ªánh vi·ªán 30-4 ƒë√£ s·ª≠ d·ª•ng b·ªô tr·∫Øc nghi·ªám  ƒë√°nh gi√° ch·ª©c nƒÉng th·∫ßn kinh nh·∫≠n th·ª©c Vi·ªát Nam (VnCA)",
  "Ph√°t hi·ªán, ƒë√°nh gi√° ƒë√∫ng m·ª©c nh·ªØng thay ƒë·ªïi s·ªõm nh·∫•t v·ªÅ h√†nh vi v√† nh·∫≠n th·ª©c c·ªßa b·ªánh nh√¢n gi√∫p c√°c nh√† l√¢m s√†ng ch·∫©n ƒëo√°n s·ªõm, t·ªëi ∆∞u h√≥a chi·∫øn l∆∞·ª£c ƒëi·ªÅu tr·ªã, g√≥p ph·∫ßn gi·∫£m thi·ªÉu g√°nh n·∫∑ng b·ªánh t·∫≠t do SSTT g√¢y ra"), location = ph_location_type(type = "body"))


```

### Slide ƒë·ªëi t∆∞·ª£ng v√† ph∆∞∆°ng ph√°p nghi√™n c·ª©u

```{r}
#| label: slide doi tuong va phuong phap nghien cuu
#| echo: true
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2,2, 1, 2, 2, 2),
  str_list = c("Thi·∫øt k·∫ø ngi√™n c·ª©u", "M√¥ t·∫£ c·∫Øt ngang", "Ti√™u chu·∫©n ch·ªçn", "B·ªánh nh√¢n ƒë·∫øn kh√°m t·∫°i ƒê∆°n v·ªã tr√≠ nh·ªõ v√† SSTT ", "T·ª´ 40 tu·ªïi tr·ªü l√™n", "C√≥ than phi·ªÅn v·ªÅ tr√≠ nh·ªõ ho·∫∑c nh·∫≠n th·ª©c","Ti√™u chu·∫©n lo·∫°i tr·ª´", "Kh√¥ng h·ª£p t√°c", "B·ªánh nh√¢n ƒëang b·ªã m√™ s·∫£ng, l√∫ l·∫´n c·∫•p", "Suy gi·∫£m nh·∫≠n th·ª©c kh√¥ng do nguy√™n nh√¢n t√¢m th·∫ßn kinh kh√°c" ),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "ƒê·ªëi t∆∞·ª£ng v√† ph∆∞∆°ng ph√°p nghi√™n c√∫u", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slides Ti·∫øn ƒë·ªô l·∫•y m·∫´u üçÉ

```{r}
#| label: tien do lay mau
#| eval: false
#| include: false
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "Ti·∫øn ƒë·ªô l·∫•y m·∫´u", location = ph_location_type(type = "title"))

emp <- as.data.frame(df %>% count(year) %>%  mutate(percentage = round((n / sum(n)) * 100),  1))




loc <- ph_location(
  left=1.5,
  top = 1.5,
  width = 10,
  height = 4,
  rotation = 0,
  bg="#333333"
)

my_pres  <- ph_with(my_pres , emp, location = loc)

```

### Slide vai tr√≤ test th·∫ßn kinh nh·∫≠n th·ª©cüåπ

```{r}
#| label: slide vai tro test than kinh nhan thuc
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Vai tr√≤ test th·∫ßn kinh nh·∫≠n th·ª©c", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("Vi·ªác ph√¢n t√≠ch t·ªët c√°c thang ƒëi·ªÉm t√¢m th·∫ßn kinh n√†y h·ªó tr·ª£ c√°c b√°c sƒ© l√¢m s√†ng trong vi·ªác ch·∫©n ƒëo√°n, ch·∫©n ƒëo√°n ph√¢n bi·ªát th·ªÉ b·ªánh" ,  "x√°c ƒë·ªãnh lƒ©nh v·ª±c nh·∫≠n th·ª©c b·ªã khi·∫øm khuy·∫øt, m·ª©c ƒë·ªô n·∫∑ng","Ch·ªçn l·ª±a c√°c ph∆∞∆°ng ph√°p can thi·ªáp nh·∫≠n th·ª©c kh√¥ng d√πng thu·ªëc nh∆∞ t·∫≠p luy·ªán nh·∫≠n th·ª©c (cognitive training), ph·ª•c h·ªìi nh·∫≠n th·ª©c (cognitive rehabilitation), k√≠ch th√≠ch nh·∫≠n th·ª©c (cognitive stimulation); theo d√µi di·ªÖn ti·∫øn khi·∫øm khuy·∫øt nh·∫≠n th·ª©c ƒë·∫∑c bi·ªát trong c√°c tr∆∞·ªùng h·ª£p than phi·ªÅn gi·∫£m nh·∫≠n th·ª©c ch·ªß quan (subjective cognitive impairment), suy gi·∫£m nh·∫≠n th·ª©c nh·∫π (mild cognitive impairment)."), location = ph_location_type(type = "body"))
```

# add ggplot

```{r}
#| eval: false
#| include: false


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "cho ggplot v√¥ body", location = ph_location_type(type = "title"))

  
my_pres <- ph_with(x = my_pres, tien_do_2024_thang_gp, 
   location = ph_location_type(type = "body") )

```

#### add table 
```{r}
#| label: slide dac diem gioi tinh
#| eval: false
#| include: false
my_pres <- add_slide(my_pres, layout = "Title and Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "ƒê·∫∑c ƒëi·ªÉm gi·ªõi t√≠nh -gi·ªØa ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Gi·ªõi t√≠nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft <- width(ft, width = 5, unit = "cm")

# Get slide dimensions in inches
slide_dims <- slide_size(my_pres)
slide_width <- slide_dims$width
slide_height <- slide_dims$height

# Get flextable dimensions
table_dims <- dim(ft)
table_width <- sum(table_dims$widths)
table_height <- sum(table_dims$heights)

# Calculate positions to center the table
left_pos <- (slide_width - table_width) / 2
top_pos <- (slide_height - table_height) / 2


# Add the flextable to the slide at the calculated position
my_pres <- ph_with(my_pres, value = ft, location = ph_location(left = left_pos, top = top_pos))



```
# add ƒë·∫∑c ƒëi·ªÉm theo  tu·ªïi ggplot 

```{r}
#| label: slide tuoi ggplot
#| echo: true


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "BI·ªÇU ƒê·ªí ƒê·∫∂C DI·ªÇM THEO TU·ªîI ", location = ph_location_type(type = "title"))

  
my_pres <- ph_with(x = my_pres, tuoi_gp, 
   location = ph_location_type(type = "body") )

```




# add table 
```{r}
#| label: slide chua dung
#| eval: false
#| include: false

my_pres <- add_slide(my_pres, layout = "Title and Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "ƒê·∫∑c ƒëi·ªÉm theo tu·ªïi ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Gi·ªõi t√≠nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft <- width(ft, width = 5, unit = "cm")

# Get slide dimensions in inches
slide_dims <- slide_size(my_pres)
slide_width <- slide_dims$width
slide_height <- slide_dims$height

# Get flextable dimensions
table_dims <- dim(ft)
table_width <- sum(table_dims$widths)
table_height <- sum(table_dims$heights)

# Calculate positions to center the table
left_pos <- (slide_width - table_width) / 2
top_pos <- (slide_height - table_height) / 2


# Add the flextable to the slide at the calculated position
my_pres <- ph_with(my_pres, value = ft, location = ph_location(left = left_pos, top = top_pos))



```
# Th√™m b·∫£ng 2 n·ªôi dung üåπ

```{r}
#| label: slide tuoi flex ggplo 2
#| echo: true

my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "ƒê·∫∑c ƒëi·ªÉm  tu·ªïi  (B·∫£ng v√† bi·ªÉu ƒë·ªì) ", location = ph_location_type(type = "title")) #them title


# Create and format the flextable
ft_tuoi <- ft_tuoi %>%
  set_header_labels(gender = "Gi·ªõi t√≠nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>%   autofit()

ft_tuoi <- width(ft_tuoi, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = tuoi_gp
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft_tuoi,   location = ph_location_label(ph_label = "Content Placeholder 2"))

```

# Th√™m b·∫£ng 2 n·ªôi dung üåπüåπ

```{r}
#| label: slide tuoi flex ggplo 2 inline
#| echo: true
# üü¶ Th√™m slide m·ªõi ki·ªÉu Two Content
my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme")

# üü¶ Ch√®n ti√™u ƒë·ªÅ
my_pres <- ph_with(my_pres, value = "ƒê·∫∑c ƒëi·ªÉm tu·ªïi (B·∫£ng v√† bi·ªÉu ƒë·ªì)", location = ph_location_type(type = "title"))

# üü¶ Format b·∫£ng flextable
ft_tuoi <- ft_tuoi %>%
  set_header_labels(gender = "Gi·ªõi t√≠nh", Count = "n", Percentage = "%") %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg(bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>% autofit() %>%
  width(width = 3, unit = "cm")

# üü¶ Ch√®n b·∫£ng v√†o b√™n tr√°i
my_pres <- ph_with(my_pres, value = ft_tuoi, location = ph_location_left())

# üü¶ Ch√®n bi·ªÉu ƒë·ªì (tuoi_gp) v√†o b√™n ph·∫£i
my_pres <- ph_with(my_pres, value = dml(ggobj = tuoi_gp), location = ph_location_right())

# üü¶ Ch√®n m√¥ t·∫£ bi·ªÉu ƒë·ªì b√™n d∆∞·ªõi (ngay d∆∞·ªõi bi·ªÉu ƒë·ªì)
my_pres <- ph_with(
  my_pres,
  value = inline_bieudo_tuoi_ketqua,
  location = ph_location(
    left = 5.5, top = 5.5, width = 4, height = 1
  )
)

```


# Th√™m b·∫£ng 2 n·ªôi dung

```{r}
#| eval: false
#| include: false
my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "ƒê·∫∑c ƒëi·ªÉm gi·ªõi t√≠nh (B·∫£n v√† bi·ªÉu ƒë·ªì) ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Gi·ªõi t√≠nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>%   autofit()

ft <- width(ft, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = gioi_tinh_gp
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft,   location = ph_location_label(ph_label = "Content Placeholder 2"))




```

## b·∫£ng 2

```{r}


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

 
my_pres <- ph_with(my_pres, value = "Th√™m b·∫£ng n·ªØa", location = ph_location_type(type = "title"))

ft <- flextable(head(mtcars))
ft <- set_table_properties(ft, width = 1, layout = "autofit")

my_pres <- ph_with(x = my_pres, ft,   location = ph_location_type(type = "body")  )

```

# Export to pptx file

```{r}
print(my_pres , "sstt_dtcs_SLIDE_output.pptx")
```






