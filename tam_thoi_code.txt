## Táº¡o slide bÃ¡o cÃ¡o

```{r}
my_pres  <- read_pptx("sstt_SLIDE_input.pptx") 

myftr <- "Bá»‡nh viá»‡n 30-4"
```

### Kiá»ƒm tra layout

```{r}
#| label: kiem tra layout
#| echo: true
layout_summary(my_pres)

glimpse(layout_summary(my_pres))
# Inspect layout structure
knitr::kable(layout_summary(my_pres))

# Inspect properties of a specific layout
knitr::kable(layout_properties(my_pres, layout = "Title and Content", master = "Office Theme"))


```

### Slide tiÃªu Ä‘á»

```{r}
#| include: false
# Táº¡o slide tiÃªu Ä‘á»
# Add title slide
my_pres <- add_slide(my_pres, layout = "Title Slide", master = "Office Theme")

# Add title and subtitle
my_pres <- ph_with(my_pres, value = "Hiá»‡u quáº£ cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test tháº§n kinh nháº­n thá»©c",
                   location = ph_location_type(type = "ctrTitle"))
my_pres <- ph_with(my_pres, value = "BS.CK2. Äá»— Thanh LiÃªm - ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  sa sÃºt trÃ­ tuá»‡ BV 30-4", 
                   location = ph_location_type(type = "subTitle"))

# Add footer
my_pres <- ph_with(my_pres, value = "ÄV chá»§ trÃ¬: Khoa TÃ¢m tháº§n kinh", location = ph_location_type(type = "ftr"))
# Add footer with date
my_pres <- ph_with(my_pres, value = format(Sys.Date(), "%d/%m/%Y"), location = ph_location_type(type = "dt"))
# Add infor to footer

my_pres <- ph_with(my_pres, value = "Äá» tÃ i cáº¥p cÆ¡ sá»Ÿ", location = ph_location_type(type = "sldNum"))
```

## Slide ná»™i dung bÃ¡o cÃ¡o

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 1, 1,1 ),
  str_list = c("Äáº·t váº¥n Ä‘á»", "Äá»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cá»©u", "Káº¿t quáº£ - BÃ n luáº­n", "Káº¿t luáº­n"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "Ná»™i dung trÃ¬nh bÃ y", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide má»¥c tiÃªu nghiÃªn cá»©u.

```{r}
#| include: false
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2),
  str_list = c("CÃ¢u há»i nghiÃªn cá»©u", "GiÃ¡ trÃ­ cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ bá»™ test lÃ  gÃ¬?", "Má»¥c tiÃªu", "NghiÃªn cá»©u má»‘i tÆ°Æ¡ng quan cá»§a thang Ä‘iá»ƒm MMSE vá»›i cÃ¡c test tháº§n kinh nháº­n thá»©c khÃ¡c trong bá»™ Test tháº§n kinh nháº­n thá»©c táº¡i Bá»‡nh viá»‡n 30-4.", "ÄÃ¡nh giÃ¡ hiá»‡u quáº£ á»©ng dá»¥ng cá»§a bá»™ Test tháº§n kinh nháº­n thá»©c trong cháº©n Ä‘oÃ¡n vÃ  Ä‘iá»u trá»‹ Sa sÃºt trÃ­ tuá»‡ táº¡i Bá»‡nh viá»‡n 30-4"),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "CÃ¢u há»i NC, má»¥c tiÃªu", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slide Ä‘áº·t váº¥n Ä‘Ãª

```{r}
#| label: slide dat van de
#| include: false
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Äáº·t váº¥n Ä‘á»", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("SSTT lÃ  má»™t bá»‡nh lÃ½ cá»§a nÃ£o bá»™, gÃ¢y ra suy giáº£m chá»©c nÄƒng nháº­n thá»©c, hÃ nh vi vÃ  hoáº¡t Ä‘á»™ng sá»‘ng cá»§a bá»‡nh nhÃ¢n.",
  "Tá»« nÄƒm 2019 Ä‘áº¿n nay, ÄÆ¡n vá»‹ TrÃ­ nhá»› vÃ  Sa sÃºt trÃ­ tuá»‡ Bá»‡nh viá»‡n 30-4 Ä‘Ã£ sá»­ dá»¥ng bá»™ tráº¯c nghiá»‡m  Ä‘Ã¡nh giÃ¡ chá»©c nÄƒng tháº§n kinh nháº­n thá»©c Viá»‡t Nam (VnCA)",
  "PhÃ¡t hiá»‡n, Ä‘Ã¡nh giÃ¡ Ä‘Ãºng má»©c nhá»¯ng thay Ä‘á»•i sá»›m nháº¥t vá» hÃ nh vi vÃ  nháº­n thá»©c cá»§a bá»‡nh nhÃ¢n giÃºp cÃ¡c nhÃ  lÃ¢m sÃ ng cháº©n Ä‘oÃ¡n sá»›m, tá»‘i Æ°u hÃ³a chiáº¿n lÆ°á»£c Ä‘iá»u trá»‹, gÃ³p pháº§n giáº£m thiá»ƒu gÃ¡nh náº·ng bá»‡nh táº­t do SSTT gÃ¢y ra"), location = ph_location_type(type = "body"))


```

### Slide Ä‘á»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cá»©u

```{r}
#| label: slide doi tuong va phuong phap nghien cuu
#| echo: true
ul <- unordered_list(
  level_list = c(1, 2,  1, 2, 2,2, 1, 2, 2, 2),
  str_list = c("Thiáº¿t káº¿ ngiÃªn cá»©u", "MÃ´ táº£ cáº¯t ngang", "TiÃªu chuáº©n chá»n", "Bá»‡nh nhÃ¢n Ä‘áº¿n khÃ¡m táº¡i ÄÆ¡n vá»‹ trÃ­ nhá»› vÃ  SSTT ", "Tá»« 40 tuá»•i trá»Ÿ lÃªn", "CÃ³ than phiá»n vá» trÃ­ nhá»› hoáº·c nháº­n thá»©c","TiÃªu chuáº©n loáº¡i trá»«", "KhÃ´ng há»£p tÃ¡c", "Bá»‡nh nhÃ¢n Ä‘ang bá»‹ mÃª sáº£ng, lÃº láº«n cáº¥p", "Suy giáº£m nháº­n thá»©c khÃ´ng do nguyÃªn nhÃ¢n tÃ¢m tháº§n kinh khÃ¡c" ),
  style = fp_text(color = "black", font.size = 0) )


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

my_pres <- ph_with(my_pres, value = "Äá»‘i tÆ°á»£ng vÃ  phÆ°Æ¡ng phÃ¡p nghiÃªn cÃºu", location = ph_location_type(type = "title"))
my_pres <- ph_with(x = my_pres, value = ul, 
               location = ph_location_type(type = "body") )


```

### Slides Tiáº¿n Ä‘á»™ láº¥y máº«u ğŸƒ

```{r}
#| label: tien do lay mau
#| eval: false
#| include: false
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "Tiáº¿n Ä‘á»™ láº¥y máº«u", location = ph_location_type(type = "title"))

emp <- as.data.frame(df %>% count(year) %>%  mutate(percentage = round((n / sum(n)) * 100),  1))




loc <- ph_location(
  left=1.5,
  top = 1.5,
  width = 10,
  height = 4,
  rotation = 0,
  bg="#333333"
)

my_pres  <- ph_with(my_pres , emp, location = loc)

```

### Slide vai trÃ² test tháº§n kinh nháº­n thá»©cğŸŒ¹

```{r}
#| label: slide vai tro test than kinh nhan thuc
# add slide
my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")
# add title of slide
my_pres <- ph_with(my_pres, value = "Vai trÃ² test tháº§n kinh nháº­n thá»©c", location = ph_location_type(type = "title"))
# add body of slide
my_pres <- ph_with(my_pres, value = c("Viá»‡c phÃ¢n tÃ­ch tá»‘t cÃ¡c thang Ä‘iá»ƒm tÃ¢m tháº§n kinh nÃ y há»— trá»£ cÃ¡c bÃ¡c sÄ© lÃ¢m sÃ ng trong viá»‡c cháº©n Ä‘oÃ¡n, cháº©n Ä‘oÃ¡n phÃ¢n biá»‡t thá»ƒ bá»‡nh" ,  "xÃ¡c Ä‘á»‹nh lÄ©nh vá»±c nháº­n thá»©c bá»‹ khiáº¿m khuyáº¿t, má»©c Ä‘á»™ náº·ng","Chá»n lá»±a cÃ¡c phÆ°Æ¡ng phÃ¡p can thiá»‡p nháº­n thá»©c khÃ´ng dÃ¹ng thuá»‘c nhÆ° táº­p luyá»‡n nháº­n thá»©c (cognitive training), phá»¥c há»“i nháº­n thá»©c (cognitive rehabilitation), kÃ­ch thÃ­ch nháº­n thá»©c (cognitive stimulation); theo dÃµi diá»…n tiáº¿n khiáº¿m khuyáº¿t nháº­n thá»©c Ä‘áº·c biá»‡t trong cÃ¡c trÆ°á»ng há»£p than phiá»n giáº£m nháº­n thá»©c chá»§ quan (subjective cognitive impairment), suy giáº£m nháº­n thá»©c nháº¹ (mild cognitive impairment)."), location = ph_location_type(type = "body"))
```

# add ggplot

```{r}
#| eval: false
#| include: false


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "cho ggplot vÃ´ body", location = ph_location_type(type = "title"))

  
my_pres <- ph_with(x = my_pres, tien_do_2024_thang_gp, 
   location = ph_location_type(type = "body") )

```

#### add table 
```{r}
#| label: slide dac diem gioi tinh
#| eval: false
#| include: false
my_pres <- add_slide(my_pres, layout = "Title and Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm giá»›i tÃ­nh -giá»¯a ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Giá»›i tÃ­nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft <- width(ft, width = 5, unit = "cm")

# Get slide dimensions in inches
slide_dims <- slide_size(my_pres)
slide_width <- slide_dims$width
slide_height <- slide_dims$height

# Get flextable dimensions
table_dims <- dim(ft)
table_width <- sum(table_dims$widths)
table_height <- sum(table_dims$heights)

# Calculate positions to center the table
left_pos <- (slide_width - table_width) / 2
top_pos <- (slide_height - table_height) / 2


# Add the flextable to the slide at the calculated position
my_pres <- ph_with(my_pres, value = ft, location = ph_location(left = left_pos, top = top_pos))



```
# add Ä‘áº·c Ä‘iá»ƒm theo  tuá»•i ggplot 

```{r}
#| label: slide tuoi ggplot
#| echo: true


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")


my_pres <- ph_with(my_pres, value = "BIá»‚U Äá»’ Äáº¶C DIá»‚M THEO TUá»”I ", location = ph_location_type(type = "title"))

  
my_pres <- ph_with(x = my_pres, tuoi_gp, 
   location = ph_location_type(type = "body") )

```




# add table 
```{r}
#| label: slide chua dung
#| eval: false
#| include: false

my_pres <- add_slide(my_pres, layout = "Title and Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm theo tuá»•i ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Giá»›i tÃ­nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 18, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 18, part = "body") %>%   autofit()

ft <- width(ft, width = 5, unit = "cm")

# Get slide dimensions in inches
slide_dims <- slide_size(my_pres)
slide_width <- slide_dims$width
slide_height <- slide_dims$height

# Get flextable dimensions
table_dims <- dim(ft)
table_width <- sum(table_dims$widths)
table_height <- sum(table_dims$heights)

# Calculate positions to center the table
left_pos <- (slide_width - table_width) / 2
top_pos <- (slide_height - table_height) / 2


# Add the flextable to the slide at the calculated position
my_pres <- ph_with(my_pres, value = ft, location = ph_location(left = left_pos, top = top_pos))



```
# ThÃªm báº£ng 2 ná»™i dung ğŸŒ¹

```{r}
#| label: slide tuoi flex ggplo 2
#| echo: true

my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm  tuá»•i  (Báº£ng vÃ  biá»ƒu Ä‘á»“) ", location = ph_location_type(type = "title")) #them title


# Create and format the flextable
ft_tuoi <- ft_tuoi %>%
  set_header_labels(gender = "Giá»›i tÃ­nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>%   autofit()

ft_tuoi <- width(ft_tuoi, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = tuoi_gp
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft_tuoi,   location = ph_location_label(ph_label = "Content Placeholder 2"))

```

# ThÃªm báº£ng 2 ná»™i dung ğŸŒ¹ğŸŒ¹

```{r}
#| label: slide tuoi flex ggplo 2 inline
#| echo: true
# ğŸŸ¦ ThÃªm slide má»›i kiá»ƒu Two Content
my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme")

# ğŸŸ¦ ChÃ¨n tiÃªu Ä‘á»
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm tuá»•i (Báº£ng vÃ  biá»ƒu Ä‘á»“)", location = ph_location_type(type = "title"))

# ğŸŸ¦ Format báº£ng flextable
ft_tuoi <- ft_tuoi %>%
  set_header_labels(gender = "Giá»›i tÃ­nh", Count = "n", Percentage = "%") %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg(bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>% autofit() %>%
  width(width = 3, unit = "cm")

# ğŸŸ¦ ChÃ¨n báº£ng vÃ o bÃªn trÃ¡i
my_pres <- ph_with(my_pres, value = ft_tuoi, location = ph_location_left())

# ğŸŸ¦ ChÃ¨n biá»ƒu Ä‘á»“ (tuoi_gp) vÃ o bÃªn pháº£i
my_pres <- ph_with(my_pres, value = dml(ggobj = tuoi_gp), location = ph_location_right())

# ğŸŸ¦ ChÃ¨n mÃ´ táº£ biá»ƒu Ä‘á»“ bÃªn dÆ°á»›i (ngay dÆ°á»›i biá»ƒu Ä‘á»“)
my_pres <- ph_with(
  my_pres,
  value = inline_bieudo_tuoi_ketqua,
  location = ph_location(
    left = 5.5, top = 5.5, width = 4, height = 1
  )
)

```


# ThÃªm báº£ng 2 ná»™i dung

```{r}
#| eval: false
#| include: false
my_pres <- add_slide(my_pres, layout = "Two Content", master = "Office Theme") #them slides
my_pres <- ph_with(my_pres, value = "Äáº·c Ä‘iá»ƒm giá»›i tÃ­nh (Báº£n vÃ  biá»ƒu Ä‘á»“) ", location = ph_location_type(type = "title")) #them title

# summary bang
gender_summary <- df %>%
  group_by(gender) %>%
  summarise(
    Count = n(),
    Percentage = round((n() / nrow(df)) * 100, 1)
  ) %>%
  ungroup()

# Create and format the flextable
ft <- flextable(gender_summary) %>%
  set_header_labels(gender = "Giá»›i tÃ­nh", Count = "n", Percentage = "%")  %>%
  fontsize(size = 16, part = "header") %>% bold(bold = TRUE, part = "header") %>% bg( bg = "#D3D3D3", part = "header") %>%
  fontsize(size = 16, part = "body") %>%   autofit()

ft <- width(ft, width = 3, unit = "cm")

# Dat bieu do ben phai
my_pres <- ph_with( my_pres,  value = gioi_tinh_gp
,   location = ph_location_label(ph_label = "Content Placeholder 3"))


# Dat bang ben T

my_pres <- ph_with( my_pres,  value = ft,   location = ph_location_label(ph_label = "Content Placeholder 2"))




```

## báº£ng 2

```{r}


my_pres  <- add_slide(my_pres , layout = "Title and Content", master = "Office Theme")

 
my_pres <- ph_with(my_pres, value = "ThÃªm báº£ng ná»¯a", location = ph_location_type(type = "title"))

ft <- flextable(head(mtcars))
ft <- set_table_properties(ft, width = 1, layout = "autofit")

my_pres <- ph_with(x = my_pres, ft,   location = ph_location_type(type = "body")  )

```

# Export to pptx file

```{r}
print(my_pres , "sstt_dtcs_SLIDE_output.pptx")
```






