<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Do Thanh Liem">

<title>Sstt_2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Sstt_2025_files/libs/clipboard/clipboard.min.js"></script>
<script src="Sstt_2025_files/libs/quarto-html/quarto.js"></script>
<script src="Sstt_2025_files/libs/quarto-html/popper.min.js"></script>
<script src="Sstt_2025_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Sstt_2025_files/libs/quarto-html/anchor.min.js"></script>
<link href="Sstt_2025_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Sstt_2025_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Sstt_2025_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Sstt_2025_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Sstt_2025_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Sstt_2025_files/libs/table1-1.0/table1_defaults.css" rel="stylesheet">



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sstt_2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Do Thanh Liem </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="library" class="level2">
<h2 class="anchored" data-anchor-id="library">Library</h2>
<p>T???o b???i SSTT team v�o v�o l�c :07:42 ng�y 13 th�ng 04 nam 2025</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span> <span class="fu">p_load</span>(haven, tidyverse,labelled, ggplot2, gt,flextable, table1, ggdist,ggpubr, ggstatsplot, kableExtra,officer, lubridate, glue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> haven<span class="sc">::</span> <span class="fu">read_sav</span>(<span class="st">"sstt304_28_03_24.sav"</span>, <span class="at">encoding =</span> <span class="st">"latin1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: Ch???n b??? Test VnCo m???i, v� ph�n lo???i Sa s�t tr� tu??? theo ti�u chu???n c???a MMSE </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(new.old.tests <span class="sc">!=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(mmse.new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hm-p" class="level2">
<h2 class="anchored" data-anchor-id="hm-p">H�m p</h2>
</section>
<section id="lm-sch-d-liu-mutate-label" class="level2">
<h2 class="anchored" data-anchor-id="lm-sch-d-liu-mutate-label">L�m s???ch d??? li???u (mutate, label)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year.visit=</span><span class="fu">format</span>(df<span class="sc">$</span>date.visit, <span class="at">format =</span> <span class="st">"%Y"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(year.visit)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(year.visit) <span class="sc">-</span> year.born)<span class="sc">%&gt;%</span> {<span class="fu">var_label</span>(.<span class="sc">$</span>age) <span class="ot">=</span> <span class="st">"Tu???i"</span>; .} <span class="sc">%&gt;%</span> <span class="fu">filter</span>(age<span class="sc">&gt;=</span><span class="dv">40</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age.group=</span><span class="fu">cut</span>(age, <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">65</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">80</span>, <span class="cn">Inf</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"40-65"</span>,<span class="st">"66-70"</span>, <span class="st">"71-75"</span>,<span class="st">"76-80"</span>,<span class="st">"&gt; 80"</span>)))<span class="sc">%&gt;%</span> {<span class="fu">var_label</span>(.<span class="sc">$</span>age.group) <span class="ot">&lt;-</span> <span class="st">"Nh�m tu???i"</span>; .}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bo-co-tin-d-ly-mu" class="level2">
<h2 class="anchored" data-anchor-id="bo-co-tin-d-ly-mu">B�o c�o ti???n d??? l???y m???u</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span> (<span class="at">month.year =</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(date.visit), <span class="st">"%Y-%m"</span>), <span class="at">year =</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(date.visit), <span class="st">"%Y"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tin-d." class="level1">
<h1>Ti???n d???.</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tien_do_nam_gp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df <span class="sc">%&gt;%</span> <span class="fu">count</span>(year) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">percentage =</span> (n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>), <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(year))) <span class="sc">+</span>  <span class="fu">geom_col</span>() <span class="sc">+</span>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(percentage, <span class="dv">1</span>), <span class="st">"%)"</span>)),       <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  <span class="fu">labs</span>(    <span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,       <span class="co"># Remove legend</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),  <span class="co"># Remove panel background</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),   <span class="co"># Remove plot background</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>tien_do_nam_gp </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tin-d-2024-thng" class="level1">
<h1>Ti???n d??? 2024 th�ng</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tien_do_2024_thang_gp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">"2024"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(month.year) <span class="sc">%&gt;%</span>  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">percentage =</span> (n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>), </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> month.year, <span class="at">y =</span> n, <span class="at">fill =</span> <span class="fu">factor</span>(month.year))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span>  </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span>  </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">round</span>(percentage, <span class="dv">1</span>), <span class="st">"%)"</span>)), </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span>   </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,      </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),   </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()         </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(tien_do_2024_thang_gp, <span class="at">file =</span> <span class="st">"tien_do_2024_thang_gp.RData"</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>tien_do_2024_thang_gp </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df$gender     &lt;- factor(df$ gender, levels= c(1,2), labels=c("Male", "Female"))</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">gender  =</span> <span class="fu">factor</span>(gender, <span class="at">levels=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Nam gi???i"</span>, <span class="st">"N??? gi???i"</span>))) <span class="sc">%&gt;%</span> {<span class="fu">var_label</span>(.<span class="sc">$</span>gender) <span class="ot">&lt;-</span> <span class="st">"Gi???i t�nh"</span>; .}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="phn-d-mmse" class="level2">
<h2 class="anchored" data-anchor-id="phn-d-mmse">Ph�n d??? MMSE</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mmse.group=</span><span class="fu">cut</span>(mmse.new, <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">24</span>,<span class="dv">27</span>,<span class="cn">Inf</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"SSTT n???ng"</span>, <span class="st">"Trung b�nh"</span>,<span class="st">"Nh???"</span>, <span class="st">"Suy gi???m nh???n th???c ch??? quan"</span>, <span class="st">"B�nh thu???ng"</span>))) <span class="sc">%&gt;%</span> {<span class="fu">var_label</span>(.<span class="sc">$</span>mmse.group)<span class="ot">=</span><span class="st">"Ph�n d??? b???nh theo MMSE"</span>; .}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>group     <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span> group, <span class="at">levels=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"MCI"</span>, <span class="st">"Dementia"</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>TMT.A.comp     <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span> TMT.A.comp, <span class="at">levels=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Unable to do"</span>, <span class="st">"Uncomplete"</span>, <span class="st">"complete"</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>TMT.B.comp     <span class="ot">&lt;-</span> <span class="fu">factor</span>(df<span class="sc">$</span> TMT.B.comp, <span class="at">levels=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Unable to do"</span>, <span class="st">"Uncomplete"</span>, <span class="st">"complete"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="dc-dim-bnh-nhn" class="level1">
<h1>D???c di???m b???nh nh�n</h1>
<section id="bng-gii-tnh" class="level2">
<h2 class="anchored" data-anchor-id="bng-gii-tnh">B???ng gi???i t�nh</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gioi_tinh_tab <span class="ot">&lt;-</span> <span class="fu">table1</span>(<span class="sc">~</span>gender,<span class="at">data=</span>df, </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"B???ng 02: Bi???u di???n gi???i t�nh"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>gioi_tinh_tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>B???ng 02: Bi???u di???n gi???i t�nh</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Overall<br>
<span class="stratn">(N=456)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Gi???i t�nh</td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Nam gi???i</td>
<td>171 (37.5%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">N??? gi???i</td>
<td class="lastrow">285 (62.5%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">edu.level  =</span> <span class="fu">factor</span>(edu.level, <span class="at">levels=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Ti???u h???c"</span>, <span class="st">"Trung h???c co s???"</span>,<span class="st">"Trung h???c ph??? th�ng"</span>,<span class="st">"D???i h???c"</span>,<span class="st">"Non-defined"</span>))) <span class="sc">%&gt;%</span> {<span class="fu">var_label</span>(.<span class="sc">$</span>edu.level) <span class="ot">&lt;-</span> <span class="st">"Tr�nh d??? h???c v???n "</span>; .}</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edu.level2 =</span> <span class="fu">fct_recode</span>(edu.level, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">"Trung h???c"</span> <span class="ot">=</span> <span class="st">"Trung h???c co s???"</span>, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">"Trung h???c"</span> <span class="ot">=</span> <span class="st">"Trung h???c ph??? th�ng"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">"Cao d???ng, d???i h???c"</span> <span class="ot">=</span> <span class="st">"D???i h???c"</span>))<span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edu.level2 =</span> <span class="fu">na_if</span>(edu.level2, <span class="st">"Non-defined"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="biu-d-gii-tnh" class="level2">
<h2 class="anchored" data-anchor-id="biu-d-gii-tnh">Bi???u d??? gi???i t�nh</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gioi_tinh_gp <span class="ot">&lt;-</span> <span class="fu">ggdonutchart</span>(df <span class="sc">%&gt;%</span> <span class="fu">select</span>(gender) <span class="sc">%&gt;%</span> <span class="fu">count</span>(gender) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) , <span class="st">"n"</span>, <span class="at">label =</span> <span class="st">"gender"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"white"</span>,<span class="at">fill =</span> <span class="st">"gender"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(n<span class="sc">/</span><span class="fu">sum</span>(n))),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">size =</span> <span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">"Gi???i t�nh"</span>))<span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Nam"</span>,<span class="st">"N???"</span>)) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,      </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_blank</span>(),   </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()         </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>gioi_tinh_gp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bng-trnh-d-hc-vn" class="level2">
<h2 class="anchored" data-anchor-id="bng-trnh-d-hc-vn">B???ng tr�nh d??? h???c v???n</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table1</span>(<span class="sc">~</span>edu.level <span class="sc">+</span> edu.level2,<span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Overall<br>
<span class="stratn">(N=456)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Tr�nh d??? h???c v???n</td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Ti???u h???c</td>
<td>56 (12.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Trung h???c co s???</td>
<td>46 (10.1%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Trung h???c ph??? th�ng</td>
<td>126 (27.6%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">D???i h???c</td>
<td>134 (29.4%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Non-defined</td>
<td>88 (19.3%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">6 (1.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Tr�nh d??? h???c v???n</td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">Ti???u h???c</td>
<td>56 (12.3%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Trung h???c</td>
<td>172 (37.7%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Cao d???ng, d???i h???c</td>
<td>134 (29.4%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Non-defined</td>
<td>0 (0%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">94 (20.6%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="biu-d-trnh-d-hc-vn." class="level2">
<h2 class="anchored" data-anchor-id="biu-d-trnh-d-hc-vn.">Bi???u d??? tr�nh d??? h???c v???n.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df <span class="sc">%&gt;%</span> <span class="fu">select</span>(edu.level2) <span class="sc">%&gt;%</span> <span class="fu">count</span>(edu.level2) <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">pct =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span> (<span class="at">edu.level2 =</span> <span class="fu">fct_reorder</span>(edu.level2, n, <span class="at">.desc =</span> T)), <span class="fu">aes</span>(edu.level2, n, <span class="at">fill =</span> edu.level2))<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(<span class="st">"%1.1f"</span>, pct<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%"</span>)), <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tr�nh d??? h???c v???n"</span>)<span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"T???n s???"</span>)<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table1</span>(<span class="sc">~</span>mmse.new<span class="sc">+</span>mmse.group,<span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1 caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Overall<br>
<span class="stratn">(N=456)</span></span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">MMSE</td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>19.6 (7.13)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">Median [Min, Max]</td>
<td class="lastrow">21.0 [2.00, 30.0]</td>
</tr>
<tr class="even">
<td class="rowlabel firstrow">Ph�n d??? b???nh theo MMSE</td>
<td class="firstrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel">SSTT n???ng</td>
<td>50 (11.0%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Trung b�nh</td>
<td>143 (31.4%)</td>
</tr>
<tr class="odd">
<td class="rowlabel">Nh???</td>
<td>112 (24.6%)</td>
</tr>
<tr class="even">
<td class="rowlabel">Suy gi???m nh???n th???c ch??? quan</td>
<td>84 (18.4%)</td>
</tr>
<tr class="odd">
<td class="rowlabel lastrow">B�nh thu???ng</td>
<td class="lastrow">67 (14.7%)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="biu-d-phn-b-theo-tui" class="level1">
<h1>Bi???u d??? ph�n b??? theo tu???i</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>gender, <span class="at">y=</span>age, <span class="at">fill=</span>gender)) <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add half-violin from {ggdist} package</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="do">## custom bandwidth</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">adjust =</span> .<span class="dv">3</span>, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="do">## adjust height</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">6</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## dich bieu do may</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="sc">-</span>.<span class="dv">25</span>, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## remove slab interval</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.width =</span> <span class="dv">0</span>, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_colour =</span> <span class="cn">NA</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> .<span class="dv">18</span>, </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="do">## remove outliers</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.color =</span> <span class="cn">NA</span> <span class="do">## `outlier.shape = NA` works as well</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add dot plots from {ggdist} package</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_dots</span>(</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    <span class="do">## orientation to the left</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">side =</span> <span class="st">"left"</span>, </span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    <span class="do">## move geom to the left</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">justification =</span> <span class="fl">1.1</span>, </span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="do">## adjust grouping (binning) of observations </span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">binwidth =</span> .<span class="dv">75</span>,</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  <span class="do">## remove white space on the left</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">1.2</span>, <span class="cn">NA</span>))<span class="sc">+</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y=</span>mean, <span class="at">geom=</span><span class="st">"point"</span>, <span class="at">shape=</span><span class="dv">20</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">"purple"</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>(<span class="at">width =</span> <span class="fl">0.75</span>, <span class="at">preserve =</span> <span class="st">"single"</span>)) <span class="sc">+</span></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">x=</span> <span class="fl">2.5</span>, <span class="at">y=</span> <span class="dv">30</span>, <span class="at">label =</span> <span class="st">"t-test, p &gt; 0.05"</span>) <span class="sc">+</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Nam'</span>,<span class="st">'N???'</span>))<span class="sc">+</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">" Gi???i t�nh"</span>) <span class="sc">+</span> </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Tu???i (nam)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
ℹ Please use the `fun` argument instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="phn-d-sstt-theo-mmse" class="level1">
<h1>Ph�n d??? SSTT theo MMSE</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tuoi_gp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(mmse.group, <span class="at">fill=</span>mmse.group)) <span class="sc">+</span>    <span class="fu">geom_bar</span>()<span class="sc">+</span>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">round</span>((..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..),<span class="dv">2</span>)),             <span class="at">y=</span> ((..count..)<span class="sc">/</span><span class="fu">sum</span>(..count..))), <span class="at">stat=</span><span class="st">"count"</span>,         <span class="at">vjust =</span> <span class="sc">-</span>.<span class="dv">75</span>)<span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span>   <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>())<span class="sc">+</span>   <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'SSTT N???ng'</span>,<span class="st">'SSTT Trung b�nh'</span>, <span class="st">'SSTT Nh???'</span>,<span class="st">'C� th??? MCI'</span>,<span class="st">'SCI-B�nh thu???ng'</span>))<span class="sc">+</span>   <span class="fu">xlab</span>(<span class="st">"Ph�n d??? SSTT theo thang di???m MMSE"</span>)<span class="sc">+</span>   <span class="fu">ylab</span>(<span class="st">"S??? lu???ng (n)"</span>) </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>tuoi_gp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..count..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(count)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mi-quan-h-gia-gii-tnh-v-dim-mmse" class="level1">
<h1>M???i quan h??? gi???a gi???i t�nh v� di???m MMSE</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(age, mmse.new, <span class="at">fill=</span>gender))<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col=</span>gender))<span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)<span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> mmse.new, <span class="at">group=</span>gender, <span class="at">fill =</span> gender), <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">method=</span><span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name=</span><span class="st">"Gi???i t�nh"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">"Male"</span>, <span class="st">"Female"</span>),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Nam"</span>, <span class="st">"N???"</span>))<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Tu???i"</span>)<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Di???m MMSE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Sstt_2025_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="so-snh-cc-test-chuyn-bit-gia-sstt-v-mci" class="level1">
<h1>So s�nh c�c test chuy�n bi???t gi???a SSTT v� MCI</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_di <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(mmse.new <span class="sc">&lt;=</span><span class="dv">27</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mmse.dia =</span> <span class="fu">cut</span>(mmse.new, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">24</span>, <span class="sc">+</span><span class="cn">Inf</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sa s�t tr� tu???"</span>, <span class="st">"Suy gi???m nh???n th???c nh???"</span>)) )</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table1</span>(<span class="sc">~</span>Im.recall1<span class="sc">+</span>de.recall1<span class="sc">+</span>de.reg1<span class="sc">+</span>de.reg1<span class="sc">+</span>TMT.A.time<span class="sc">+</span>TMT.B.time<span class="sc">+</span>DS.forward1<span class="sc">+</span>DS.backrward1<span class="sc">+</span>animal.test1<span class="sc">+</span>clock.drawing1<span class="sc">|</span>mmse.dia, <span class="at">topclass =</span> <span class="st">"Rtable1-zebra"</span>, <span class="at">extra.col =</span> <span class="fu">list</span>(<span class="st">"P-value"</span> <span class="ot">=</span> pvalue), <span class="at">overall =</span> F,<span class="at">data=</span>df_di)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="Rtable1">
<table class="Rtable1-zebra caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th class="rowlabel firstrow lastrow" data-quarto-table-cell-role="th"></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Sa s�t tr� tu???<br>
<span class="stratn">(N=305)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">Suy gi???m nh???n th???c nh???<br>
<span class="stratn">(N=84)</span></span></th>
<th class="firstrow lastrow" data-quarto-table-cell-role="th"><span class="stratlabel">P-value</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowlabel firstrow">Immediate Recall</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>9.18 (5.65)</td>
<td>16.8 (4.30)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>9.00 [0, 26.0]</td>
<td>17.0 [7.00, 27.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">7 (2.3%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Delayed Recall</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>1.27 (2.23)</td>
<td>5.19 (2.22)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>0 [0, 10.0]</td>
<td>5.00 [0, 10.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">7 (2.3%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Delayed Recognition</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>3.49 (3.22)</td>
<td>7.77 (2.45)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>3.00 [0, 10.0]</td>
<td>8.00 [0, 10.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">8 (2.6%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Trail Making Test A</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>110 (42.2)</td>
<td>85.4 (39.1)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>107 [17.0, 180]</td>
<td>74.5 [34.0, 180]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">189 (62.0%)</td>
<td class="lastrow">2 (2.4%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Trail Making Test B</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>233 (74.0)</td>
<td>182 (69.0)</td>
<td>0.094</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>250 [95.0, 300]</td>
<td>176 [70.0, 300]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">296 (97.0%)</td>
<td class="lastrow">53 (63.1%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Digit Span Forward</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>6.17 (2.68)</td>
<td>8.13 (2.05)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>6.00 [0, 12.0]</td>
<td>8.00 [4.00, 12.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5 (1.6%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Digit Span Backward</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>2.78 (2.05)</td>
<td>5.11 (1.90)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>3.00 [0, 11.0]</td>
<td>5.00 [2.00, 11.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5 (1.6%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Animal testing speed</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>9.43 (5.46)</td>
<td>16.9 (5.39)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>9.00 [0, 28.0]</td>
<td>16.0 [7.00, 29.0]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5 (1.6%)</td>
<td class="lastrow">1 (1.2%)</td>
<td class="lastrow"></td>
</tr>
<tr class="odd">
<td class="rowlabel firstrow">Clock Drawing Test</td>
<td class="firstrow"></td>
<td class="firstrow"></td>
<td class="firstrow"></td>
</tr>
<tr class="even">
<td class="rowlabel">Mean (SD)</td>
<td>3.75 (1.65)</td>
<td>1.73 (0.832)</td>
<td>&lt;0.001</td>
</tr>
<tr class="odd">
<td class="rowlabel">Median [Min, Max]</td>
<td>4.00 [0, 6.00]</td>
<td>2.00 [1.00, 4.00]</td>
<td></td>
</tr>
<tr class="even">
<td class="rowlabel lastrow">Missing</td>
<td class="lastrow">5 (1.6%)</td>
<td class="lastrow">2 (2.4%)</td>
<td class="lastrow"></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="to-slide-bo-co" class="level2">
<h2 class="anchored" data-anchor-id="to-slide-bo-co">T???o slide b�o c�o</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">read_pptx</span>(<span class="st">"template.pptx"</span>) </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>myftr <span class="ot">&lt;-</span> <span class="st">"B???nh vi???n 30-4"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="kim-tra-layout" class="level3">
<h3 class="anchored" data-anchor-id="kim-tra-layout">Ki???m tra layout</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout_summary</span>(my_pres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             layout       master
1       Title Slide Office Theme
2 Title and Content Office Theme
3    Section Header Office Theme
4       Two Content Office Theme
5        Comparison Office Theme
6        Title Only Office Theme
7             Blank Office Theme</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(<span class="fu">layout_summary</span>(my_pres))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 7
Columns: 2
$ layout &lt;chr&gt; "Title Slide", "Title and Content", "Section Header", "Two Cont…
$ master &lt;chr&gt; "Office Theme", "Office Theme", "Office Theme", "Office Theme",…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect layout structure</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">layout_summary</span>(my_pres))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">layout</th>
<th style="text-align: left;">master</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Title Slide</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="even">
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Section Header</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="even">
<td style="text-align: left;">Two Content</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Comparison</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="even">
<td style="text-align: left;">Title Only</td>
<td style="text-align: left;">Office Theme</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Blank</td>
<td style="text-align: left;">Office Theme</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect properties of a specific layout</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">layout_properties</span>(my_pres, <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 11%">
<col style="width: 19%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 17%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">master_name</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: right;">type_idx</th>
<th style="text-align: right;">id</th>
<th style="text-align: left;">ph_label</th>
<th style="text-align: left;">ph</th>
<th style="text-align: right;">offx</th>
<th style="text-align: right;">offy</th>
<th style="text-align: right;">cx</th>
<th style="text-align: right;">cy</th>
<th style="text-align: right;">rotation</th>
<th style="text-align: left;">fld_id</th>
<th style="text-align: left;">fld_type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Office Theme</td>
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">title</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Title 1</td>
<td style="text-align: left;"><p:ph type="title"></p:ph></td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">0.3003478</td>
<td style="text-align: right;">12.000000</td>
<td style="text-align: right;">1.2500000</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Office Theme</td>
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">body</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Content Placeholder 2</td>
<td style="text-align: left;"><p:ph idx="1"></p:ph></td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">1.7500011</td>
<td style="text-align: right;">12.000000</td>
<td style="text-align: right;">4.9496533</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Office Theme</td>
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">dt</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Date Placeholder 3</td>
<td style="text-align: left;"><p:ph type="dt" sz="half" idx="10"></p:ph></td>
<td style="text-align: right;">0.6666667</td>
<td style="text-align: right;">6.9513900</td>
<td style="text-align: right;">3.111111</td>
<td style="text-align: right;">0.3993056</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">{E6744CE3-0875-4B69-89C0-6F72D8139561}</td>
<td style="text-align: left;">datetimeFigureOut</td>
</tr>
<tr class="even">
<td style="text-align: left;">Office Theme</td>
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">ftr</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Footer Placeholder 4</td>
<td style="text-align: left;"><p:ph type="ftr" sz="quarter" idx="11"></p:ph></td>
<td style="text-align: right;">4.5555556</td>
<td style="text-align: right;">6.9513900</td>
<td style="text-align: right;">4.222222</td>
<td style="text-align: right;">0.3993056</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Office Theme</td>
<td style="text-align: left;">Title and Content</td>
<td style="text-align: left;">sldNum</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Slide Number Placeholder 5</td>
<td style="text-align: left;"><p:ph type="sldNum" sz="quarter" idx="12"></p:ph></td>
<td style="text-align: right;">9.5555556</td>
<td style="text-align: right;">6.9513900</td>
<td style="text-align: right;">3.111111</td>
<td style="text-align: right;">0.3993056</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">{8DADB20D-508E-4C6D-A9E4-257D5607B0F6}</td>
<td style="text-align: left;">slidenum</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="slide-tiu-d" class="level3">
<h3 class="anchored" data-anchor-id="slide-tiu-d">Slide ti�u d???</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># T???o slide ti�u d???</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add title slide</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres, <span class="at">layout =</span> <span class="st">"Title Slide"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add title and subtitle</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"Hi???u qu??? ch???n do�n v� di???u tr??? b??? test th???n kinh nh???n th???c"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"ctrTitle"</span>))</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"BS.CK2. D??? Thanh Li�m - Don v??? tr� nh??? v� sa s�t tr� tu??? BV 30-4"</span>, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"subTitle"</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add footer</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"DV ch??? tr�: Khoa T�m th???n kinh"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"ftr"</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add footer with date</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="fu">format</span>(<span class="fu">Sys.Date</span>(), <span class="st">"%d/%m/%Y"</span>), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"dt"</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add infor to footer</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"D??? t�i c???p co s???"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"sldNum"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="slide-ni-dung" class="level2">
<h2 class="anchored" data-anchor-id="slide-ni-dung">Slide n???i dung</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ul <span class="ot">&lt;-</span> <span class="fu">unordered_list</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">level_list =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">1</span> ),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">str_list =</span> <span class="fu">c</span>(<span class="st">"D???t v???n d???"</span>, <span class="st">"D???i tu???ng v� phuong ph�p nghi�n c???u"</span>, <span class="st">"K???t qu??? - B�n lu???n"</span>, <span class="st">"K???t lu???n"</span>),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">style =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">font.size =</span> <span class="dv">0</span>) )</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"N???i dung tr�nh b�y"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(<span class="at">x =</span> my_pres, <span class="at">value =</span> ul, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slide-ni-dung-1" class="level2">
<h2 class="anchored" data-anchor-id="slide-ni-dung-1">Slide n???i dung</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ul <span class="ot">&lt;-</span> <span class="fu">unordered_list</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">level_list =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">str_list =</span> <span class="fu">c</span>(<span class="st">"C�u h???i nghi�n c???u"</span>, <span class="st">"Gi� tr� ch???n do�n v� di???u tr??? b??? test l� g�?"</span>, <span class="st">"M???c ti�u"</span>, <span class="st">"Nghi�n c???u m???i tuong quan c???a thang di???m MMSE v???i c�c test th???n kinh nh???n th???c kh�c trong b??? Test th???n kinh nh???n th???c t???i B???nh vi???n 30-4."</span>, <span class="st">"D�nh gi� hi???u qu??? ???ng d???ng c???a b??? Test th???n kinh nh???n th???c trong ch???n do�n v� di???u tr??? Sa s�t tr� tu??? t???i B???nh vi???n 30-4"</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">style =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">font.size =</span> <span class="dv">0</span>) )</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"C�u h???i NC, m???c ti�u"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(<span class="at">x =</span> my_pres, <span class="at">value =</span> ul, </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dt-vn-d" class="level3">
<h3 class="anchored" data-anchor-id="dt-vn-d">D???t v???n d???</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add slide</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add title of slide</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"D???t v???n d???"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add body of slide</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"SSTT l� m???t b???nh l� c???a n�o b???, g�y ra suy gi???m ch???c nang nh???n th???c, h�nh vi v� ho???t d???ng s???ng c???a b???nh nh�n."</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"T??? nam 2019 d???n nay, Don v??? Tr� nh??? v� Sa s�t tr� tu??? B???nh vi???n 30-4 d� s??? d???ng b??? tr???c nghi???m  d�nh gi� ch???c nang th???n kinh nh???n th???c Vi???t Nam (VnCA)"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ph�t hi???n, d�nh gi� d�ng m???c nh???ng thay d???i s???m nh???t v??? h�nh vi v� nh???n th???c c???a b???nh nh�n gi�p c�c nh� l�m s�ng ch???n do�n s???m, t???i uu h�a chi???n lu???c di???u tr???, g�p ph???n gi???m thi???u g�nh n???ng b???nh t???t do SSTT g�y ra"</span>), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="slide-di-tung-v-phuong-php-nghin-cu" class="level2">
<h2 class="anchored" data-anchor-id="slide-di-tung-v-phuong-php-nghin-cu">Slide d???i tu???ng v� phuong ph�p nghi�n c???u</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ul <span class="ot">&lt;-</span> <span class="fu">unordered_list</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">level_list =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,  <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">str_list =</span> <span class="fu">c</span>(<span class="st">"Thi???t k??? ngi�n c???u"</span>, <span class="st">"M� t??? c???t ngang"</span>, <span class="st">"Ti�u chu???n ch???n"</span>, <span class="st">"B???nh nh�n d???n kh�m t???i Don v??? tr� nh??? v� SSTT "</span>, <span class="st">"T??? 40 tu???i tr??? l�n"</span>, <span class="st">"C� than phi???n v??? tr� nh??? ho???c nh???n th???c"</span>,<span class="st">"Ti�u chu???n lo???i tr???"</span>, <span class="st">"Kh�ng h???p t�c"</span>, <span class="st">"B???nh nh�n dang b??? m� s???ng, l� l???n c???p"</span>, <span class="st">"Suy gi???m nh???n th???c kh�ng do nguy�n nh�n t�m th???n kinh kh�c"</span> ),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">style =</span> <span class="fu">fp_text</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">font.size =</span> <span class="dv">0</span>) )</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"D???i tu???ng v� phuong ph�p nghi�n c�u"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(<span class="at">x =</span> my_pres, <span class="at">value =</span> ul, </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slides-tin-d-ly-mu" class="level2">
<h2 class="anchored" data-anchor-id="slides-tin-d-ly-mu">Slides Ti???n d??? l???y m???u</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"Ti???n d??? l???y m???u"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>emp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df <span class="sc">%&gt;%</span> <span class="fu">count</span>(year) <span class="sc">%&gt;%</span>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">round</span>((n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">*</span> <span class="dv">100</span>),  <span class="dv">1</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">ph_location</span>(</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">left=</span><span class="fl">1.5</span>,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">top =</span> <span class="fl">1.5</span>,</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">10</span>,</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">4</span>,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">rotation =</span> <span class="dv">0</span>,</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">bg=</span><span class="st">"#333333"</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres , emp, <span class="at">location =</span> loc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-more-slide" class="level2">
<h2 class="anchored" data-anchor-id="add-more-slide">Add more slide</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add slide</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># add title of slide</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"Current study"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add body of slide</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"The present study found that there are factors relating to the caregiver and to the person with dementia that affect how resilient a dementia caregiver may be."</span>, <span class="st">"It is apparent that caregiver resilience is not solely due to the personal assets and resources of the caregiver but may also be affected by the level of dependence of the person with dementia."</span>,  <span class="st">"Findings suggest that caregivers with high levels of neuroticism and low subjective caregiver competence"</span>), <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="add-ggplot" class="level1">
<h1>add ggplot</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"cho ggplot v� body"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(<span class="at">x =</span> my_pres, tien_do_2024_thang_gp, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>   <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="add-table-schroeder_neuropsychological_2019" class="level1">
<h1>add table <span class="citation" data-cites="schroeder_neuropsychological_2019">@schroeder_neuropsychological_2019</span></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres, <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>) <span class="co">#them slides</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"D???c di???m gi???i t�nh -gi???a "</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>)) <span class="co">#them title</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary bang</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>gender_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>((<span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(df)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and format the flextable</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(gender_summary) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">gender =</span> <span class="st">"Gi???i t�nh"</span>, <span class="at">Count =</span> <span class="st">"n"</span>, <span class="at">Percentage =</span> <span class="st">"%"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> <span class="fu">bold</span>(<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> <span class="fu">bg</span>( <span class="at">bg =</span> <span class="st">"#D3D3D3"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   <span class="fu">autofit</span>()</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Get slide dimensions in inches</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>slide_dims <span class="ot">&lt;-</span> <span class="fu">slide_size</span>(my_pres)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>slide_width <span class="ot">&lt;-</span> slide_dims<span class="sc">$</span>width</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>slide_height <span class="ot">&lt;-</span> slide_dims<span class="sc">$</span>height</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Get flextable dimensions</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>table_dims <span class="ot">&lt;-</span> <span class="fu">dim</span>(ft)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>table_width <span class="ot">&lt;-</span> <span class="fu">sum</span>(table_dims<span class="sc">$</span>widths)</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>table_height <span class="ot">&lt;-</span> <span class="fu">sum</span>(table_dims<span class="sc">$</span>heights)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate positions to center the table</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>left_pos <span class="ot">&lt;-</span> (slide_width <span class="sc">-</span> table_width) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>top_pos <span class="ot">&lt;-</span> (slide_height <span class="sc">-</span> table_height) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the flextable to the slide at the calculated position</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> ft, <span class="at">location =</span> <span class="fu">ph_location</span>(<span class="at">left =</span> left_pos, <span class="at">top =</span> top_pos))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="thm-bng-2-ni-dung" class="level1">
<h1>Th�m b???ng 2 n???i dung</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres, <span class="at">layout =</span> <span class="st">"Two Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>) <span class="co">#them slides</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"D???c di???m gi???i t�nh (B???n v� bi???u d???) "</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>)) <span class="co">#them title</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary bang</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>gender_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gender) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">n</span>(),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percentage =</span> <span class="fu">round</span>((<span class="fu">n</span>() <span class="sc">/</span> <span class="fu">nrow</span>(df)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create and format the flextable</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(gender_summary) <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">gender =</span> <span class="st">"Gi???i t�nh"</span>, <span class="at">Count =</span> <span class="st">"n"</span>, <span class="at">Percentage =</span> <span class="st">"%"</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> <span class="fu">bold</span>(<span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span> <span class="fu">bg</span>( <span class="at">bg =</span> <span class="st">"#D3D3D3"</span>, <span class="at">part =</span> <span class="st">"header"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fontsize</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">part =</span> <span class="st">"body"</span>) <span class="sc">%&gt;%</span>   <span class="fu">autofit</span>()</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">width</span>(ft, <span class="at">width =</span> <span class="dv">3</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Dat bieu do ben phai</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>( my_pres,  <span class="at">value =</span> gioi_tinh_gp</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>,   <span class="at">location =</span> <span class="fu">ph_location_label</span>(<span class="at">ph_label =</span> <span class="st">"Content Placeholder 3"</span>))</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Dat bang ben T</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>( my_pres,  <span class="at">value =</span> ft,   <span class="at">location =</span> <span class="fu">ph_location_label</span>(<span class="at">ph_label =</span> <span class="st">"Content Placeholder 2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bng-2" class="level2">
<h2 class="anchored" data-anchor-id="bng-2">b???ng 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>my_pres  <span class="ot">&lt;-</span> <span class="fu">add_slide</span>(my_pres , <span class="at">layout =</span> <span class="st">"Title and Content"</span>, <span class="at">master =</span> <span class="st">"Office Theme"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(my_pres, <span class="at">value =</span> <span class="st">"Th�m b???ng n???a"</span>, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"title"</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(<span class="fu">head</span>(mtcars))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">set_table_properties</span>(ft, <span class="at">width =</span> <span class="dv">1</span>, <span class="at">layout =</span> <span class="st">"autofit"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>my_pres <span class="ot">&lt;-</span> <span class="fu">ph_with</span>(<span class="at">x =</span> my_pres, ft, <span class="at">location =</span> <span class="fu">ph_location_type</span>(<span class="at">type =</span> <span class="st">"body"</span>)  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="export-to-pptx-file" class="level1">
<h1>Export to pptx file</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_pres , <span class="st">"dtcs_sstt_quarto.pptx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="to-file-words-bo-co" class="level1">
<h1>T???o file words b�o c�o</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rd <span class="ot">&lt;-</span> <span class="fu">read_docx</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_docx</span>(<span class="at">src =</span> <span class="st">"00_bia_bsLiem.docx"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>()</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Get current date and time</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>current_day <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">now</span>() <span class="sc">%&gt;%</span> <span class="fu">format</span>(<span class="st">'%d/%m/%Y'</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>current_time <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">now</span>() <span class="sc">%&gt;%</span> <span class="fu">format</span>(<span class="st">'%H:%M'</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>prop_red_text <span class="ot">&lt;-</span> <span class="fu">fp_text</span>(</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">font.size =</span> <span class="dv">16</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">bold =</span> <span class="cn">TRUE</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the formatted text for the report as a single string</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>text_creation_time <span class="ot">&lt;-</span> <span class="fu">ftext</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  glue<span class="sc">::</span><span class="fu">glue</span>(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B�o c�o du???c t???o ra v�o {current_time} ng�y {current_day} b???i TEAM YHCT.'</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">prop =</span> prop_red_text</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ftext object for formatted text</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="co">#par_creation_time &lt;- fpar(text_creation_time)</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>par_creation_time <span class="ot">&lt;-</span> <span class="fu">fpar</span>(</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> text_creation_time,</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">fp_p =</span> <span class="fu">fp_par</span>(</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">text.align =</span> <span class="st">"right"</span>,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">border.top =</span> <span class="fu">fp_border</span>(</span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">width =</span> <span class="dv">2</span>,</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"blue"</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>rd <span class="ot">&lt;-</span> rd <span class="sc">%&gt;%</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_fpar</span>(par_creation_time) <span class="sc">%&gt;%</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="fu">body_add_break</span>()</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> rd <span class="sc">%&gt;%</span>  </span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="st">"M???C L???C"</span>, <span class="at">style =</span> <span class="st">"centered"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_toc</span>(<span class="at">level =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="st">"Table of figures"</span>, <span class="at">style =</span> <span class="st">"heading 1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_toc</span>(<span class="at">style =</span> <span class="st">"Image Caption"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="st">"Table of tables"</span>, <span class="at">style =</span> <span class="st">"heading 1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_toc</span>(<span class="at">style =</span> <span class="st">"Table Caption"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_break</span>()  </span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> rd <span class="sc">%&gt;%</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"B�O C�O T�M T???T NGHI�U C???U"</span>, <span class="at">style =</span> <span class="st">"centered"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"BS.CK2 D??? Thanh Li�m"</span>, <span class="at">style =</span> <span class="st">"Normal"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"T???ng quan v??? suy gi???m nh???n th???c v� b???nh sa s�t tr� tu???, vai tr� c???a test th???n kinh nh???n th???c."</span>, <span class="at">style =</span> <span class="st">"heading 1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"Vai tr� c???a ph�n t�ch test th???n kinh nh???n th???c."</span>, <span class="at">style =</span> <span class="st">"heading 2"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"C�c nghi�n c???u trong nu???c li�n quan "</span>, <span class="at">style =</span> <span class="st">"heading 3"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"B�o c�o ti???n d??? "</span>, <span class="at">style =</span> <span class="st">"heading 3"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"B�o c�o ti???n d??? theo nam"</span>, <span class="at">style =</span> <span class="st">"Normal"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_gg</span>(<span class="at">value =</span> tien_do_nam_gp , <span class="at">style =</span> <span class="st">"centered"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"B�o c�o ti???n d??? th�ng nam 2024"</span>, <span class="at">style =</span> <span class="st">"Normal"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_gg</span>(<span class="at">value =</span> tien_do_2024_thang_gp , <span class="at">style =</span> <span class="st">"centered"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"D???c di???m gi???i t�nh "</span>, <span class="at">style =</span> <span class="st">"heading 3"</span>) </span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the flextable</span></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="fu">flextable</span>(gender_summary) <span class="sc">%&gt;%</span></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_header_labels</span>(<span class="at">gender =</span> <span class="st">"Gi???i t�nh"</span>, <span class="at">Count =</span> <span class="st">"n"</span>, <span class="at">Percentage =</span> <span class="st">"%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_table_properties</span>(<span class="at">layout =</span> <span class="st">"autofit"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">unit =</span> <span class="st">"cm"</span>)  </span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>rd <span class="ot">&lt;-</span> rd <span class="sc">%&gt;%</span> <span class="fu">body_add_flextable</span>(<span class="at">value =</span> ft)</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>  rd <span class="sc">%&gt;%</span> <span class="fu">body_add_gg</span>(<span class="at">value =</span> gioi_tinh_gp , <span class="at">style =</span> <span class="st">"centered"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Th�m thuy???t minh d??? t�i </span></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"Thuy???t minh d??? t�i"</span>, <span class="at">style =</span> <span class="st">"heading 1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">body_add_docx</span>(<span class="at">src =</span> <span class="st">"thuyet_minh.docx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Th�m li lich khoa h???c</span></span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">body_add_par</span>(<span class="at">value =</span> <span class="st">"L� l???ch khoa h???c"</span>, <span class="at">style =</span> <span class="st">"heading 1"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">body_add_docx</span>(<span class="at">src =</span> <span class="st">"llkh.docx"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">target =</span> <span class="st">"sstt_dtcs_2025.docx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>